// vqlauthoring.js
dojo.addOnLoad(function(){
Type.registerNamespace('tab');tab.SaveController=function(){}
tab.SaveController.get_instance=function(){if(ss.isNullOrUndefined(tab.SaveController.$0)){tab.SaveController.$0=new tab.SaveController();}return tab.SaveController.$0;}
tab.SaveController.prototype={get_isSaveEnabled:function(){return tsConfig.allow_save&&!tab.ApplicationModel.get_instance().get_workbook().get_isWorkbookIncomplete();},get_isSaveAsEnabled:function(){return tsConfig.allow_save_as;},saveWorkbook:function(onSuccess,onCancel){if(tsConfig.is_guest){this.$3();}else{if(this.get_isSaveEnabled()){this.$1(onSuccess);}else if(this.get_isSaveAsEnabled()){this.$2('save',onSuccess,onCancel);}}},saveWorkbookAs:function(onSuccess,onCancel){if(tsConfig.is_guest){this.$3();}else if(this.get_isSaveAsEnabled()){this.$2('saveAs',onSuccess,onCancel);}},$1:function($p0){tab.SaveServerCommands.saveWorkbook(function($p1_0){
if(ss.isValue($p0)){$p0($p1_0);}else{tab.NotificationViewModel.showNotification(tab.Strings.AuthSaveWorkbookSavedMessage);}});},$2:function($p0,$p1,$p2){var $0=new tab.SaveViewModel();if($p0!=='save'){$0.set_workbookName('');}spiff.ObjectRegistry.newView(tab.SaveView,$0);$0.showSave();if(ss.isValue($p2)){$0.add_saveCancelled($p2);}if(ss.isValue($p1)){$0.add_saveSucceeded($p1);}else{$0.add_saveSucceeded(function($p1_0){
var $1_0=tab.WorkbookViewObjectUtils.createVizUriModelForAuthoringSheetInWorkbook(tsConfig.current_sheet_name,$p1_0);$1_0.removeQueryParam(':showSave').removeQueryParam(':showSaveAs');var $1_1=tabBootstrap.Utility.get_locationWindow();if($1_0.matchesCurrentWindowLocationUri()){tab.WindowHelper.reload($1_1,true);}else{tab.SessionServerCommands.destroySessionAndForward($1_1,$1_0.get_uri());}});}},$3:function(){var $0=tab.VizUriModel.createForCurrentWindowLocationAndVizState(tsConfig.repositoryUrl,tsConfig.current_sheet_name);$0.set_showSaveAs(true);tab.LogOnViewModel.logOnAndTransitionSession($0);}}
tab.CardOrientation=function(){};tab.CardOrientation.prototype = {vertical:0,horizontal:1}
tab.CardOrientation.registerEnum('tab.CardOrientation',false);tab.DropIndicationState=function(){};tab.DropIndicationState.prototype = {rest:0,dropInvited:1,dropNotValid:2}
tab.DropIndicationState.registerEnum('tab.DropIndicationState',false);tab.ICardContent=function(){};tab.ICardContent.registerInterface('tab.ICardContent');tab.AnalyticsDropTargetViewModel=function(dropMeasures,dropPM,executeDefaultAddCommand){tab.AnalyticsDropTargetViewModel.initializeBase(this);this.$1_1=dropMeasures;this.$1_0=dropPM;this.$1_2=executeDefaultAddCommand;}
tab.AnalyticsDropTargetViewModel.prototype={$1_0:null,$1_1:null,$1_2:null,$1_3:null,get_dropLabel:function(){return this.$1_0.mc;},get_showDropMeasures:function(){return this.$1_0.hf;},get_dropZoneItems:function(){return this.$1_0.aun;},get_dropMeasureNamePairs:function(){return this.$1_1;},get_hoverTarget:function(){return this.$1_3;},set_hoverTarget:function(value){this.$1_3=value;this.notifyPropertyChanged('HoverTarget');return value;},executeDefaultAddCommand:function(){if(ss.isValue(this.$1_2)){this.$1_2();}},executeDropCommand:function(dropData){var $0=tab.CommandSerializer.deserialize(tab.SimpleCommandsPresModelWrapper.create(dropData.get_command()).get_simpleCommand());if(dropData.get_commandUsesFields()){var $1=[];if(ss.isValue(dropData.get_axis())){$1.push(dropData.get_axis().afc);}else{var $enum1=ss.IEnumerator.getEnumerator(this.$1_1);while($enum1.moveNext()){var $2=$enum1.current;if(tab.MiscUtil.isNullOrEmpty(dropData.get_excludedFields())||!dropData.get_excludedFields().contains($2.afc)){$1.push($2.afc);}}}$0.commandParams['aft']=$1;}tab.ServerCommands.executeServerCommand($0,'immediately',tab.CommandUtils.createCommandRedirectSuccessHandler(null),null);},setHoveredTarget:function(target){if(ss.isNullOrUndefined(target.get_command())){target=null;}this.set_hoverTarget(target);},removeHoveredTarget:function(target){if(this.$1_3===target){this.set_hoverTarget(null);}},getAxisDisplayName:function(axis){return tab.ApplicationModel.get_instance().get_workbook().findContentDashboard().get_activeVisual().get_vizDataModel().getVizDataField(axis).get_fieldCaption();}}
tab.AnalyticsPaneViewModel=function(){tab.AnalyticsPaneViewModel.initializeBase(this);}
tab.AnalyticsPaneViewModel.prototype={$1_0:null,get_analyticsItemViewModelLists:function(){var $0=[];if(ss.isValue(this.$1_0)){var $enum1=ss.IEnumerator.getEnumerator(this.$1_0.get_analyticsPresModel().aul);while($enum1.moveNext()){var $1=$enum1.current;var $2=[];if(ss.isValue($1.auj)){var $enum2=ss.IEnumerator.getEnumerator($1.auj);while($enum2.moveNext()){var $3=$enum2.current;var $4=(tab.MiscUtil.isNullOrEmpty($3.af8))?this.get_analyticsPaneModel().get_analyticsPresModel().af8:$3.af8;$2.add(new tab.AnalyticsListItemViewModel($3,$4));}}$0.add(new ss.Tuple($1.mb,$2));}}return $0;},get_analyticsPaneModel:function(){return this.$1_0;},set_analyticsPaneModel:function(value){this.$1_1();this.$1_0=value;this.$1_2();this.$1_0.add_newAnalyticsPane(ss.Delegate.create(this,this.$1_2));return value;},dispose:function(){this.$1_1();tab.AnalyticsPaneViewModel.callBaseMethod(this, 'dispose');},$1_1:function(){if(ss.isValue(this.$1_0)){this.$1_0.remove_newAnalyticsPane(ss.Delegate.create(this,this.$1_2));}},$1_2:function(){this.notifyPropertyChanged('AnalyticsPane');}}
tab.AnalyticsListItemViewModel=function(analyticsItem,dropAxes){tab.AnalyticsListItemViewModel.initializeBase(this);this.$1_0=analyticsItem;this.$1_1=dropAxes;}
tab.AnalyticsListItemViewModel.prototype={$1_0:null,$1_1:null,get_analyticsItem:function(){return this.$1_0;},startDrag:function(e){if(this.get_analyticsItem().an){var $0=new tab.AnalyticsDropTargetViewModel(this.$1_1,this.$1_0.auo,ss.Delegate.create(this,this.executeDefaultAddCommand));return new spiff.DragInstance($0,new tab.AnalyticsDragAvatar(this));}return null;},executeDefaultAddCommand:function(){if(!tab.FeatureFlags.isEnabled('AnalyticsObjectsDefaultDrop')||!this.get_analyticsItem().an){return;}if(ss.isValue(this.$1_0.aow)){var $0=tab.CommandSerializer.deserialize(tab.SimpleCommandsPresModelWrapper.create(this.$1_0.aow).get_simpleCommand());tab.ServerCommands.executeServerCommand($0,'immediately',tab.CommandUtils.createCommandRedirectSuccessHandler(null),null);}}}
tab.AuthoringTabViewModel=function(name,isWorksheet,isCurrent,navvm){tab.AuthoringTabViewModel.initializeBase(this);this.$1_0=name;this.isWorksheet=isWorksheet;this.$1_1=isCurrent;this.$1_2=navvm;}
tab.AuthoringTabViewModel.prototype={isWorksheet:true,$1_0:null,$1_1:false,$1_2:null,add_onTabChanged:function(value){this.$1_3=ss.Delegate.combine(this.$1_3,value);},remove_onTabChanged:function(value){this.$1_3=ss.Delegate.remove(this.$1_3,value);},$1_3:null,get_parent:function(){return this.$1_2;},get_name:function(){return this.$1_0;},set_name:function(value){this.$1_0=value;this.$1_4();return value;},get_isCurrent:function(){return this.$1_1;},set_isCurrent:function(value){this.$1_1=value;this.$1_4();return value;},renameWithPrompt:function(){var $0=this.$1_2.get_workbookTabs().map(function($p1_0){
return $p1_0.$1_0;});var $1=new tab.RenameSheetDialog(this.get_name(),$0,ss.Delegate.create(this,function($p1_0){
tab.SheetClientCommands.renameSheet(this.get_name(),$p1_0);}));$1.show();},buildMenu:function(){return spiff.MenuViewModel.createForMenu(this.$1_2.buildWorksheetMenu(this),tab.AuthoringCommandsViewModel.commandMenuItemClicked);},$1_4:function(){if(ss.isValue(this.$1_3)){this.$1_3();}}}
tab.AuthoringToolbarDropdownButtonViewModel=function(text,iconClass,menuBuilder){tab.AuthoringToolbarDropdownButtonViewModel.initializeBase(this,[text,iconClass,null]);tab.Param.verifyValue(menuBuilder,'menuBuilder');this.$2_0=menuBuilder;this.set_enabled(this.createMenu().get_menuItems().length>0);}
tab.AuthoringToolbarDropdownButtonViewModel.prototype={$2_0:null,createMenu:function(){return this.$2_0(null);},execute:function(){},dropdownClicked:function(relativeTo){var $0=this.createMenu();if(!$0.get_menuItems().length){return;}var $1=spiff.MenuViewModel.createForMenu($0,tab.AuthoringCommandsViewModel.commandMenuItemClicked);$1.add_hidden(ss.Delegate.create(this,function(){
this.set_isActive(false);}));var $2=spiff.ShowMenuOptions.create(relativeTo,false,relativeTo.outerWidth(false));$2.additionalMenuClass='tabAuthToolbarDropdownMenu';$1.show($2);this.set_isActive(true);}}
tab.AuthoringToolbarToggleButtonViewModel=function(text,iconClass,command,toggleToText){tab.AuthoringToolbarToggleButtonViewModel.initializeBase(this,[text,iconClass,command]);this.$2_0=toggleToText;}
tab.AuthoringToolbarToggleButtonViewModel.createFromCommandItems=function(commandItemOne,commandItemTwo,iconClassPrefix){var $0;var $1;var $2=tab.CommandItemWrapper.create(commandItemOne);var $3=tab.CommandItemWrapper.create(commandItemTwo);if(!ss.isValue($2.get_enabled())||$2.get_enabled()){$0=$2;$1=$3;}else if(!ss.isValue($3.get_enabled())||$3.get_enabled()){$0=$3;$1=$2;}else{return null;}var $4=tab.ToolbarButtonViewModel.createFromCommandItem($0.get_item(),iconClassPrefix);var $5=new tab.AuthoringToolbarToggleButtonViewModel($4.get_text(),$4.get_iconClass(),$4.get_buttonCommand(),$1.get_name());$5.disposables.add($4);$5.set_enabled(ss.isValue($1)&&!$1.get_enabled());if($5.get_enabled()){return $5;}return null;}
tab.AuthoringToolbarToggleButtonViewModel.prototype={$2_0:null,get_toggleToText:function(){return this.$2_0;},set_toggleToText:function(value){this.$2_0=value;return value;}}
tab.AuthoringToolbarUberPopupButtonViewModel=function(text,iconClass,uberPopupContent){tab.AuthoringToolbarUberPopupButtonViewModel.initializeBase(this,[text,iconClass,null]);this.$2_1=uberPopupContent;this.set_enabled(true);this.$2_0=ss.Delegate.create(this,function(){
this.set_isActive(false);});}
tab.AuthoringToolbarUberPopupButtonViewModel.prototype={$2_0:null,$2_1:null,vm:null,get_uberPopupContent:function(){return this.$2_1;},set_uberPopupContent:function(value){this.$2_1=value;return value;},buttonClicked:function(e){if(ss.isValue(this.vm)){this.dismissPopup();}else{this.vm=spiff.UberPopupViewModel.createForContent(this.$2_1);this.vm.add_hidden(this.$2_0);var $0=new spiff.UberPopupShowOptions(e);$0.additionalClass=tab.PaneTableView.suppressVizTooltipsAndOverlays;this.vm.show($0);this.set_isActive(true);}},dismissPopup:function(){if(ss.isValue(this.vm)){this.vm.hide();this.vm.remove_hidden(this.$2_0);this.vm=null;}}}
tab.AuthoringToolbarViewModel=function(worksheetMenuBuilder){this.$1_3=[];tab.AuthoringToolbarViewModel.initializeBase(this);if(ss.isNullOrUndefined(worksheetMenuBuilder)){this.$1_4=function($p1_0){
return new spiff.Menu([]);};}else{this.$1_4=worksheetMenuBuilder;}}
tab.AuthoringToolbarViewModel.prototype={$1_4:null,$1_5:null,add_itemsChanged:function(value){this.$1_6=ss.Delegate.combine(this.$1_6,value);},remove_itemsChanged:function(value){this.$1_6=ss.Delegate.remove(this.$1_6,value);},$1_6:null,get_items:function(){return this.$1_3;},updateCommands:function(commands,dashboardModel){if(ss.isNullOrUndefined(commands)||ss.isNullOrUndefined(dashboardModel)){return;}this.$1_7(commands,dashboardModel);this.raiseActionEvent(this.$1_6);},$1_7:function($p0,$p1){this.$1_8();var $0=tab.CommandsPresModelWrapper.create($p0);var $enum1=ss.IEnumerator.getEnumerator($0.get_commandItems().extract(0,$0.get_commandItems().length-1));while($enum1.moveNext()){var $1=$enum1.current;var $2=tab.CommandItemWrapper.create($1);switch($2.get_commandsType()){case 'separator':this.$1_3.add(tab.ToolbarButtonViewModel.createSeparator());break;case 'item':this.$1_9($1);break;case 'subcommands':if($2.get_iconRes()==='toggle-updates'||$2.get_iconRes()==='toggle-labels'){this.$1_A(tab.CommandsPresModelWrapper.create($2.get_commands()).get_commandItems());}else{var $3=[];tab.WidgetUtil.newMenuItemsFromCommands($3,$2.get_commands(),tab.WidgetUtil.createDropdownMenuCommands);if($2.get_iconRes()==='viewsize'){var $4=tab.CommandsPresModelWrapper.create($2.get_commands());for(var $5=0;$5<$3.length-1;$5++){var $6=tab.CommandItemWrapper.create($4.get_commandItems()[$5]);$3[$5].set_iconClassTwo('tabAuthToolbar-'+$6.get_iconRes());}}this.$1_B($1,new spiff.Menu($3));}break;}}this.$1_3.add(new tab.AuthoringToolbarDropdownButtonViewModel(tab.Strings.AuthToolbarWorksheet,'tabAuthToolbar-'+'worksheet',this.$1_4));this.$1_3.add(new tab.AuthoringToolbarDropdownButtonViewModel(tab.Strings.AuthToolbarExport,'tabAuthToolbar-'+'export',ss.Delegate.create(this,function(){
return this.$1_C($p1);})));this.$1_3.add(tab.ToolbarButtonViewModel.createSeparator());if(ss.isNullOrUndefined(this.$1_5)){this.$1_5=new tab.AuthoringToolbarUberPopupButtonViewModel(tab.Strings.AuthToolbarShowMe,'tabAuthToolbar-'+'showme',new tab.ShowMeViewModel());}this.$1_3.add(this.$1_5);},$1_8:function(){var $enum1=ss.IEnumerator.getEnumerator(this.$1_3);while($enum1.moveNext()){var $0=$enum1.current;$0.dispose();}this.$1_3.clear();},$1_9:function($p0){var $0=tab.ToolbarButtonViewModel.createFromCommandItem($p0,'tabAuthToolbar-');this.$1_3.add($0);},$1_A:function($p0){if($p0.length!==2){return;}var $0=tab.AuthoringToolbarToggleButtonViewModel.createFromCommandItems($p0[0],$p0[1],'tabAuthToolbar-');if($0!=null){this.$1_3.add($0);}},$1_B:function($p0,$p1){var $0=tab.CommandItemWrapper.create($p0);var $1=new tab.AuthoringToolbarDropdownButtonViewModel($0.get_name(),'tabAuthToolbar-'+$0.get_iconRes(),function(){
return $p1;});this.$1_3.add($1);},$1_C:function($p0){var $0=tab.Application.get_instance().get_client();var $1=$0.get_toolbarCommands();var $2=spiff.MenuItem.newActionItem(tab.Strings.ToolbarExportData,ss.Delegate.create($1,$1.exportData));var $3=spiff.MenuItem.newActionItem(tab.Strings.ToolbarExportCrosstab,ss.Delegate.create($1,$1.exportCrosstab));var $4=false;if(ss.isValue($p0.get_activeVisual())&&ss.isValue($p0.get_activeVisual())&&ss.isValue($p0.get_activeVisual().get_shelves())&&ss.isValue($p0.get_activeVisual().get_shelves().get_shelves())){var $enum1=ss.IEnumerator.getEnumerator($p0.get_activeVisual().get_shelves().get_shelves());while($enum1.moveNext()){var $5=$enum1.current;if($5.get_pills().length>0){$4=true;break;}}}$2.set_enabled($4);$3.set_enabled($4);return new spiff.Menu([spiff.MenuItem.newActionItem(tab.Strings.ToolbarExportImage,ss.Delegate.create($1,$1.exportImage)),$2,$3,spiff.MenuItem.newActionItem(tab.Strings.ToolbarPrintToPdf,ss.Delegate.create($1,$1.exportPdf))]);}}
tab.AuthoringViewModel=function(){tab.AuthoringViewModel.initializeBase(this);this.$1_2=new tab.DataSchemaViewModel();if(tsConfig.features['AnalyticsPane']&&!!tab.FeatureParamsLookup.getBool(tab.FeatureParam.aoPaneUI)){this.$1_3=new tab.AnalyticsPaneViewModel();}this.$1_7=new tab.AuthoringCommandsViewModel();this.$1_6=new tab.AuthoringTabNavViewModel(this.$1_7);this.$1_1=new tab.AuthoringToolbarViewModel(ss.Delegate.create(this.get_authoringTabNavViewModel(),this.get_authoringTabNavViewModel().buildWorksheetMenu));if(!tsConfig.is_mobile_app){this.$1_5=new tab.AuthoringMastheadViewModel();}tab.Application.get_instance().add_clientChanged(ss.Delegate.create(this,function(){
this.notifyPropertyChanged('Client');}));this.$1_0={};this.$1_0['columns']=this.$1_15(1);this.$1_0['rows']=this.$1_15(1);this.$1_0['pages']=this.$1_15(0);this.$1_0['filters']=this.$1_15(0);this.$1_0['marks']=this.$1_15(0);this.$1_0['measureValues']=this.$1_15(0);this.$1_4=new tab.VizSummaryViewModel();if(tab.FeatureFlags.isEnabled('NonModalCalculationDialog')){this.$1_8=new tab.CalculationEditorViewModel(tab.ApplicationModel.get_instance().get_calculationModel(),tab.ApplicationModel.get_instance().get_calculationFunctionListModel());}tab.StartupUtils.callAfterBootstrap(ss.Delegate.create(this,this.$1_D));tab.ApplicationModel.get_instance().get_workbook().addNewDashboardHandler(ss.Delegate.create(this,this.handleNewDashboard));}
tab.AuthoringViewModel.prototype={$1_0:null,$1_1:null,$1_2:null,$1_3:null,$1_4:null,$1_5:null,$1_6:null,$1_7:null,$1_8:null,$1_9:null,$1_A:null,$1_B:null,add_shelvesModified:function(value){this.$1_C=ss.Delegate.combine(this.$1_C,value);},remove_shelvesModified:function(value){this.$1_C=ss.Delegate.remove(this.$1_C,value);},$1_C:null,get_client:function(){return tab.Application.get_instance().get_client();},get_toolbarViewModel:function(){return this.$1_1;},get_authoringMastheadViewModel:function(){return this.$1_5;},get_authoringTabNavViewModel:function(){return this.$1_6;},get_analyticsViewModel:function(){return this.$1_3;},get_cards:function(){return this.$1_0;},get_dataSchemaViewModel:function(){return this.$1_2;},get_dataSchema:function(){return tab.ApplicationModel.get_instance().get_workbook().get_dataSchema();},get_vizSummaryViewModel:function(){return this.$1_4;},get_calculationEditorViewModel:function(){return this.$1_8;},dispose:function(){var $dict1=this.$1_0;for(var $key2 in $dict1){var $0={key:$key2,value:$dict1[$key2]};$0.value.dispose();}if(ss.isValue(this.$1_9)){this.$1_9.dispose();}if(ss.isValue(this.$1_3)){this.$1_3.dispose();}this.$1_1.dispose();this.$1_2.dispose();this.$1_6.dispose();this.$1_4.dispose();if(ss.isValue(this.$1_5)){this.$1_5.dispose();}this.$1_10();this.$1_12();if(ss.isValue(this.$1_8)){this.$1_8.dispose();}tab.AuthoringViewModel.callBaseMethod(this, 'dispose');},updatePortSizeAfterManualLayout:function(){var $0=this.get_client().get_domNode();var $1={};$1.wb=$0.width();$1.wc=$0.height();var $2={};var $3=$.extend(true,{},tabBootstrap.ViewerBootstrap.get_instance().metricsUsedForInitialLayout);$2.ay3=$3.toPresModel();tab.SheetClientCommands.setPortSize($1,$2);},buildShelves:function(){var $0=[this.$1_0['columns'],this.$1_0['rows'],this.$1_0['filters'],this.$1_0['pages'],this.$1_0['measureValues']];var $1=tab.ModelUtils.findActiveOrDefaultVisual().get_shelves();if(ss.isValue($1)&&ss.isValue($1.get_shelves())){var $enum1=ss.IEnumerator.getEnumerator($1.get_shelves());while($enum1.moveNext()){var $2=$enum1.current;var $3;switch($2.get_shelfType()){case 'columns-shelf':$3=this.$1_0['columns'];break;case 'rows-shelf':$3=this.$1_0['rows'];break;case 'pages-shelf':$3=this.$1_0['pages'];break;case 'measures-shelf':$3=this.$1_0['measureValues'];break;case 'filter-shelf':$3=this.$1_0['filters'];break;case 'encoding-shelf':this.$1_9.addEncodingShelf($2);continue;default:continue;}var $4=$3.get_content();$4.set_shelf($2);$3.set_content($4);$0.remove($3);}}var $enum2=ss.IEnumerator.getEnumerator($0);while($enum2.moveNext()){var $5=$enum2.current;var $6=$5.get_content();$6.set_shelf(null);}},$1_D:function(){tab.ApplicationModel.get_instance().get_workbook().get_commands().add_commandsChanged(ss.Delegate.create(this,this.$1_17));if(!this.$1_E()){this.$1_F();}},$1_E:function(){var $0=document.referrer===tab.WindowHelper.getLocation(window.self).href;if(!$0&&tab.ApplicationModel.get_instance().get_workbook().get_isWorkbookModifiedAuthoring()){tab.NotificationViewModel.showNotification(tab.Strings.AuthAutoRecoveredSessionMessage,-1);return true;}return false;},$1_F:function(){if(tsConfig.isBootstrapFromAutoSave){tab.NotificationViewModel.showNotification(tab.Strings.AuthAutoSavedRecoveredMessage,-1);}},handleNewDashboard:function(newDashboard){this.$1_10();this.$1_A=newDashboard;if(ss.isValue(this.$1_A)){this.$1_A.get_zonesModel().add_newZone(ss.Delegate.create(this,this.$1_11));}this.$1_2.set_dataSchema(tab.ApplicationModel.get_instance().get_workbook().get_dataSchema());this.$1_13(tab.ModelUtils.findActiveOrDefaultVisual());this.$1_17(tab.ApplicationModel.get_instance().get_workbook().get_commands());},$1_10:function(){if(ss.isNullOrUndefined(this.$1_A)){return;}this.$1_A.get_zonesModel().remove_newZone(ss.Delegate.create(this,this.$1_11));this.$1_A=null;},$1_11:function($p0){if($p0.get_zoneType()==='viz'){this.$1_13($p0.get_visualModel());}},$1_12:function(){if(ss.isNullOrUndefined(this.$1_B)){return;}this.$1_B.get_shelves().remove_newShelves(ss.Delegate.create(this,this.$1_14));this.$1_B=null;},$1_13:function($p0){this.$1_12();this.$1_B=$p0;if(ss.isNullOrUndefined(this.$1_B)){return;}if(ss.isValue(this.$1_3)&&ss.isValue(this.$1_B.get_analyticsModel())){this.$1_3.set_analyticsPaneModel(this.$1_B.get_analyticsModel());}this.$1_4.update(this.$1_2,this.$1_B.get_shelves(),this.$1_B.get_marksCardModel());if(ss.isValue(this.$1_9)){this.$1_9.dispose();}this.$1_9=new tab.MarksContentViewModel(this.$1_B.get_marksCardModel());this.$1_0['marks'].set_content(this.$1_9);this.$1_B.get_shelves().add_newShelves(ss.Delegate.create(this,this.$1_14));this.buildShelves();},$1_14:function(){this.buildShelves();this.$1_2.clearSelection();this.$1_16(this.$1_C);},$1_15:function($p0){var $0=new tab.CardViewModel();$0.set_content(new tab.ShelfViewModel());$0.set_isCollapsed(false);$0.set_orientation($p0);return $0;},$1_16:function($p0){if(ss.isValue($p0)){$p0(this,ss.EventArgs.Empty);}},$1_17:function($p0){if(ss.isNullOrUndefined($p0)){return;}this.$1_7.update($p0.get_commands());this.$1_1.updateCommands($p0.get_commands(),this.$1_A);}}
tab.BaseFieldDragInstance=function(dragged,dragAvatar){this.finalDrop=$.DeferredData();tab.BaseFieldDragInstance.initializeBase(this,[dragged,dragAvatar]);}
tab.BaseFieldDragInstance.prototype={drag:null,get_dropPresModels:function(){return (this.finalDrop.isResolved())?this.drag.axl:new Array(0);},get_drop:function(){return this.finalDrop;},dropPositionToReplacePill:function(pill){var $0=pill.get_shelf().matchingDropsFrom(this);var $1=pill.get_indexInShelf();if(ss.isNullOrUndefined($0)){var $2={};$2.wz=$1;$2.akb='replace';return $2;}return _.find($0.axj,function($p1_0){
return $p1_0.akb==='replace'&&$p1_0.wz===$1;});},dropPositionForShelf:function(shelf,index){var $0=shelf.matchingDropsFrom(this);if(!ss.isValue($0)){return null;}var $1=_.find($0.axj,function($p1_0){
return (($p1_0.akb||'insert')==='insert')&&$p1_0.wz===(index||0);});if(ss.isNullOrUndefined($1)){$1=_.find($0.axj,function($p1_0){
return !ss.isValue(index)||$p1_0.wz===index;});}return $1;},blindDropsMatchingShelf:function(shelf){var $0={};$0.ajv=shelf.get_shelfType();var $1=[];if(shelf.$1_10()){var $2={};$2.akb='insert';$2.ahq='invalid-encoding';$2.ajv=shelf.get_shelfType();$2.wz=0;$1.add($2);}else{var $3=this.get_fields()[0].get_defaultFieldType();for(var $4=0;$4<shelf.get_pills().length;$4++){if(shelf.get_pills()[$4].get_field().get_defaultFieldType()===$3){var $5={};$5.akb='replace';$5.ajv=shelf.get_shelfType();$5.wz=$4;$1.add($5);}}}$0.axj=$1;return $0;},dropsMatchingShelf:function(shelf){if(!this.get_drop().isResolved()){return this.blindDropsMatchingShelf(shelf);}else{return _.find(this.get_dropPresModels(),function($p1_0){
return $p1_0.ajv===shelf.get_shelfType();});}},fieldsToDropOnShelf:function(st){if(!this.finalDrop.isResolved()){return this.get_fields();}var $0=[];var $enum1=ss.IEnumerator.getEnumerator(this.drag.axl);while($enum1.moveNext()){var $1=$enum1.current;if($1.ajv===st){var $2=tab.ApplicationModel.get_instance().get_workbook().get_dataSchema();var $enum2=ss.IEnumerator.getEnumerator($1.apy);while($enum2.moveNext()){var $3=$enum2.current;var $4=$2.findField($3.afc);if(ss.isValue($4)){$0.add($4);}}}}return $0;}}
tab.CalculationFunctionListViewModel=function(model){tab.CalculationFunctionListViewModel.initializeBase(this);this.$1_0=model;this.$1_0.add_functionListUpdated(ss.Delegate.create(this,this.$1_2));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$1_0.remove_functionListUpdated(ss.Delegate.create(this,this.$1_2));})));this.$1_1=new spiff.ListViewModel(null);this.$1_2();}
tab.CalculationFunctionListViewModel.prototype={$1_0:null,$1_1:null,get_model:function(){return this.$1_0;},get_functions:function(){return this.$1_0.get_functions();},get_listViewModel:function(){return this.$1_1;},dispose:function(){this.$1_1.dispose();tab.CalculationFunctionListViewModel.callBaseMethod(this, 'dispose');},$1_2:function(){var $0=[];var $1=this.$1_0.get_functions();for(var $2=0,$3=$1.length;$2<$3;$2++){var $4=$1[$2];$0.add(spiff.ListItemViewModel.newListItem($2.toString(),$4.mb,$4));}this.$1_1.update($0);}}
tab.CalculationEditorViewModel=function(model,calculationFunctionListModel){this.$1_7=0;tab.CalculationEditorViewModel.initializeBase(this);this.$1_0=model;if(ss.isValue(calculationFunctionListModel)){this.$1_1=new tab.CalculationFunctionListViewModel(calculationFunctionListModel);}this.$1_0.add_calculationUpdated(ss.Delegate.create(this,this.$1_19));spiff.DragDropManager.add_dragStarted(ss.Delegate.create(this,this.dragStarted));spiff.DragDropManager.add_dragEnded(ss.Delegate.create(this,this.dragEnded));this.$1_6=0;if(this.get_$1_14()){this.$1_1A();}}
tab.CalculationEditorViewModel.canAccept=function(d){var $0=Type.safeCast(d,tab.BaseFieldDragInstance);if(!d.get_hasPayload()||ss.isNullOrUndefined($0)){return false;}if(Type.canCast($0,tab.PillDragInstance)){var $1=$0.get_fields();if($1==null){return false;}return _.every($1,function($p1_0){
return $p1_0.get_isAllowedInCalcs()||$p1_0.get_isUnnamedCalc();});}else if(Type.canCast($0,tab.CalcTextDragInstance)){return true;}return false;}
tab.CalculationEditorViewModel.prototype={$1_0:null,$1_1:null,$1_2:null,$1_3:null,$1_4:null,$1_5:null,$1_6:0,$1_8:null,$1_9:false,$1_A:true,add_calculationUpdated:function(value){this.$1_B=ss.Delegate.combine(this.$1_B,value);},remove_calculationUpdated:function(value){this.$1_B=ss.Delegate.remove(this.$1_B,value);},$1_B:null,add_calculationEdited:function(value){this.$1_C=ss.Delegate.combine(this.$1_C,value);},remove_calculationEdited:function(value){this.$1_C=ss.Delegate.remove(this.$1_C,value);},$1_C:null,add_calculationCanceled:function(value){this.$1_D=ss.Delegate.combine(this.$1_D,value);},remove_calculationCanceled:function(value){this.$1_D=ss.Delegate.remove(this.$1_D,value);},$1_D:null,add_dropStateChanged:function(value){this.$1_E=ss.Delegate.combine(this.$1_E,value);},remove_dropStateChanged:function(value){this.$1_E=ss.Delegate.remove(this.$1_E,value);},$1_E:null,add_dirtyStateChanged:function(value){this.$1_F=ss.Delegate.combine(this.$1_F,value);},remove_dirtyStateChanged:function(value){this.$1_F=ss.Delegate.remove(this.$1_F,value);},$1_F:null,add_dropCommandCompleted:function(value){this.$1_10=ss.Delegate.combine(this.$1_10,value);},remove_dropCommandCompleted:function(value){this.$1_10=ss.Delegate.remove(this.$1_10,value);},$1_10:null,add_insertFunctionCompleted:function(value){this.$1_11=ss.Delegate.combine(this.$1_11,value);},remove_insertFunctionCompleted:function(value){this.$1_11=ss.Delegate.remove(this.$1_11,value);},$1_11:null,add_applyErrorMessageCompleted:function(value){this.$1_12=ss.Delegate.combine(this.$1_12,value);},remove_applyErrorMessageCompleted:function(value){this.$1_12=ss.Delegate.remove(this.$1_12,value);},$1_12:null,add_applyCalculationSuccess:function(value){this.$1_13=ss.Delegate.combine(this.$1_13,value);},remove_applyCalculationSuccess:function(value){this.$1_13=ss.Delegate.remove(this.$1_13,value);},$1_13:null,get_$1_14:function(){return ss.isValue(this.$1_0)&&this.$1_0.get_hasCalculation();},get_hasCalculation:function(){return this.get_$1_14()&&ss.isValue(this.$1_8);},get_isNewCalculation:function(){return this.$1_0.get_isNewCalculation();},get_isDirty:function(){return this.$1_9;},set_isDirty:function(value){if(this.$1_9!==value){this.$1_9=value;if(ss.isValue(this.$1_F)){this.$1_F(this.$1_9);}}return value;},get_isCaptionDirty:function(){return ss.isValue(this.$1_8)&&this.$1_8.$5(this.get_caption());},get_isFormulaDirty:function(){return ss.isValue(this.$1_8)&&this.$1_8.$6(this.get_formula());},get_shelfType:function(){return this.$1_0.get_adHocShelf();},get_shelfPaneSpecId:function(){return this.$1_0.get_adHocPaneSpecId();},get_shelfPosition:function(){return this.$1_0.get_adHocShelfPosition();},get_tokens:function(){return this.$1_3;},get_errors:function(){return this.$1_0.get_errors();},get_caption:function(){return this.$1_2;},set_caption:function(value){if(this.$1_2!==value){this.$1_2=value;this.$1_1C();this.$1_15();}return value;},get_formula:function(){return this.$1_4;},set_formula:function(value){if(this.$1_4!==value){this.$1_4=value;this.$1_1C();this.$1_15();}return value;},get_dataSourceCaption:function(){return this.$1_0.get_dataSourceCaption();},get_shouldShowDataSourceCaption:function(){var $0=tab.ApplicationModel.get_instance().get_workbook().get_dataSchema();if(ss.isNullOrUndefined($0)){return false;}else{return $0.getDataSourceCount(false)>1;}},get_hasErrors:function(){return this.$1_0.get_errors().length>0;},get_hasDependencies:function(){return !String.isNullOrEmpty(this.get_dependencies());},get_dependencies:function(){return this.$1_0.get_dependencies();},get_functionListViewModel:function(){return this.$1_1;},get_dropState:function(){return this.$1_7;},set_dropState:function(value){if(this.$1_7===value){return;}this.$1_7=value;if(ss.isValue(this.$1_E)){this.$1_E(this.$1_7);}return value;},dispose:function(){this.$1_18();this.$1_0.remove_calculationUpdated(ss.Delegate.create(this,this.$1_19));if(ss.isValue(this.$1_1)){this.$1_1.dispose();}spiff.DragDropManager.remove_dragStarted(ss.Delegate.create(this,this.dragStarted));spiff.DragDropManager.remove_dragEnded(ss.Delegate.create(this,this.dragEnded));tab.CalculationEditorViewModel.callBaseMethod(this, 'dispose');},isValidFormula:function(){return !this.$1_6&&!String.isNullOrEmpty(this.get_formula())&&!this.get_errors().length;},isCaptionStringDirty:function(caption){return ss.isValue(this.$1_8)&&this.$1_8.$5(caption);},$1_15:function(){this.set_isDirty(ss.isValue(this.$1_8)&&this.$1_8.$4(this));},$1_16:function(){if(!this.$1_0.get_hasCalculation()){this.$1_8=null;}else if(String.isNullOrEmpty(this.$1_0.get_fieldName())){this.$1_8=new tab.vqlauthoring$4(this.$1_0.get_name(),this.$1_0.get_caption(),'');}else{this.$1_8=new tab.vqlauthoring$4(this.$1_0.get_name(),this.$1_0.get_caption(),this.$1_0.get_formula());}},applyCalculation:function(pillViewModel,closeOnCommit){if(!this.get_$1_14()){return;}this.$1_18();if(this.$1_0.get_isAdhoc()&&tab.MiscUtil.isNullOrEmpty(this.$1_4)){if(pillViewModel!=null){tab.ShelfClientCommands.removeShelfPill(pillViewModel.get_shelf().get_shelf(),pillViewModel.get_pill());}if(closeOnCommit){this.cancelCalculation();}this.$1_17(closeOnCommit);return;}this.set_isDirty(false);var $0=this.$1_8;this.$1_8=new tab.vqlauthoring$4($0.get_$3(),this.$1_2,this.$1_4);var $1=tab.CalculationCommands.applyCalculation(this.$1_0,this.$1_2,this.$1_4,false,closeOnCommit);$1.done(ss.Delegate.create(this,function($p1_0){
if($p1_0.get_resultType()==='succeed'){this.$1_16();this.$1_17(closeOnCommit);}else{this.$1_8=$0;var $1_0=$p1_0.get_resultType()!=='invalid-caption-for-new-calc';this.showApplyCalcErrorDialog($p1_0.get_errorMessage(),$1_0);}})).always(ss.Delegate.create(this,function(){
this.$1_15();}));},showApplyCalcErrorDialog:function(errorMsg,allowReApply){if(String.isNullOrEmpty(errorMsg)){return;}var $0=tab.ConfirmationViewModel.create(errorMsg.htmlEncode(),ss.Delegate.create(this,function($p1_0){
if($p1_0==='deny'){tab.CalculationCommands.applyCalculation(this.$1_0,this.$1_2,this.$1_4,true,false);}this.raiseActionEvent(this.$1_12);}));if(!allowReApply){$0.set_showDenyButton(false);$0.set_confirmText(tab.Strings.DialogButtonOK);}$0.show();},$1_17:function($p0){if(ss.isValue(this.$1_13)){this.$1_13($p0);}},cancelCalculation:function(){this.$1_18();tab.CalculationCommands.cancelCalculation(this.$1_0);},$1_18:function(){if(ss.isValue(this.$1_5)){window.clearTimeout(this.$1_5);this.$1_5=null;}},$1_19:function(){if(!this.get_$1_14()){if(ss.isValue(this.$1_8)){this.$1_16();this.raiseActionEvent(this.$1_D);}this.$1_15();}else if(ss.isValue(this.$1_8)&&this.$1_8.get_$3()===this.$1_0.get_name()){if(!this.$1_6&&this.$1_5==null){this.$1_1B();this.raiseActionEvent(this.$1_B);}}else{this.$1_1A();}},$1_1A:function(){try{this.$1_A=false;this.$1_16();this.$1_1B();this.raiseActionEvent(this.$1_C);}finally{this.$1_A=true;}},$1_1B:function(){this.$1_2=this.$1_0.get_caption();this.$1_3=this.$1_0.get_tokens();this.$1_4=this.$1_0.get_formula();this.$1_15();},requestAutoCompleteMenu:function(context,position){if(this.$1_A&&this.get_hasCalculation()){return tab.CalculationCommands.requestAutoCompleteInfoWithContext(context,position,this.$1_0.get_isAdhoc());}else{return $.DeferredData().reject();}},getDragInstanceForText:function(text){var $0=new tab.CalcTextDragInstance(text);var $1=tab.CalculationCommands.startDraggingText(text);$1.done(function($p1_0){
if(ss.isValue($p1_0)&&ss.isValue($p1_0)){$0.resolve($p1_0);}else{$0.reject($p1_0);}});return $0;},dragStarted:function(d){if(d.get_dragType()==='dragdrop'){this.set_dropState((tab.CalculationEditorViewModel.canAccept(d))?1:2);}else{this.set_dropState(0);}},dragEnded:function(d){this.set_dropState(0);},handleDrop:function(d,dropPosition,selection){var $0=$.DeferredData();if(!(Type.canCast(d,tab.BaseFieldDragInstance))){$0.resolve(false);return $0;}var $1=ss.Delegate.create(this,function($p1_0){
var $1_0=tab.CalculationEditorViewModel.canAccept($p1_0);if(!$1_0){}else if($p1_0.hasOnlyFields()){var $1_1=_.map($p1_0.get_fields(),function($p2_0){
return $p2_0.get_globalName();});this.$1_1D();var $1_2;if(Type.canCast($p1_0,tab.CalcTextDragInstance)){var $1_3=($p1_0).get_text();$1_2=tab.CalculationCommands.dropOnCalcEditor($1_1,dropPosition,'drag-drop-dialog',selection,this.$1_0.get_isAdhoc(),$1_3);}else{$1_2=tab.CalculationCommands.dropOnCalcEditor($1_1,dropPosition,'drag-drop-schema',selection,this.$1_0.get_isAdhoc());}$1_2.done(ss.Delegate.create(this,this.$1_1E));}else if($p1_0.hasOnlyPills()){var $1_4=[];$1_4.add($p1_0.get_pill().get_field().get_globalName());this.$1_1D();var $1_5=tab.CalculationCommands.dropOnCalcEditor($1_4,dropPosition,'drag-drop-viz',selection,this.$1_0.get_isAdhoc());$1_5.done(ss.Delegate.create(this,this.$1_1E));}$0.resolve($1_0);});var $2=Type.safeCast(d,tab.BaseFieldDragInstance);if($2.get_drop().isResolved()){$1($2);}else{$2.get_drop().done($1);}return $0;},insertFunction:function(funcModel,selection){var $0=this.get_formula();var $1=tab.CalculationCommands.insertFunctionInFormula(funcModel,$0,selection);$1.done(ss.Delegate.create(this,function($p1_0){
if(ss.isNullOrUndefined($p1_0)||_.isString($p1_0)){return;}var $1_0=$p1_0;var $1_1=$1_0['sg'];var $1_2=$1_0['za'];$0=$0.substr(0,selection.yi)+$1_1+$0.substr(selection.yj);if(ss.isValue(this.$1_11)){this.$1_11($0,$1_2);}else{this.set_formula($0);}}));},$1_1C:function(){this.$1_18();this.$1_5=window.setTimeout(ss.Delegate.create(this,function(){
this.$1_1D();}),250);},$1_1D:function(){if(ss.isNullOrUndefined(this.$1_5)){return;}this.$1_18();this.$1_6++;var $0=tab.CalculationCommands.validateCalculation(this.$1_0,this.$1_2,this.$1_4);$0.always(ss.Delegate.create(this,function(){
this.$1_6--;}));},$1_1E:function($p0){if(ss.isValue(this.$1_10)){this.$1_10($p0);}}}
tab.vqlauthoring$4=function(name,caption,formula){this.$0=name;this.$1=caption;this.$2=formula;}
tab.vqlauthoring$4.prototype={$0:null,$1:null,$2:null,get_$3:function(){return this.$0;},$4:function($p0){return this.$5($p0.get_caption())||this.$6($p0.get_formula());},$5:function($p0){return this.$1!==$p0;},$6:function($p0){return this.$2!==$p0;}}
tab.CardViewModel=function(){tab.CardViewModel.initializeBase(this);}
tab.CardViewModel.prototype={$1_0:0,$1_1:false,$1_2:null,add_cardChanged:function(value){this.$1_3=ss.Delegate.combine(this.$1_3,value);},remove_cardChanged:function(value){this.$1_3=ss.Delegate.remove(this.$1_3,value);},$1_3:null,add_collapsedChanged:function(value){this.$1_4=ss.Delegate.combine(this.$1_4,value);},remove_collapsedChanged:function(value){this.$1_4=ss.Delegate.remove(this.$1_4,value);},$1_4:null,add_contentDropStateChanged:function(value){this.$1_5=ss.Delegate.combine(this.$1_5,value);},remove_contentDropStateChanged:function(value){this.$1_5=ss.Delegate.remove(this.$1_5,value);},$1_5:null,get_orientation:function(){return this.$1_0;},set_orientation:function(value){this.$1_0=value;this.handleCardChanged();return value;},get_isVisible:function(){return ss.isValue(this.$1_2)&&this.$1_2.get_isVisible();},get_isCollapsible:function(){return !this.$1_0;},get_isCollapsed:function(){return this.$1_1;},set_isCollapsed:function(value){this.$1_1=value;this.handleCollapsedChanged();return value;},get_hasIcon:function(){return this.$1_0===1;},get_iconClass:function(){var $0=this.$1_2;switch($0.get_shelfType()){case 'rows-shelf':return 'Rows';case 'columns-shelf':return 'Columns';default:return null;}},get_content:function(){return this.$1_2;},set_content:function(value){if(ss.isValue(this.$1_2)){this.$1_2.remove_dropStateChanged(ss.Delegate.create(this,this.$1_6));this.$1_2.remove_visibleChanged(ss.Delegate.create(this,this.$1_7));}this.$1_2=value;if(ss.isValue(this.$1_2)){this.$1_2.add_dropStateChanged(ss.Delegate.create(this,this.$1_6));this.$1_2.add_visibleChanged(ss.Delegate.create(this,this.$1_7));}this.handleCardChanged();return value;},toggleExpanded:function(){if(!this.get_isCollapsible()){return;}this.set_isCollapsed(!this.$1_1);},handleCardChanged:function(){if(ss.isValue(this.$1_3)){this.$1_3(this);}},handleCollapsedChanged:function(){if(ss.isValue(this.$1_4)){this.$1_4(this);}},$1_6:function($p0){if(ss.isNullOrUndefined(this.$1_5)){return;}this.$1_5($p0);},$1_7:function(){this.handleCardChanged();}}
tab.ColorPickerViewModel=function(layerEncodingModel){tab.ColorPickerViewModel.initializeBase(this,[layerEncodingModel]);}
tab.ColorPickerViewModel.prototype={$1_8:null,get_viewType:function(){return tab.ColorPickerView;},get_selectedColor:function(){return this.$1_8;},set_selectedColor:function(value){if(this.$1_8===value){return;}this.$1_8=value;tab.PaneClientCommands.setDefaultColor(this.get_layerEncodingModel(),this.$1_8);return value;},get_blackAndWhiteColors:function(){return _.map(tab.ColorPickerViewModel.$1_3,function($p1_0){
return tab.ColorModel.fromColorCode($p1_0);});},get_lightGrayColors:function(){return _.map(tab.ColorPickerViewModel.$1_5,function($p1_0){
return tab.ColorModel.fromColorCode($p1_0);});},get_darkGrayColors:function(){return _.map(tab.ColorPickerViewModel.$1_4,function($p1_0){
return tab.ColorModel.fromColorCode($p1_0);});},get_presetColors1:function(){return _.map(tab.ColorPickerViewModel.$1_6,function($p1_0){
return tab.ColorModel.fromColorCode($p1_0);});},get_presetColors2:function(){return _.map(tab.ColorPickerViewModel.$1_7,function($p1_0){
return tab.ColorModel.fromColorCode($p1_0);});},update:function(color){this.$1_8=color;}}
tab.IconUtils=function(){}
tab.IconUtils.getPrimitiveTypeIcon=function(type){var $0=type.aik;return 'tabAuthPrimitive-'+$0;}
tab.IconUtils.getFieldIcon=function(f){if(!ss.isValue(f.fieldIconResource)){return '';}var $0=new ss.StringBuilder('tab-schema-');$0.append(f.fieldIconResource);$0.append('-icon');return $0.toString();}
tab.IconUtils.getDataSourceIcon=function(iconMap,source){if(ss.isNullOrUndefined(iconMap)){return '';}var $0=(Object.keyExists(iconMap,source.get_name()))?iconMap[source.get_name()]:null;if(!ss.isValue($0)){return '';}var $1=new ss.StringBuilder('tab-schema-');$1.append($0);$1.append('-icon');return $1.toString();}
tab.IconUtils.getPillEncodingTypeIcon=function(p){if(ss.isNullOrUndefined(p.get_encodingType())){return null;}return tab.IconUtils.getEncodingTypeIcon(p.get_encodingType());}
tab.IconUtils.getEncodingTypeIcon=function(et){switch(et){case 'color-encoding':case 'size-encoding':case 'text-encoding':case 'shape-encoding':case 'sort-encoding':case 'wedge-size-encoding':return 'tabAuth-'+et;default:return 'tabAuth-lod-encoding';}}
tab.IconUtils.getPillFilterTypeIcon=function(p){if(ss.isNullOrUndefined(p.get_filterType())){return null;}switch(p.get_filterType()){case 'global-filter':return 'tabAuthPillGlobalFilter';case 'shared-filter':return 'tabAuthPillSharedFilter';case 'slice-filter':return 'tabAuthPillSliceFilter';default:return null;}}
tab.IconUtils.getPillIcons=function(p){var $0=p.get_item().ajh;if(ss.isNullOrUndefined($0)||!$0.length){return [];}var $1=[];var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $2=$enum1.current;switch($2){case 'secondary-datasource':$1.add('tabAuthPillIconSecondary');break;case 'table-calc':$1.add('tabAuthPillIconTableCalc');break;case 'table-calc-secondary':$1.add('tabAuthPillIconTableCalcSecondary');break;case 'sort-asc':$1.add('tabAuthPillIconSortAscending');break;case 'sort-desc':$1.add('tabAuthPillIconSortDescending');break;case 'forecast':$1.add('tabAuthPillIconForecast');break;case 'remote':break;}if('group'===$2){$1.add('tabAuthPillIconSet');}}return $1;}
tab.IconUtils.getLayerIcon=function(layer){return (ss.isValue(layer.get_currentPrimitiveType())&&layer.get_currentPrimitiveType().aik==='multiple')?'':tab.IconUtils.getPrimitiveTypeIcon(layer.get_currentPrimitiveType());}
tab.LayerEncodingViewModel=function(){this.$1_0=new tab.ShelfViewModel();this.$1_1='invalid-encoding';tab.LayerEncodingViewModel.initializeBase(this);spiff.DragDropManager.add_dragStarted(ss.Delegate.create(this,this.dragStarted));spiff.DragDropManager.add_dragEnded(ss.Delegate.create(this,this.dragEnded));}
tab.LayerEncodingViewModel.$1_6=function($p0,$p1){return $p0.get_item().ahq===$p1;}
tab.LayerEncodingViewModel.prototype={layerEncoding:null,$1_2:null,add_modelChanged:function(value){this.$1_3=ss.Delegate.combine(this.$1_3,value);},remove_modelChanged:function(value){this.$1_3=ss.Delegate.remove(this.$1_3,value);},$1_3:null,add_dragOverEncodingChanged:function(value){this.$1_4=ss.Delegate.combine(this.$1_4,value);},remove_dragOverEncodingChanged:function(value){this.$1_4=ss.Delegate.remove(this.$1_4,value);},$1_4:null,add_validDropEncodingsChanged:function(value){this.$1_5=ss.Delegate.combine(this.$1_5,value);},remove_validDropEncodingsChanged:function(value){this.$1_5=ss.Delegate.remove(this.$1_5,value);},$1_5:null,get_validDropEncodings:function(){return this.$1_2;},set_validDropEncodings:function(value){this.$1_2=value;if(ss.isValue(this.$1_5)){this.$1_5(this.$1_2);}return value;},get_layerEncoding:function(){return this.layerEncoding;},get_encodingShelf:function(){return this.$1_0;},get_dragOverEncoding:function(){return this.$1_1;},set_dragOverEncoding:function(value){if(this.$1_1===value){return;}this.$1_1=value;if(ss.isValue(this.$1_4)){this.$1_4(this.$1_1);}return value;},dispose:function(){spiff.DragDropManager.remove_dragStarted(ss.Delegate.create(this,this.dragStarted));spiff.DragDropManager.remove_dragEnded(ss.Delegate.create(this,this.dragEnded));this.$1_0.dispose();tab.LayerEncodingViewModel.callBaseMethod(this, 'dispose');},getEncodingTypeTooltip:function(et){return (this.isEncodingClickable(et))?tab.Strings.AuthMarksCardEncodingTooltipOptions:tab.Strings.AuthMarksCardEncodingTooltipBasic;},createEncodingButtonDropTarget:function(et){return new tab.vqlauthoring$0(this,ss.Delegate.create(this,function(){
this.set_dragOverEncoding(et);}),ss.Delegate.create(this,function(){
this.set_dragOverEncoding('invalid-encoding');}),et);},acceptDrop:function(d,et){var $0=$.DeferredData();if(!(Type.canCast(d,tab.BaseFieldDragInstance))){$0.resolve(false);return $0;}var $1=ss.Delegate.create(this,function($p1_0){
var $1_0=null;if(et!=='invalid-encoding'){var $1_2=this.$1_0.matchingDropsFrom($p1_0);if(ss.isValue($1_2)){$1_0=_.find($1_2.axj,function($p2_0){
return $p2_0.ahq===et;});}}var $1_1=true;if($p1_0.hasOnlyPills()){var $1_3=$p1_0.get_pill();if($1_1){tab.ShelfClientCommands.movePillToEncoding($1_3.get_shelf().get_shelf(),this.get_encodingShelf().get_shelf(),et,$1_3.get_pill(),$p1_0.isCopyDrag,$1_0);}}else if($p1_0.hasOnlyFields()){var $1_4=$p1_0.fieldsToDropOnShelf(this.get_encodingShelf().get_shelfType());tab.ShelfClientCommands.addEncodingFields(this.get_encodingShelf().get_shelf(),et,$1_4,$1_0,d.isShiftDrag);}$0.resolve($1_1);});if((d).get_drop().isResolved()){$1(d);}else{(d).get_drop().done($1);}return $0;},init:function(model){this.layerEncoding=model;this.$1_E();},isColorEncodingClickable:function(){if(!this.$1_A('color-encoding')){return true;}if(ss.isNullOrUndefined(this.get_layerEncoding())||ss.isNullOrUndefined(this.get_layerEncoding().get_colorEncodingDropdown())){return false;}return ss.isValue(this.get_layerEncoding().get_colorEncodingDropdown().atk)||ss.isValue(this.get_layerEncoding().get_colorEncodingDropdown().atl);},isEncodingClickable:function(et){switch(et){case 'color-encoding':return this.isColorEncodingClickable();case 'text-encoding':return (ss.isValue(this.get_layerEncoding())&&ss.isValue(this.get_layerEncoding().get_textEncodingDropdown()));case 'tooltip-encoding':return true;case 'shape-encoding':return !this.$1_A(et);case 'size-encoding':return true;default:return false;}},encodingTypeClicked:function(et,relativeElement){if(this.isEncodingClickable(et)){switch(et){case 'size-encoding':this.$1_8(relativeElement);break;case 'shape-encoding':this.$1_9(relativeElement);break;case 'color-encoding':this.$1_B(relativeElement);break;case 'tooltip-encoding':this.$1_C(relativeElement);break;case 'text-encoding':this.$1_D(relativeElement);break;}}},updatePrimitive:function(data){tab.PaneClientCommands.setPanePrimitive(this.layerEncoding,data.ail);},dragEnded:function(d){this.set_validDropEncodings(null);this.set_dragOverEncoding('invalid-encoding');},dragStarted:function(d){var $0=Type.safeCast(d,tab.BaseFieldDragInstance);if(ss.isNullOrUndefined($0)){return;}$0.get_drop().always(ss.Delegate.create(this,this.$1_F));var $1=[];if(ss.isValue(this.layerEncoding)&&ss.isValue(this.layerEncoding.get_encodings())){var $enum1=ss.IEnumerator.getEnumerator(this.layerEncoding.get_encodings());while($enum1.moveNext()){var $2=$enum1.current;$1.add($2.ahq);}}this.set_validDropEncodings($1);},$1_7:function($p0,$p1){spiff.UberPopupViewModel.createForContent($p0).show(new spiff.UberPopupShowOptions($p1));},$1_8:function($p0){var $0=new tab.MarkSizePickerViewModel(this.get_layerEncoding().get_markSizeModel());this.$1_7($0,$p0);},$1_9:function($p0){tab.PaneClientCommands.getDefaultShapeType(this.layerEncoding,ss.Delegate.create(this,function($p1_0){
var $1_0=new tab.ShapePickerViewModel();if($p1_0!=null){$1_0.set_selectedShape($p1_0);}$1_0.add_propertyChanged(ss.Delegate.create(this,function($p2_0,$p2_1){
tab.PaneClientCommands.setDefaultShapeType(this.layerEncoding,$1_0.get_selectedShape());}));this.$1_7($1_0,$p0);}));},$1_A:function($p0){return _.any(this.$1_0.get_pills(),function($p1_0){
return tab.LayerEncodingViewModel.$1_6($p1_0,$p0);});},$1_B:function($p0){if(this.$1_A('color-encoding')){if(ss.isValue(this.get_layerEncoding().get_colorEncodingDropdown().atk)){var $0=new tab.QuantitativeColorOptionViewModel(this.get_layerEncoding());spiff.UberPopupViewModel.createForContent($0).show(new spiff.UberPopupShowOptions($p0,spiff.UberPopupHorizontalAlign.center));}else if(ss.isValue(this.get_layerEncoding().get_colorEncodingDropdown().atl)){var $1=new tab.CategoricalColorOptionViewModel(this.get_layerEncoding());spiff.UberPopupViewModel.createForContent($1).show(new spiff.UberPopupShowOptions($p0,spiff.UberPopupHorizontalAlign.center));}}else{tab.PaneClientCommands.getDefaultColor(this.layerEncoding,ss.Delegate.create(this,function($p1_0){
var $1_0=new tab.ColorPickerViewModel(this.get_layerEncoding());if(ss.isValue($p1_0)){$1_0.update($p1_0);}this.$1_7($1_0,$p0);}));}},$1_C:function($p0){var $0=new tab.TooltipContentViewModel(this.get_layerEncoding());this.$1_7($0,$p0);},$1_D:function($p0){var $0=new tab.TextEncodingOptionViewModel(this.layerEncoding);this.$1_7($0,$p0);},$1_E:function(){if(ss.isNullOrUndefined(this.$1_3)){return;}this.$1_3(this);},$1_F:function($p0){if(ss.isNullOrUndefined(this.get_validDropEncodings())){return;}var $0=this.$1_0.matchingDropsFrom($p0);if(ss.isValue($0)){this.set_validDropEncodings(_.filter($0.ahs,ss.Delegate.create(this,function($p1_0){
return _.any(this.get_layerEncoding().get_encodings(),function($p2_0){
return $p2_0.ahq===$p1_0&&$p2_0.an;});})));}else{this.set_validDropEncodings(null);}}}
tab.vqlauthoring$0=function(vm,dragOverCallback,dragExitCallback,et){this.vm=vm;this.$1=dragOverCallback;this.$2=dragExitCallback;this.$0=et;}
tab.vqlauthoring$0.prototype={vm:null,$0:null,$1:null,$2:null,get_feedbackType:function(){return 'dropfeedbackuponentry';},dragOver:function($p0){this.$1();return this;},dragExit:function($p0){this.$2();},acceptDrop:function($p0){return this.vm.acceptDrop($p0,this.$0);},getDropTarget:function($p0){return this;}}
tab.MarksContentViewModel=function(model){this.$1_2=[];this.$1_3={};this.$1_4=0;tab.MarksContentViewModel.initializeBase(this);this.$1_0=model;this.$1_0.add_newMarksCard(ss.Delegate.create(this,this.$1_A));this.$1_A();}
tab.MarksContentViewModel.prototype={$1_0:null,$1_1:null,$1_5:true,add_dropStateChanged:function(value){this.$1_6=ss.Delegate.combine(this.$1_6,value);},remove_dropStateChanged:function(value){this.$1_6=ss.Delegate.remove(this.$1_6,value);},$1_6:null,add_layersChanged:function(value){this.$1_7=ss.Delegate.combine(this.$1_7,value);},remove_layersChanged:function(value){this.$1_7=ss.Delegate.remove(this.$1_7,value);},$1_7:null,add_visibleChanged:function(value){this.$1_8=ss.Delegate.combine(this.$1_8,value);},remove_visibleChanged:function(value){this.$1_8=ss.Delegate.remove(this.$1_8,value);},$1_8:null,get_isVisible:function(){return this.$1_5;},set_isVisible:function(value){if(this.$1_5===value){return;}this.$1_5=value;this.raiseActionEvent(this.$1_8);return value;},get_dropState:function(){return this.$1_4;},set_dropState:function(value){this.$1_4=value;if(ss.isValue(this.$1_6)){this.$1_6(this.$1_4);}return value;},get_currentLayer:function(){return this.$1_1;},set_currentLayer:function(value){if(this.$1_1===value){return;}this.$1_1=value;this.$1_D();this.notifyPropertyChanged('CurrentLayer');return value;},get_currentPaneSpecId:function(){if(ss.isValue(this.$1_1)){return this.$1_1.get_layerEncoding().get_id();}return null;},get_layers:function(){return this.$1_2;},get_marksModel:function(){return this.$1_0;},get_dropTarget:function(){return null;},get_title:function(){return tab.Strings.AuthCardTitleMarks;},get_name:function(){return 'marks';},get_collapsedTitleDetail:function(){return '';},get_viewType:function(){return tab.MarksContentView;},get_viewModel:function(){return this;},dispose:function(){this.$1_0.remove_newMarksCard(ss.Delegate.create(this,this.$1_A));this.$1_9();tab.MarksContentViewModel.callBaseMethod(this, 'dispose');},addEncodingShelf:function(newShelf){this.$1_3[newShelf.get_paneId().toString()]=newShelf;if(this.$1_2.length===1){this.$1_2[0].get_encodingShelf().set_shelf(newShelf);}else{var $enum1=ss.IEnumerator.getEnumerator(this.$1_2);while($enum1.moveNext()){var $0=$enum1.current;if($0.get_layerEncoding().get_id()===newShelf.get_paneId()){$0.get_encodingShelf().set_shelf(newShelf);return;}}}},$1_9:function(){var $enum1=ss.IEnumerator.getEnumerator(this.$1_2);while($enum1.moveNext()){var $0=$enum1.current;$0.dispose();}this.$1_2.clear();},$1_A:function(){this.$1_9();var $enum1=ss.IEnumerator.getEnumerator(this.$1_0.get_layers());while($enum1.moveNext()){var $0=$enum1.current;var $1=new tab.LayerEncodingViewModel();$1.init($0);if(Object.getKeyCount(this.$1_3)===1){$1.get_encodingShelf().set_shelf(this.$1_3[Object.keys(this.$1_3)[0]]);}else if(Object.keyExists(this.$1_3,$0.get_id().toString())){$1.get_encodingShelf().set_shelf(this.$1_3[$0.get_id().toString()]);}this.$1_2.add($1);}this.$1_B();if(ss.isValue(this.$1_7)){this.$1_7();}},$1_B:function(){var $0=null;var $1=this.$1_C();if(ss.isValue($1)){$0=_.find(this.$1_2,function($p1_0){
return $p1_0.get_layerEncoding().get_id()===$1;});}var $2=this.get_currentPaneSpecId();if(ss.isNullOrUndefined($0)&&ss.isValue($2)){$0=_.find(this.$1_2,function($p1_0){
return $p1_0.get_layerEncoding().get_id()===$2;});}if(ss.isNullOrUndefined($0)){$0=_.first(this.$1_2);}this.$1_1=$0;this.$1_D();},$1_C:function(){var $0=tab.ApplicationModel.get_instance().get_typeInPillCalculationModel();if(ss.isValue($0)&&$0.get_hasCalculation()&&$0.get_adHocShelf()==='encoding-shelf'){return $0.get_adHocPaneSpecId();}return null;},$1_D:function(){this.$1_0.set_activePaneSpecId(this.get_currentPaneSpecId());}}
tab.AuthoringTabNavViewModel=function(commandVm){this.$1_0=[];tab.AuthoringTabNavViewModel.initializeBase(this);tab.ApplicationModel.get_instance().get_workbook().add_sheetsChanged(ss.Delegate.create(this,this.$1_4));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
tab.ApplicationModel.get_instance().get_workbook().remove_sheetsChanged(ss.Delegate.create(this,this.$1_4));})));if(ss.isValue(tab.ApplicationModel.get_instance().get_workbook().get_sheetsInfo())){this.$1_4(tab.ApplicationModel.get_instance().get_workbook());}this.$1_1=commandVm;}
tab.AuthoringTabNavViewModel.prototype={$1_1:null,$1_2:null,add_tabsChanged:function(value){this.$1_3=ss.Delegate.combine(this.$1_3,value);},remove_tabsChanged:function(value){this.$1_3=ss.Delegate.remove(this.$1_3,value);},$1_3:null,get_workbookTabs:function(){return this.$1_0;},get_currentTab:function(){return this.$1_2;},selectTab:function(newTab){if(ss.isNullOrUndefined(newTab)||newTab===this.$1_2){return;}var $0=this.$1_2;if(ss.isValue($0)){$0.set_isCurrent(false);}this.$1_2=newTab;newTab.set_isCurrent(true);this.notifyPropertyChanged('CurrentTab');var $1={};$1.sheetName=newTab.get_name();$1.oldSheetName=tsConfig.current_sheet_name;$1.noUndo=false;$1.repositoryUrl=tsConfig.current_workbook_name+'/'+newTab.get_name();var $2=(ss.isValue($0))?$0.get_name():tsConfig.current_sheet_name;if(ss.isValue($2)&&($2).length>0){$1.oldRepositoryUrl=tsConfig.current_workbook_name+'/'+$2;}if(ss.isValue($0)){dojo.publish('onTabSelect',[$1]);}},createNewWorksheet:function(insertAtEnd){tab.SheetClientCommands.createSheet(null,insertAtEnd);},$1_4:function($p0){var $enum1=ss.IEnumerator.getEnumerator(this.$1_0);while($enum1.moveNext()){var $1=$enum1.current;$1.dispose();}this.$1_0.clear();var $0=$p0.get_sheetsInfo();var $enum2=ss.IEnumerator.getEnumerator($0);while($enum2.moveNext()){var $2=$enum2.current;if($2.aw){continue;}var $3=new tab.AuthoringTabViewModel($2.sr,!$2.aw,$2.sr===tsConfig.current_sheet_name,this);this.$1_0.add($3);if($3.get_isCurrent()){this.$1_2=$3;}}if(ss.isValue(this.$1_3)){this.$1_3();}},buildWorksheetMenu:function(tabViewModel){if(ss.isNullOrUndefined(tabViewModel)){tabViewModel=this.get_currentTab();}var $0=[];var $1=false;var $2=tsConfig.current_sheet_name;if(!ss.isNullOrUndefined(tabViewModel)){$1=tabViewModel.isWorksheet;$2=tabViewModel.get_name();}$0.add(this.$1_1.createCommandMenuItem('new-worksheet',tab.Strings.AuthWorksheetMenuNew));var $3={};$3['sr']=$2;$0.add(this.$1_1.createCommandMenuItem('duplicate-sheet',tab.Strings.AuthWorksheetMenuDuplicate,$3));$0.add(spiff.MenuItem.newActionItem(tab.Strings.AuthWorksheetMenuRename,function(){
tabViewModel.renameWithPrompt();}));var $4=spiff.MenuItem.newActionItem(tab.Strings.AuthWorksheetMenuDelete,function(){
tab.SheetClientCommands.deleteSheet($2);});if(this.get_workbookTabs().length===1){$4.set_enabled(false);}if(!_.any(tab.ApplicationModel.get_instance().get_workbook().get_sheetsInfo(),function($p1_0){
return $p1_0.aw&&$p1_0.ve.contains($2);})){$0.add($4);}if($1){$0.add(spiff.MenuItem.newDivider());$0.add(this.$1_1.createCommandMenuItem('clear-sheet',tab.Strings.AuthWorksheetMenuClear,$3));}$0.add(this.$1_1.createCommandMenuItem('clear-formatting',tab.Strings.AuthWorksheetMenuClearFormatting));return new spiff.Menu($0);}}
tab.AuthoringMastheadViewModel=function(){this.$1_1=['web_author_who.htm','web_author.htm','web_author_build_view.htm'];tab.AuthoringMastheadViewModel.initializeBase(this);this.$1_18();this.disposables.add(new tab.SubscriptionDisposable(dojo.subscribe('workbookModifiedChanged',ss.Delegate.create(this,this.$1_17))));}
tab.AuthoringMastheadViewModel.$1_B=function($p0,$p1,$p2){var $0=new spiff.MenuItem();$0.set_data(function(){
tab.WindowHelper.open($p1,$p2);});$0.set_name($p0);$0.set_enabled($p1!=null);return $0;}
tab.AuthoringMastheadViewModel.createUserPrefsUrl=function(){var $0=encodeURIComponent(tsConfig.current_user_name);var $1=encodeURIComponent(tsConfig.current_user_domain_name);var $2=tsConfig.site_root.toString();var $3='';if($2.length>0){var $4=$2.lastIndexOf('/');$3='/site/'+encodeURIComponent($2.substr($4+1));}return '/#'+$3+'/user/'+$1+'/'+$0+'/settings';}
tab.AuthoringMastheadViewModel.prototype={$1_2:null,$1_3:null,get_workbookMenu:function(){return this.$1_2;},get_userMenu:function(){return this.$1_3;},get_workbookName:function(){return tsConfig.current_workbook_name;},get_$1_4:function(){return tsConfig.allow_save||tsConfig.allow_save_as||tsConfig.is_guest;},get_$1_5:function(){return !tsConfig.is_guest;},get_$1_6:function(){return tsConfig.current_user_friendly_name;},get_$1_7:function(){if(!ss.isValue(tsConfig.language)){return 'en-us';}switch(tsConfig.language.toString()){case 'de':return 'de-de';case 'en':return 'en-us';case 'es':return 'es-es';case 'fr':return 'fr-fr';case 'ja':return 'ja-jp';case 'ko':return 'ko-kr';case 'pt':return 'pt-br';case 'zh':return 'zh-cn';default:return 'en-us';}},get_$1_8:function(){var $0=/^(\d+\.\d+)/;var $1=$0.exec(tsConfig.version);if(ss.isValue($1)){return $1[1];}else{return '0.0';}},get_$1_9:function(){return (tsConfig.is_saas)?'online':'server';},$1_A:function($p0){var $0=this.get_$1_7().replaceAll('-','_');return String.format('/offline_help/{0}/help.htm#{1}',$0,$p0);},$1_C:function(){tab.SaveController.get_instance().saveWorkbook(ss.Delegate.create(this,this.$1_14));},$1_D:function(){tab.SaveController.get_instance().saveWorkbookAs();},$1_E:function(){tab.WorksheetServerCommands.revert();},$1_F:function($p0){window.open(this.$1_1A($p0));},$1_10:function(){var $0=function(){
tab.NotificationViewModel.showNotification(tab.Strings.SignOutFailedMessage);};tab.WorkgroupServerCommands.logOff($0);},$1_11:function(){var $0=tab.VizUriModel.createForAuthoringUnpublishedSheet(tsConfig.repositoryUrl,tsConfig.current_sheet_name);tab.LogOnViewModel.logOnAndTransitionSession($0);},$1_12:function(){var $0=tab.AuthoringMastheadViewModel.createUserPrefsUrl();tab.WindowHelper.setLocationHref(window.self,$0);},doneClicked:function(){if(tab.ApplicationModel.get_instance().get_workbook().get_isWorkbookModifiedAuthoring()){var $0;var $1;var $2;if(tab.SaveController.get_instance().get_isSaveEnabled()){$0=tab.Strings.AuthMastheadDone_Confirm_CanSave;$1=tab.Strings.AuthMastheadDone_Confirm_CanSave_Confirm;$2=tab.Strings.AuthMastheadDone_Confirm_CanSave_Deny;}else if(tab.SaveController.get_instance().get_isSaveAsEnabled()){$0=tab.Strings.AuthMastheadDone_Confirm_CanSaveAs;$1=tab.Strings.AuthMastheadDone_Confirm_CanSaveAs_Confirm;$2=tab.Strings.AuthMastheadDone_Confirm_CanSaveAs_Deny;}else if(tsConfig.is_guest){$0=tab.Strings.AuthMastheadDone_Confirm_CanLogin;$1=tab.Strings.AuthMastheadDone_Confirm_CanLogin_Confirm;$2=tab.Strings.AuthMastheadDone_Confirm_CanLogin_Deny;}else{this.$1_15(null);return;}var $3=tab.ConfirmationViewModel.create($0,ss.Delegate.create(this,this.$1_13));$3.set_titleText(tab.Strings.AuthMastheadDone_Confirm_Title);$3.set_confirmText($1);$3.set_denyText($2);$3.show();}else{this.$1_15(null);}},$1_13:function($p0){switch($p0){case 'confirm':tab.SaveController.get_instance().saveWorkbook(ss.Delegate.create(this,this.$1_15));break;case 'deny':this.$1_15(null);break;case 'cancel':break;}},$1_14:function($p0){var $0=tab.WorkbookViewObjectUtils.createVizUriModelForAuthoringSheetInWorkbook(tsConfig.current_sheet_name,$p0);if(!$0.matchesCurrentWindowLocationUri()){$0.setWindowLocation();}},$1_15:function($p0){var $0=tabBootstrap.Utility.get_locationWindow();var $1=tab.WindowHelper.getOpener(tabBootstrap.Utility.get_locationWindow());if(ss.isValue($1)){tab.WindowHelper.close($0);window.setTimeout(function(){
tab.WindowHelper.setLocationHref($0,tsConfig.vizql_root+'/doneAuthoring');},500);return;}var $2=tab.VizUriModel.createForCurrentWindowLocation();if($2.get_isAuthorNewWorkbookUri()){var $3=tsConfig.site_root+'/datasources';tab.WindowHelper.setLocationHref($0,tab.MiscUtil.replaceUriQueryParameters($3,$2.get_queryParams()));}else{var $4=this.$1_16($p0);$4.setWindowLocation();}},$1_16:function($p0){var $0=null;if(ss.isValue($p0)){$0=tab.WorkbookViewObjectUtils.createVizUriModelForViewingSheetInWorkbook(tsConfig.current_sheet_name,$p0);}else{var $1=tab.ApplicationModel.get_instance().get_workbook().get_outerDashboardRepositoryUrl();if(!tab.MiscUtil.isNullOrEmpty($1)){$0=tab.VizUriModel.createForViewingSheet($1);}}if($0==null){$0=tab.VizUriModel.createForViewingSheet(tsConfig.origin_repository_url);}return $0;},$1_17:function($p0){this.$1_18();},$1_18:function(){this.$1_2=new spiff.Menu([]);if(this.get_$1_4()){this.$1_2.get_menuItems().add(spiff.MenuItem.newActionItem(tab.Strings.AuthMastheadSave,ss.Delegate.create(this,this.$1_C)));}if(tsConfig.allow_save_as){this.$1_2.get_menuItems().add(spiff.MenuItem.newActionItem(tab.Strings.AuthMastheadSaveAs,ss.Delegate.create(this,this.$1_D)));}var $0=spiff.MenuItem.newActionItem(tab.Strings.AuthMastheadRevert,ss.Delegate.create(this,this.$1_E));$0.set_enabled(tab.ApplicationModel.get_instance().get_workbook().get_isWorkbookModifiedAuthoring());this.$1_2.get_menuItems().add($0);this.$1_2.get_menuItems().add(spiff.MenuItem.newActionItem(tab.Strings.AuthMastheadDone,ss.Delegate.create(this,this.doneClicked)));this.$1_3=new spiff.Menu([]);var $1=new spiff.Menu([]);$1.get_menuItems().add(spiff.MenuItem.newTextInput(ss.Delegate.create(this,this.$1_F)));$1.get_menuItems().add(tab.AuthoringMastheadViewModel.$1_B(tab.Strings.HelpMenuItemWebAuthor1,this.$1_19(1),'_blank'));$1.get_menuItems().add(tab.AuthoringMastheadViewModel.$1_B(tab.Strings.HelpMenuItemWebAuthor2,this.$1_19(2),'_blank'));$1.get_menuItems().add(tab.AuthoringMastheadViewModel.$1_B(tab.Strings.HelpMenuItemWebAuthor3,this.$1_19(3),'_blank'));$1.get_menuItems().add(spiff.MenuItem.newDivider());if(tsConfig.is_saas){$1.get_menuItems().add(tab.AuthoringMastheadViewModel.$1_B(tab.Strings.HelpMenuItemContactSupport,tsConfig.contact_support_uri,'_blank'));}else{if(!tsConfig.isPublic){var $3=(tsConfig.useOfflineHelp)?this.$1_A(''):String.format('{0}/support','http://www.tableausoftware.com');$1.get_menuItems().add(tab.AuthoringMastheadViewModel.$1_B(tab.Strings.HelpMenuItemGetHelpAndSupport,$3,'_blank'));}}var $2=spiff.MenuItem.newItem(null,tab.Strings.AuthMastheadHelp,spiff.MenuItemCheckState.none,$1);this.$1_3.get_menuItems().add($2);if(this.get_$1_5()){var $4=new spiff.Menu([]);$4.get_menuItems().add(spiff.MenuItem.newActionItem(tab.Strings.AuthMastheadUserPrefs,ss.Delegate.create(this,this.$1_12)));$4.get_menuItems().add(spiff.MenuItem.newActionItem(tab.Strings.AuthMastheadLogout,ss.Delegate.create(this,this.$1_10)));var $5=spiff.MenuItem.newItem(null,this.get_$1_6(),spiff.MenuItemCheckState.none,$4);this.$1_3.get_menuItems().add($5);}else{this.$1_3.get_menuItems().add(spiff.MenuItem.newActionItem(tab.Strings.AuthMastheadLogin,ss.Delegate.create(this,this.$1_11)));}this.notifyPropertyChanged('links');},$1_19:function($p0){if(tsConfig.useOfflineHelp){var $0=this.$1_1[$p0-1];return this.$1_A($0);}else{var $1=this.get_$1_7();var $2=this.get_$1_9();var $3=this.get_$1_8();var $4='webauthor';return String.format('{0}/{1}/app/server-{2}{3}?edition={4}&lang={1}&version={5}','http://www.tableausoftware.com',$1,$4,$p0,$2,$3);}},$1_1A:function($p0){var $0=encodeURIComponent($p0);if(tsConfig.useOfflineHelp){return this.$1_A(String.format('search-{0}',$0));}else{var $1=this.get_$1_7();if($1==='en-us'){return String.format('{0}/search/support/{1}','http://www.tableausoftware.com',$0);}else{return String.format('{0}/{1}/search/support/{2}','http://www.tableausoftware.com',$1,$0);}}}}
tab.MarkSizePickerViewModel=function(sizeModel){tab.MarkSizePickerViewModel.initializeBase(this);this.$1_0=sizeModel;}
tab.MarkSizePickerViewModel.prototype={$1_0:null,add_modelUpdated:function(value){this.$1_1=ss.Delegate.combine(this.$1_1,value);},remove_modelUpdated:function(value){this.$1_1=ss.Delegate.remove(this.$1_1,value);},$1_1:null,get_viewType:function(){return tab.MarkSizePickerView;},get_viewModel:function(){return this;},get_markSize:function(){return this.$1_0;},get_minMarkSize:function(){return this.$1_0.get_minMarkSize();},get_maxMarkSize:function(){return this.$1_0.get_maxMarkSize();},get_currentFraction:function(){return this.$1_0.get_currentSliderFraction();},set_currentFraction:function(value){var $0=this.$1_0.get_transform().fractionToValue(value);if(Math.abs(this.$1_0.get_currentMarkSize()-$0)>0.001){tab.PaneClientCommands.setMarkSize(this.$1_0.get_parentModel(),$0);}return value;},disposeViewModel:function(){this.dispose();},updateUberPopupViewModel:function(vm){},update:function(markSizeModel){this.$1_0=markSizeModel;if(ss.isNullOrUndefined(this.$1_1)){return;}this.$1_1(this);}}
tab.PillDragInstance=function(dragged,name,type){tab.PillDragInstance.initializeBase(this,[dragged,new tab.PillDragAvatar(name,type)]);this.$1_0=this.get_dragAvatar();}
tab.PillDragInstance.prototype={$1_0:null,get_fields:function(){if(this.hasOnlyFields()){return this.draggedObject;}else if(this.hasOnlyPills()){var $0=_.map(this.draggedObject,function($p1_0){
return $p1_0.get_field();});return $0;}return null;},get_pills:function(){return (this.hasOnlyPills())?this.draggedObject:null;},get_pill:function(){var $0=this.get_pills();return $0[0];},hasOnlyFields:function(){if(Type.canCast(this.draggedObject,Array)){var $0=this.draggedObject;return _.every($0,function($p1_0){
return Type.canCast($p1_0,tab.FieldModel);});}return Type.canCast(this.draggedObject,tab.FieldModel);},hasOnlyPills:function(){if(Type.canCast(this.draggedObject,Array)){var $0=this.draggedObject;return _.every($0,function($p1_0){
return Type.canCast($p1_0,tab.PillViewModel);});}return Type.canCast(this.draggedObject,tab.PillViewModel);},resolve:function(dragResponse){if(this.finalDrop.isResolved()||ss.isNullOrUndefined(dragResponse)){return;}this.drag=dragResponse;var $0=[];var $1=this.get_fields();var $2=true;var $enum1=ss.IEnumerator.getEnumerator(this.drag.axl);while($enum1.moveNext()){var $3=$enum1.current;if(!$3.apy.length){continue;}var $enum2=ss.IEnumerator.getEnumerator($3.apy);while($enum2.moveNext()){var $4=$enum2.current;var $5=$4.afc;$2=$2&&_.any($1,function($p1_0){
return $p1_0.get_globalName()===$5;});if(ss.isValue($5)){var $6=tab.ApplicationModel.get_instance().get_workbook().get_dataSchema();var $7=$6.findField($5);if(ss.isValue($7)&&!$0.contains($7)){$0.add($7);}}}break;}if($0.length>0&&!$2){this.draggedObject=$0;this.$1_0.set_label($0[0].get_description());}this.finalDrop.resolve(this);},reject:function(dragResponse){if(this.finalDrop.isResolved()||!ss.isNullOrUndefined(dragResponse)){return;}if(ss.isNullOrUndefined(this.drag)){this.drag=dragResponse;}this.finalDrop.reject(this);}}
tab.PillViewModel=function(){tab.PillViewModel.initializeBase(this);}
tab.PillViewModel.prototype={$1_0:null,$1_1:null,add_pillChanged:function(value){this.$1_2=ss.Delegate.combine(this.$1_2,value);},remove_pillChanged:function(value){this.$1_2=ss.Delegate.remove(this.$1_2,value);},$1_2:null,add_showDragAccept:function(value){this.$1_3=ss.Delegate.combine(this.$1_3,value);},remove_showDragAccept:function(value){this.$1_3=ss.Delegate.remove(this.$1_3,value);},$1_3:null,get_pill:function(){return this.$1_0;},set_pill:function(value){if(this.$1_0===value){return;}this.$1_0=value;this.handlePillChanged();return value;},get_item:function(){return this.$1_0.get_item();},get_field:function(){return this.$1_0.get_column();},get_shelf:function(){return this.$1_1;},set_shelf:function(value){this.$1_1=value;return value;},get_indexInShelf:function(){return this.$1_1.get_pills().indexOf(this);},get_displayName:function(){return this.$1_0.get_displayName();},get_role:function(){return this.$1_0.get_column().get_role();},get_feedbackType:function(){return 'dropfeedbackuponentry';},dragOver:function(d){var $0=this.$1_5(d);if($0){this.$1_4(true);return this;}return this.$1_1.createPillDividerDropTarget(this.get_indexInShelf());},dragExit:function(d){this.$1_4(false);},$1_4:function($p0){if(ss.isValue(this.$1_3)){this.$1_3($p0);}},acceptDrop:function(d){var $0=$.DeferredData();if(Type.canCast(d,tab.BaseFieldDragInstance)){var $1=ss.Delegate.create(this,function($p1_0){
var $1_0=this.$1_5($p1_0);if(!$1_0){}else if($p1_0.hasOnlyPills()){var $1_1=$p1_0.get_pill();var $1_2=$p1_0.dropPositionToReplacePill(this);tab.ShelfClientCommands.replaceShelfPill($1_1.get_shelf().get_shelf(),$1_1.get_pill(),this.$1_1.get_shelf(),this.$1_0,$1_2,$p1_0.isCopyDrag);}else if($p1_0.hasOnlyFields()){var $1_3=$p1_0.fieldsToDropOnShelf(this.$1_1.get_shelfType());var $1_4=$p1_0.dropPositionToReplacePill(this);tab.ShelfClientCommands.replaceShelfPillWithField(this.$1_1.get_shelf(),this.$1_0,$1_3,$1_4);}$0.resolve($1_0);});if((d).get_drop().isResolved()){$1(d);}else{(d).get_drop().done($1);}}else{$0.resolve(false);}return $0;},getDropTarget:function(hit){return this;},startDrag:function(e){var $0=new tab.PillDragInstance([this],this.get_displayName(),this.get_field().get_fieldType());var $1=tab.ShelfClientCommands.startDrag([this.$1_0.get_column()],this.$1_0.get_encodingType(),tab.ModelUtils.findActivePaneSpecId());$1.done(function($p1_0){
if(ss.isValue($p1_0)&&ss.isValue($p1_0.axl)){$0.resolve($p1_0);}else{$0.reject($p1_0);}});return $0;},editPill:function(){this.$1_1.editPill(this.$1_0.get_item().afc,this.get_indexInShelf());},menuButtonClicked:function(buttonDom){var $0=spiff.MenuViewModel.createForMenu(this.$1_6(this.$1_0.get_contextMenuCommands()),ss.Delegate.create(this,this.$1_7));$0.show(spiff.ShowMenuOptions.create(buttonDom,false));},iconClicked:function(){if(this.get_pill().get_hasDrill()){tab.ShelfClientCommands.drillOnPill(this.get_shelf().get_shelf(),this.get_pill(),this.get_indexInShelf());}},pillClicked:function(){},updateEncodingType:function(et){if(et===this.$1_0.get_encodingType()){return;}tab.ShelfClientCommands.setItemEncodingType(this.$1_1.get_shelf(),this.$1_0,et);},handlePillChanged:function(){if(ss.isValue(this.$1_2)){this.$1_2(this);}},$1_5:function($p0){if(!$p0.get_hasPayload()||!(Type.canCast($p0,tab.BaseFieldDragInstance))){return false;}if(this.get_shelf().get_dropState()===2&&!$p0.payloadEquals(this)){return false;}var $0=($p0).dropPositionToReplacePill(this);return ss.isValue($0);},$1_6:function($p0){var $0=[];if(ss.isValue($p0)){tab.WidgetUtil.newMenuItemsFromCommands($0,$p0,tab.WidgetUtil.createDropdownMenuCommands);$0.add(spiff.MenuItem.newDivider());}$0.add(spiff.MenuItem.newItem(ss.Delegate.create(this,function(){
tab.ShelfClientCommands.removeShelfPill(this.$1_1.get_shelf(),this.$1_0);}),tab.Strings.AuthPillRemove));return new spiff.Menu($0);},$1_7:function($p0){if($.isFunction($p0.get_data())){($p0.get_data())();}}}
tab.SaveViewModel=function(){this.$1_0=[];tab.SaveViewModel.initializeBase(this);if(this.get_showProjects()){tab.WorkgroupServerCommands.getWritableProjects(ss.Delegate.create(this,function($p1_0){
this.set_projects($p1_0);this.set_currentProject(_.find($p1_0,function($p2_0){
return $p2_0.get_id()===tsConfig.current_project_id;}));}));}this.$1_2=tsConfig.current_workbook_name;this.$1_3=tsConfig.showTabsWorkbook;}
tab.SaveViewModel.prototype={$1_1:null,$1_2:null,$1_3:false,$1_4:false,add_shown:function(value){this.$1_5=ss.Delegate.combine(this.$1_5,value);},remove_shown:function(value){this.$1_5=ss.Delegate.remove(this.$1_5,value);},$1_5:null,add_hidden:function(value){this.$1_6=ss.Delegate.combine(this.$1_6,value);},remove_hidden:function(value){this.$1_6=ss.Delegate.remove(this.$1_6,value);},$1_6:null,add_saveSucceeded:function(value){this.$1_7=ss.Delegate.combine(this.$1_7,value);},remove_saveSucceeded:function(value){this.$1_7=ss.Delegate.remove(this.$1_7,value);},$1_7:null,add_saveCancelled:function(value){this.$1_8=ss.Delegate.combine(this.$1_8,value);},remove_saveCancelled:function(value){this.$1_8=ss.Delegate.remove(this.$1_8,value);},$1_8:null,get_projects:function(){return this.$1_0;},set_projects:function(value){this.$1_0.clear();this.$1_0.addRange(value);this.notifyPropertyChanged('Projects');return value;},get_currentProject:function(){return this.$1_1;},set_currentProject:function(value){if(this.$1_1===value){return;}this.$1_1=value;this.notifyPropertyChanged('CurrentProject');return value;},get_workbookName:function(){return this.$1_2;},set_workbookName:function(value){if(this.$1_2===value){return;}this.$1_2=value;this.notifyPropertyChanged('WorkbookName');return value;},get_showTabs:function(){return this.$1_3;},set_showTabs:function(value){this.$1_3=value;this.notifyPropertyChanged('ShowTabs');return value;},get_embedCredentials:function(){return this.$1_4;},set_embedCredentials:function(value){this.$1_4=value;this.notifyPropertyChanged('EmbedCredentials');return value;},get_showProjects:function(){return !tsConfig.isPublic;},get_saveEnabled:function(){if(this.get_showProjects()){return this.$1_9()&&ss.isValue(this.$1_1);}return this.$1_9();},get_saveWarning:function(){if(tab.ApplicationModel.get_instance().get_workbook().get_isWorkbookIncomplete()){return tab.Strings.SaveIncompleteWorkbookWarning;}return null;},showSave:function(){if(ss.isValue(this.$1_5)){this.$1_5();}},cancelled:function(){this.raiseActionEvent(this.$1_8);},hide:function(){this.raiseActionEvent(this.$1_6);this.dispose();},save:function(){if(!this.get_saveEnabled()){return;}this.$1_B(true);},$1_9:function(){return ss.isValue(this.$1_2)&&this.$1_2.trim().length>0;},$1_A:function(){this.raiseActionEvent(this.$1_6);},$1_B:function($p0){tab.SaveServerCommands.saveWorkbookAs(this.get_workbookName(),this.get_currentProject(),this.get_showTabs(),this.get_embedCredentials(),$p0,ss.Delegate.create(this,function($p1_0){
if(ss.isValue(this.$1_7)){this.$1_7($p1_0);}this.dispose();}),ss.Delegate.create(this,function($p1_0){
if(ss.isValue($p1_0)&&$p1_0.code===106){var $1_0=($p1_0.details||$p1_0.message).htmlEncode();tab.ConfirmationViewModel.showConfirmation(tab.Strings.AuthSaveConfirmOverwrite($1_0),ss.Delegate.create(this,this.$1_C));}else{tab.BaseSession.showAlertDialog($p1_0.details||$p1_0.message,tab.Strings.AuthSaveErrorTitle,true);this.cancelled();this.dispose();}}));this.$1_A();},$1_C:function($p0){switch($p0){case 'confirm':this.$1_B(false);break;case 'deny':this.showSave();break;case 'cancel':this.cancelled();this.dispose();break;}}}
tab.DataSchemaViewModel=function(){this.$1_0={};this.$1_4={};this.$1_5={};this.$1_6=[];tab.DataSchemaViewModel.initializeBase(this);this.$1_9=dojo.subscribe('onTabSelect',ss.Delegate.create(this,this.doTabSelect));this.$1_3=new tab.ConvertUnnamedFieldsDropTarget(ss.Delegate.create(this,this.$1_15));this.$1_1=new tab.DimensionFieldDropTarget(this.$1_3);this.$1_2=new tab.MeasureFieldDropTarget(this.$1_3);tab.DataSchemaViewModel.sectionsInOrder.forEach(ss.Delegate.create(this,function($p1_0){
this.$1_4[$p1_0]=[];}));}
tab.DataSchemaViewModel.filterFieldsForViewing=function(models,shouldShowHidden){return models.filter(function($p1_0){
if($p1_0.get_isUnnamedCalc()||(!shouldShowHidden&&$p1_0.get_isHidden())){return false;}return true;});}
tab.DataSchemaViewModel.$1_E=function($p0,$p1){var $0=$p0.isUnsortedContainer;var $1=$p1.isUnsortedContainer;if($0&&!$1){return -1;}else if(!$0&&$1){return 1;}else if($p0.isCubeFolder&&$p1.isCubeFolder){return tab.DataSchemaViewModel.$1_11($p0,$p1);}return 0;}
tab.DataSchemaViewModel.$1_F=function($p0,$p1){var $0=$p0.instanceType;var $1=$p1.instanceType;if($0==='cubeFolder'&&$1!=='cubeFolder'){return -1;}else if($0!=='cubeFolder'&&$1==='cubeFolder'){return 1;}else if($0==='cubeFolder'&&$1==='cubeFolder'){return tab.DataSchemaViewModel.$1_11($p0,$p1);}else if($0==='cubeHierarchy'&&$1!=='cubeHierarchy'){return -1;}else if($0!=='cubeHierarchy'&&$1==='cubeHierarchy'){return 1;}else if($0==='cubeDimension'&&$1!=='cubeDimension'){return 1;}else if($0!=='cubeDimension'&&$1==='cubeDimension'){return -1;}else{return tab.DataSchemaViewModel.$1_10($p0,$p1);}}
tab.DataSchemaViewModel.$1_10=function($p0,$p1){if(!$p0.isDerived&&$p1.isDerived){return -1;}else if($p0.isDerived&&!$p1.isDerived){return 1;}else if($p0.isMeasureNamesOrValues){return 1;}else if($p1.isMeasureNamesOrValues){return -1;}return ($p0.displayName.toUpperCase()).localeCompare($p1.displayName.toUpperCase());}
tab.DataSchemaViewModel.$1_11=function($p0,$p1){if(!$p0.isDerived&&$p1.isDerived){return -1;}else if($p0.isDerived&&!$p1.isDerived){return 1;}else if($p0.isMeasureNamesOrValues){return 1;}else if($p1.isMeasureNamesOrValues){return -1;}var $0=$p0.isCalculated;var $1=$p1.isCalculated;if($0&&$1){return tab.DataSchemaViewModel.$1_10($p0,$p1);}else if($0&&!$1){return 1;}else if(!$0&&$1){return -1;}else{var $2=$p0.ordinal;var $3=$p1.ordinal;if($2<$3){return -1;}else if($2>$3){return 1;}else{return 0;}}}
tab.DataSchemaViewModel.showCommandsContextMenu=function(commands,relativeDom,handler,menuHidden){tab.Param.verifyValue(commands,'commands');var $0=tab.CommandsPresModelWrapper.create(commands);if(tab.MiscUtil.isNullOrEmpty($0.get_commandItems())){if(ss.isValue(menuHidden)){menuHidden();}return;}var $1=[];tab.WidgetUtil.newMenuItemsFromCommands($1,commands,function($p1_0){
var $1_0=tab.CommandItemWrapper.create($p1_0);var $1_1=tab.CommandSerializer.deserialize($1_0.get_command());var $1_2=function(){
tab.ServerCommands.executeServerCommand($1_1,'immediately',tab.CommandUtils.createCommandRedirectSuccessHandler(null),null);};return $1_2;});var $2=new spiff.Menu($1);var $3=spiff.MenuViewModel.createForMenu($2,handler);$3.show(spiff.ShowMenuOptions.create(relativeDom,false));if(ss.isValue(menuHidden)){$3.add_hidden(menuHidden);}}
tab.DataSchemaViewModel.prototype={$1_1:null,$1_2:null,$1_3:null,$1_7:null,$1_8:false,$1_9:null,$1_A:null,add_dataSchemaModified:function(value){this.$1_B=ss.Delegate.combine(this.$1_B,value);},remove_dataSchemaModified:function(value){this.$1_B=ss.Delegate.remove(this.$1_B,value);},$1_B:null,add_dataSourceListChanged:function(value){this.$1_C=ss.Delegate.combine(this.$1_C,value);},remove_dataSourceListChanged:function(value){this.$1_C=ss.Delegate.remove(this.$1_C,value);},$1_C:null,add_nodeActivated:function(value){this.$1_D=ss.Delegate.combine(this.$1_D,value);},remove_nodeActivated:function(value){this.$1_D=ss.Delegate.remove(this.$1_D,value);},$1_D:null,get_dataSchema:function(){return this.$1_7;},set_dataSchema:function(value){if(this.$1_7===value){return;}if(ss.isValue(this.$1_7)){this.$1_7.remove_newDataSchema(ss.Delegate.create(this,this.$1_18));}this.$1_7=value;this.$1_7.add_newDataSchema(ss.Delegate.create(this,this.$1_18));this.$1_18();return value;},get_schemaDropTarget:function(){return this.$1_3;},get_dimensionDropTarget:function(){return this.$1_1;},get_measureDropTarget:function(){return this.$1_2;},get_currentSheetName:function(){if(tsConfig.current_sheet_name===this.$1_A){this.$1_A=null;}return (this.$1_A||tsConfig.current_sheet_name);},set_currentSheetName:function(value){this.$1_A=value;this.$1_19();return value;},get_currentSheetSchema:function(){return this.get_dataSchema().get_dataSchemaPresModel().apr[this.get_currentSheetName()];},get_selectedDataSource:function(){if(ss.isNullOrUndefined(this.$1_7)){return null;}if(ss.isNullOrUndefined(this.$1_0[this.get_currentSheetName()])){this.$1_0[this.get_currentSheetName()]=this.$1_7.getDefaultDataSourceForSheet(this.get_currentSheetName());}return this.$1_0[this.get_currentSheetName()];},set_selectedDataSource:function(value){this.$1_17(value);return value;},get_specifiedWidth:function(){return this.get_selectedDataSource().get_specifiedWidth();},set_specifiedWidth:function(value){this.get_selectedDataSource().set_specifiedWidth(value);return value;},get_selectableDataSources:function(){var $0=[];if(ss.isValue(this.$1_7)){var $enum1=ss.IEnumerator.getEnumerator(this.$1_7.get_dataSources());while($enum1.moveNext()){var $1=$enum1.current;if($1!==this.$1_7.get_parametersDataSource()){$0.add($1);}}}return $0;},get_selectedNodes:function(){return this.$1_6;},get_selectedFields:function(){return this.$1_6.map(ss.Delegate.create(this,function($p1_0){
if($p1_0.isSelectable&&ss.isValue($p1_0.childToSelect)){return this.get_dataSchema().findField($p1_0.childToSelect);}return this.get_dataSchema().findField($p1_0.globalFieldName||'');})).filter(function($p1_0){
return ss.isValue($p1_0);});},get_selectedFieldNames:function(){var $0=[];var $enum1=ss.IEnumerator.getEnumerator(this.$1_6);while($enum1.moveNext()){var $1=$enum1.current;var $2=$1.childToSelect||$1.globalFieldName;if(ss.isValue($2)&&!$0.contains($2)){$0.add($2);}}return $0;},get_lastSelection:function(){if(ss.isValue(this.$1_6)&&!this.$1_6.length){return null;}else{return this.$1_6[this.$1_6.length-1];}},get_lastSelectedFieldName:function(){if(this.get_lastSelection()==null){return null;}else{return this.get_lastSelection().globalFieldName;}},get_currentLayout:function(){if(ss.isNullOrUndefined(this.get_selectedDataSource())){var $0={};$0.aj1='dso-alphabetic';$0.aj2='dso-alphabetic';$0.e7=false;$0.e6=true;return $0;}return this.get_selectedDataSource().get_dataSourceLayoutPresModel();},nodeTreeForSection:function(section){return (Object.keyExists(this.$1_5,section))?this.$1_5[section].children:null;},buildSchemaHierarchy:function(section){var $0=this.$1_4[section];var $1=[];var $2={};var $3=0;var $4=null;var $5=this.get_currentLayout();var $6=$5.e6;var $7=$5.e7;var $8='dso-alphabetic';if(ss.isValue($5)){switch(section){case 'measure':$8=$5.aj2;break;case 'dimensions':$8=$5.aj1;break;}if($8==='dso-ordinal'&&!$5.e5){$8='dso-alphabetic';}}var $9=tab.DataSchemaViewModel.$1_10;if($8==='dso-ordinal'){$9=tab.DataSchemaViewModel.$1_11;}var $A=function($p1_0,$p1_1){
var $1_0=tab.DataSchemaViewModel.$1_E($p1_0,$p1_1);if(!!$1_0){return $1_0;}return $9($p1_0,$p1_1);};$0=tab.DataSchemaViewModel.filterFieldsForViewing($0,$7);var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $C=$enum1.current;var $D=new tab.SchemaNode($C);var $E=true;switch($C.get_instanceType()){case 'drillPath':var $F=$C.asDrillPath().get_levels();$F=tab.DataSchemaViewModel.filterFieldsForViewing($F,$7);var $enum2=ss.IEnumerator.getEnumerator($F);while($enum2.moveNext()){var $14=$enum2.current;var $15=new tab.SchemaNode($14);$D.children.add($15);}break;case 'folder':var $10=$C.asFolder().get_fields();if(ss.isValue($10)){$10=tab.DataSchemaViewModel.filterFieldsForViewing($10,$7);}$D.section=section;var $enum3=ss.IEnumerator.getEnumerator($10);while($enum3.moveNext()){var $16=$enum3.current;var $17=new tab.SchemaNode($16);$D.children.add($17);if($16.get_isDrillPath()){var $18=$16.asDrillPath().get_levels();$18=tab.DataSchemaViewModel.filterFieldsForViewing($18,$7);var $enum4=ss.IEnumerator.getEnumerator($18);while($enum4.moveNext()){var $19=$enum4.current;var $1A=new tab.SchemaNode($19);$17.children.add($1A);}}}$D.children.sort($A);break;case 'relationalTable':var $11=$C.asRelationalTable().get_columns();$11=tab.DataSchemaViewModel.filterFieldsForViewing($11,$7);$D.section=section;$11=$11.filter(function($p1_0){
return $p1_0.matchesFolderRole(section);});var $enum5=ss.IEnumerator.getEnumerator($11);while($enum5.moveNext()){var $1B=$enum5.current;var $1C=new tab.SchemaNode($1B);if($6){$D.children.add($1C);}else{$2[$1C.get_comparisonKey()]=$1C;}}$D.children.sort($A);if($D.children.length>0){$3++;$4=$D;}break;case 'cubeFolder':var $12=$C.asCubeFolder().get_columns();$12=tab.DataSchemaViewModel.filterFieldsForViewing($12,$7);$D.section=section;$12=$12.filter(function($p1_0){
return $p1_0.matchesFolderRole(section);});var $enum6=ss.IEnumerator.getEnumerator($12);while($enum6.moveNext()){var $1D=$enum6.current;var $1E=new tab.SchemaNode($1D);if($6){$D.children.add($1E);}else{$2[$1E.get_comparisonKey()]=$1E;}}$D.children.sort(function($p1_0,$p1_1){
return tab.DataSchemaViewModel.$1_11($p1_0,$p1_1);});break;case 'cubeDimension':var $13=$C.asDimension();this.$1_12($D,$13,$7,$6,false);break;default:$E=false;break;}if(!$E||$D.children.length>0){$1.add($D);}}if($6){var $1F={};if($3===1){$1.remove($4);var $enum7=ss.IEnumerator.getEnumerator($4.children);while($enum7.moveNext()){var $20=$enum7.current;$1.add($20);$1F[$20.get_comparisonKey()]=$20;}$3--;}var $enum8=ss.IEnumerator.getEnumerator($1);while($enum8.moveNext()){var $21=$enum8.current;if($21.isFolder){var $enum9=ss.IEnumerator.getEnumerator($21.children);while($enum9.moveNext()){var $22=$enum9.current;if(!Object.keyExists($1F,$22.get_comparisonKey())){$1.add($22);}}}}$1=$1.filter(function($p1_0){
return !$p1_0.isFolder;});}else{var $enum10=ss.IEnumerator.getEnumerator($1);while($enum10.moveNext()){var $23=$enum10.current;if($23.isFolder){var $enum11=ss.IEnumerator.getEnumerator($23.children);while($enum11.moveNext()){var $24=$enum11.current;var $25=$24.get_comparisonKey();if(Object.keyExists($2,$25)){delete $2[$25];}}}}var $dict12=$2;for(var $key13 in $dict12){var $26={key:$key13,value:$dict12[$key13]};$1.add($26.value);}}$1.sort($A);var $B=new tab.SchemaNode(null);$B.children.addRange($1);return $B;},getEssbaseVirtualHierarchies:function(hierarchies,dim){if(hierarchies.length===2){var $0=_.map(hierarchies,function($p1_0){
return $p1_0.get_localName();});if($0.contains('Levels')&&$0.contains('Generations')){var $1=(dim.get_presModel()).ng;var $2=_.filter(hierarchies,function($p1_0){
return $p1_0.get_localName()===$1;});if($2.length>0){hierarchies=$2;}}}return hierarchies;},$1_12:function($p0,$p1,$p2,$p3,$p4){var $0=$p1.get_hierarchies();$0=tab.DataSchemaViewModel.filterFieldsForViewing($0,$p2);var $1=$p1.get_folders();$0=this.getEssbaseVirtualHierarchies($0,$p1);var $2=$0.length+$1.length>1;var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $3=$enum1.current;this.$1_13($3,$p0,$2,$p2,$p4);}var $enum2=ss.IEnumerator.getEnumerator($1);while($enum2.moveNext()){var $4=$enum2.current;var $5=new tab.SchemaNode($4);var $6=$2&&$p3;if($6){$p0.children.add($5);}var $7=$4.get_hierarchies();$7=tab.DataSchemaViewModel.filterFieldsForViewing($7,$p2);var $enum3=ss.IEnumerator.getEnumerator($7);while($enum3.moveNext()){var $8=$enum3.current;var $9=(($6)?$5:$p0);this.$1_13($8,$9,true,$p2,$p4);}$5.children.sort(tab.DataSchemaViewModel.$1_F);}var $enum4=ss.IEnumerator.getEnumerator($p1.get_attributes());while($enum4.moveNext()){var $A=$enum4.current;var $B=new tab.SchemaNode($A);this.$1_12($B,$A,$p2,$p3,true);$p0.children.add($B);}if($2){$p0.children.sort(tab.DataSchemaViewModel.$1_F);}},$1_13:function($p0,$p1,$p2,$p3,$p4){var $0=$p0.get_levels();$0=tab.DataSchemaViewModel.filterFieldsForViewing($0,$p3);var $1=$0.length===1&&($p4||($0[0].get_localName()===$p0.get_localName()));var $2=new tab.SchemaNode(($1)?$0[0]:$p0);if($p2){$p1.children.add($2);}if($0.length===1&&$p4){$p1.displayName=$0[0].get_description();return;}if($p2&&$1){return;}var $3=(($p2)?$2:$p1).children;var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $4=$enum1.current;var $5=new tab.SchemaNode($4);$3.add($5);}},refreshButtonClicked:function(){tab.ToolbarServerCommands.refreshData();},hasSelection:function(){return (ss.isValue(this.$1_6)&&this.$1_6.length>0);},isSelected:function(node){return _.any(this.$1_6,function($p1_0){
return node.equals($p1_0);});},$1_14:function(){this.notifyPropertyChanged('SelectedField');var $0=this.get_selectedFieldNames();tab.SelectionClientCommands.selectFields($0,this.get_selectedDataSource().get_name(),ss.Delegate.create(this,function($p1_0){
if(_.isEqual(this.get_selectedFieldNames(),$0)){var $1_0=tab.ModelUtils.findActiveOrDefaultVisual().get_showMeModel();$1_0.forceUpdate($p1_0);$1_0.set_shouldUpdate((!$0.length));}}));},addNodeToSelection:function(node){if(!this.isSelected(node)){this.$1_6.add(node);this.$1_14();}},addNodesToSelection:function(nodes){var $0=false;var $enum1=ss.IEnumerator.getEnumerator(nodes);while($enum1.moveNext()){var $1=$enum1.current;if(!this.isSelected($1)){this.$1_6.add($1);$0=true;}}if($0){this.$1_14();}},clearAllAndSelectNodes:function(nodes){if(!!this.$1_6.length){this.$1_6.clear();}this.addNodesToSelection(nodes);},clearAllAndSelect:function(node){if(!!this.$1_6.length){this.$1_6.clear();}if(ss.isValue(node)){this.$1_6.add(node);}this.$1_14();},deSelectNode:function(node){if(this.$1_6.remove(node)){this.$1_14();}},deSelectNodes:function(nodes){var $0=false;var $enum1=ss.IEnumerator.getEnumerator(nodes);while($enum1.moveNext()){var $1=$enum1.current;if(this.$1_6.remove($1)){$0=true;}}if($0){this.$1_14();}},clearSelection:function(){if(!!this.$1_6.length){this.$1_6.clear();this.$1_14();}},$1_15:function($p0){var $enum1=ss.IEnumerator.getEnumerator($p0);while($enum1.moveNext()){var $0=$enum1.current;var $1=this.$1_7.findDataSourceFromGlobalFieldName($0);if(ss.isValue($1)&&$1!==this.get_selectedDataSource()){this.set_selectedDataSource($1);}var $2=this.findNode($0);if($2!=null){this.clearAllAndSelect($2);if(ss.isValue(this.$1_D)){this.$1_D($2);}return;}}},findNode:function(fieldName){var $dict1=this.$1_5;for(var $key2 in $dict1){var $0={key:$key2,value:$dict1[$key2]};var $1=$0.value.find(fieldName);if(ss.isValue($1)){return $1;}}return null;},createDragSource:function(){return new tab.FieldDragSource(ss.Delegate.create(this,function(){
return this.get_selectedFields();}),ss.Delegate.create(this,function(){
this.clearSelection();}));},addFieldToSheet:function(f){if(!this.$1_8){this.$1_8=true;tab.SchemaClientCommands.addFieldToSheet(f,ss.Delegate.create(this,function(){
this.$1_8=false;}));}},showContextMenu:function(relativeDom,menuHidden){if(ss.isNullOrUndefined(this.get_selectedDataSource())){if(ss.isValue(menuHidden)){menuHidden();}return;}tab.SchemaClientCommands.requestSchemaContextMenu(this.get_selectedDataSource(),ss.Delegate.create(this,function($p1_0){
tab.DataSchemaViewModel.showCommandsContextMenu($p1_0,relativeDom,ss.Delegate.create(this,this.$1_16),menuHidden);}));},showFieldContextMenu:function(f,relativeDom){var $0=f.globalFieldName;if(f.isSelectable&&ss.isValue(f.childToSelect)){$0=f.childToSelect;}tab.SchemaClientCommands.requestSchemaFieldContextMenu(this.get_selectedDataSource(),$0,ss.Delegate.create(this,function($p1_0){
tab.DataSchemaViewModel.showCommandsContextMenu($p1_0,relativeDom,ss.Delegate.create(this,this.$1_16),null);}));},$1_16:function($p0){if($.isFunction($p0.get_data())){($p0.get_data())();}},doTabSelect:function(msg){this.set_currentSheetName(msg.sheetName);if(ss.isValue(this.$1_B)){this.$1_B();}this.clearSelection();},dispose:function(){tab.DataSchemaViewModel.callBaseMethod(this, 'dispose');dojo.unsubscribe(this.$1_9);this.$1_1.dispose();this.$1_2.dispose();this.$1_3.dispose();},$1_17:function($p0){if(Object.keyExists(this.$1_0,this.get_currentSheetName())){var $0=this.$1_0[this.get_currentSheetName()];if($0.get_name()===$p0.get_name()&&_.isEqual($0.get_fields(),$p0.get_fields())){return false;}}this.clearSelection();this.$1_0[this.get_currentSheetName()]=$p0;this.$1_19();return true;},$1_18:function(){var $0=(this.$1_0[this.get_currentSheetName()]||this.get_dataSchema().getDefaultDataSourceForSheet(this.get_currentSheetName()));if(ss.isNullOrUndefined($0)){return;}var $1=_.find(this.get_selectableDataSources(),function($p1_0){
return $p1_0.get_name()===$0.get_name();});var $2=false;if(ss.isValue($1)){$2=this.$1_17($1);}if(!$2){this.$1_19();}},$1_19:function(){var $0=tabBootstrap.MetricsController.get_instance().createContext('Update DataSchema',tabBootstrap.MetricsSuites.debug);var $1={};tab.DataSchemaViewModel.sectionsInOrder.forEach(function($p1_0){
$1[$p1_0]=[];});if(ss.isValue(this.get_selectedDataSource())&&ss.isValue(this.get_selectedDataSource().get_fields())){var $enum1=ss.IEnumerator.getEnumerator(this.get_selectedDataSource().get_fields());while($enum1.moveNext()){var $4=$enum1.current;switch($4.get_instanceType()){case 'drillPath':case 'cubeDimension':case 'cubeHierarchy':$1['dimensions'].add($4);break;case 'cubeFolder':$1['dimensions'].add($4);$1['measure'].add($4);break;case 'relationalTable':$1['dimensions'].add($4);$1['measure'].add($4);break;case 'folder':$1[$4.asFolder().get_folderRole()].add($4);break;case 'group':var $5=$4.asGroup();if($5.get_isCombinedField()){$1['dimensions'].add($5);}else{$1['groups'].add($5);}break;case 'column':switch($4.get_defaultRole()){case 'measure':$1['measure'].add($4);break;case 'dimension':default:$1['dimensions'].add($4);break;}break;default:$1['measure'].add($4);break;}}}var $2=this.$1_7.get_parametersDataSource();if(ss.isValue($2)){$1['parameters'].addRange($2.get_fields());}var $3=false;tab.DataSchemaViewModel.sectionsInOrder.forEach(ss.Delegate.create(this,function($p1_0){
this.$1_4[$p1_0]=$1[$p1_0];var $1_0=this.buildSchemaHierarchy($p1_0);if(!$3&&!_.isEqual(this.$1_5[$p1_0],$1_0)){$3=true;}this.$1_5[$p1_0]=$1_0;}));this.raiseActionEvent(($3)?this.$1_B:this.$1_C);$0.close();}}
tab.DropTargetWithDropState=function(){spiff.DragDropManager.add_dragStarted(ss.Delegate.create(this,this.dragStarted));spiff.DragDropManager.add_dragEnded(ss.Delegate.create(this,this.dragEnded));}
tab.DropTargetWithDropState.prototype={$0:0,add_dropStateChanged:function(value){this.$1=ss.Delegate.combine(this.$1,value);},remove_dropStateChanged:function(value){this.$1=ss.Delegate.remove(this.$1,value);},$1:null,get_feedbackType:function(){return 'dropfeedbackuponentry';},get_dropState:function(){return this.$0;},set_dropState:function(value){if(this.$0===value){return;}this.$0=value;if(ss.isValue(this.$1)){this.$1(this.$0);}return value;},dispose:function(){spiff.DragDropManager.remove_dragStarted(ss.Delegate.create(this,this.dragStarted));spiff.DragDropManager.remove_dragEnded(ss.Delegate.create(this,this.dragEnded));},dragStarted:function(d){this.set_dropState((this.canAccept(d))?1:2);},dragEnded:function(result){this.set_dropState(0);}}
tab.SchemaViewFieldDropTarget=function(convertTarget){tab.SchemaViewFieldDropTarget.initializeBase(this);this.$2=convertTarget;}
tab.SchemaViewFieldDropTarget.prototype={$2:null,getDropTarget:function(hit){return this;},dragExit:function(d){},dragOver:function(d){if(this.canAccept(d)){return this;}return this.$2.dragOver(d);},isFieldDrop:function(d){if(Type.canCast(d,tab.PillDragInstance)){var $0=d;return $0.hasOnlyFields();}return false;},handleDrop:function(d,conversionCommand){if(this.canAccept(d)){var $0=(d);var $1=_.map($0.get_fields(),function($p1_0){
return (($p1_0.get_isColumn()&&$p1_0.asColumn().get_isInstance())?$p1_0.asColumn().get_baseColumn():$p1_0).get_globalName();});conversionCommand($1);return true;}return false;}}
tab.DimensionFieldDropTarget=function(convertTarget){tab.DimensionFieldDropTarget.initializeBase(this,[convertTarget]);}
tab.DimensionFieldDropTarget.prototype={canAccept:function(d){var $0=tab.FeatureParamsLookup.getBool(tab.FeatureParam.fieldTypeConversion);if(ss.isValue($0)&&$0){return this.isFieldDrop(d)&&_.every((d).get_fields(),function($p1_0){
return $p1_0.get_defaultRole()==='measure';});}return false;},acceptDrop:function(d){var $0=$.DeferredData();$0.resolve(this.handleDrop(d,tab.SchemaClientCommands.convertToDimension));return $0;}}
tab.MeasureFieldDropTarget=function(convertTarget){tab.MeasureFieldDropTarget.initializeBase(this,[convertTarget]);}
tab.MeasureFieldDropTarget.prototype={canAccept:function(d){var $0=tab.FeatureParamsLookup.getBool(tab.FeatureParam.fieldTypeConversion);if(ss.isValue($0)&&$0){return this.isFieldDrop(d)&&_.every((d).get_fields(),function($p1_0){
return $p1_0.get_defaultRole()==='dimension';});}return false;},acceptDrop:function(d){var $0=$.DeferredData();$0.resolve(this.handleDrop(d,tab.SchemaClientCommands.convertToMeasure));return $0;}}
tab.ConvertUnnamedFieldsDropTarget=function(doneCallback){tab.ConvertUnnamedFieldsDropTarget.initializeBase(this);this.$2=doneCallback;}
tab.ConvertUnnamedFieldsDropTarget.prototype={$2:null,get_doneCallback:function(){return this.$2;},dragOver:function(d){if(!this.canAccept(d)){return null;}return this;},dragExit:function(d){},acceptDrop:function(d){var $0=$.DeferredData();var $1=Type.safeCast(d,tab.PillDragInstance);if(ss.isNullOrUndefined($1)||!this.canAccept($1)){$0.reject(false);return $0;}var $2=tab.SchemaClientCommands.convertUnnamedFields(_.map($1.get_pills(),function($p1_0){
return $p1_0.get_field().get_globalName();}));$2.done(this.$2);return $2.pipe(function($p1_0){
return ss.isValue($p1_0);});},getDropTarget:function(hit){return this;},canAccept:function(d){var $0=Type.safeCast(d,tab.PillDragInstance);if(ss.isNullOrUndefined($0)||!tab.FeatureFlags.isEnabled('TypeInPills')){return false;}return _.any($0.get_pills(),function($p1_0){
return $p1_0.get_field().get_isUnnamedCalc();});}}
tab.FieldDragSource=function(fieldAccesor,onStartDrag){this.$1=fieldAccesor;this.$0=onStartDrag;}
tab.FieldDragSource.prototype={$0:null,$1:null,concreteFieldsToDragFrom:function(selectedFields){var $0=_.filter(selectedFields,function($p1_0){
return $p1_0.get_isDraggable();});var $1=_.map($0,function($p1_0){
return $p1_0.get_childToSelect();});return _.filter($1,function($p1_0){
return ss.isValue($p1_0);});},startDrag:function(e){var $0=this.concreteFieldsToDragFrom(this.$1());if(!$0.length){return null;}var $1=$0[0];var $2=($1.get_isColumn())?$1.asColumn().get_defaultFieldType():'unknown';var $3=new tab.PillDragInstance($0,$1.get_description(),$2);var $4=tab.ShelfClientCommands.startDrag($0,'invalid-encoding',tab.ModelUtils.findActivePaneSpecId());$4.done(function($p1_0){
if(ss.isValue($p1_0.axl)){$3.resolve($p1_0);}});if(ss.isValue(this.$0)){this.$0();}return $3;}}
tab.SchemaNode=function(model){this.children=[];if(ss.isValue(model)){this.canHaveChildren=model.get_canHaveChildren();if(ss.isValue(model.get_childToSelect())){this.childToSelect=model.get_childToSelect().get_globalName();}this.displayName=model.get_displayName();this.fieldIconResource=model.get_fieldIconResource();this.fieldType=model.get_defaultFieldType();this.globalFieldName=model.get_globalName();this.instanceType=model.get_instanceType();this.isCalculated=model.get_isColumn()&&model.asColumn().get_isCalculated();this.isCubeFolder=model.get_isCubeFolder();this.isDerived=model.get_isDerived();this.isDraggable=model.get_isDraggable();this.isFolder=model.get_isFolder();this.isGenerated=model.get_isGenerated();this.isGroup=model.get_isGroup();this.isHidden=model.get_isHidden();if(model.get_isCubeDimension()){this.isHierarchyRoot=true;}this.isMeasureNamesOrValues=model.get_isMeasureNamesOrValues();this.isSelectable=model.get_isSelectable();this.hasContextMenu=model.get_isSelectable()&&!model.get_isDrillPath();this.isUnsortedContainer=model.get_isUnsortedContainer();this.localName=model.get_localName();this.ordinal=model.get_ordinal();this.tooltip=model.get_tooltip();}else{this.isHidden=true;}}
tab.SchemaNode.prototype={canHaveChildren:false,childToSelect:null,fieldIconResource:null,fieldType:null,globalFieldName:null,instanceType:null,isCalculated:false,isCubeFolder:false,isDerived:false,isDraggable:false,isFolder:false,isGenerated:false,isGroup:false,isHidden:false,isHierarchyRoot:false,isMeasureNamesOrValues:false,isSelectable:false,hasContextMenu:false,isUnsortedContainer:false,localName:null,ordinal:0,tooltip:null,displayName:null,section:null,get_comparisonKey:function(){return (this.globalFieldName||this.localName)+(this.section||'');},find:function(fieldName){var $0=[];$0.enqueue(this);while($0.length>0){var $1=$0.dequeue();if($1.globalFieldName===fieldName){return $1;}var $enum1=ss.IEnumerator.getEnumerator($1.children);while($enum1.moveNext()){var $2=$enum1.current;$0.enqueue($2);}}return null;},equals:function(other){return this.globalFieldName===other.globalFieldName&&this.localName===other.localName&&this.section===other.section;}}
tab.ShapePickerViewModel=function(){this.$1_0=[];this.$1_1=new tab.ShapeModel('filled','square');tab.ShapePickerViewModel.initializeBase(this);var $0=ss.Delegate.create(this,function($p1_0){
this.$1_0.add(new tab.ShapeModel($p1_0,'circle'));this.$1_0.add(new tab.ShapeModel($p1_0,'square'));this.$1_0.add(new tab.ShapeModel($p1_0,'plus'));this.$1_0.add(new tab.ShapeModel($p1_0,'times'));this.$1_0.add(new tab.ShapeModel($p1_0,'asterisk'));this.$1_0.add(new tab.ShapeModel($p1_0,'diamond'));this.$1_0.add(new tab.ShapeModel($p1_0,'triangle'));this.$1_0.add(new tab.ShapeModel($p1_0,'down-triangle'));this.$1_0.add(new tab.ShapeModel($p1_0,'left-triangle'));this.$1_0.add(new tab.ShapeModel($p1_0,'right-triangle'));});$0(null);$0('filled');}
tab.ShapePickerViewModel.prototype={get_shapesPerRow:function(){return 5;},get_shapes:function(){return this.$1_0;},get_selectedShape:function(){return this.$1_1;},set_selectedShape:function(value){if(this.$1_1===value){return;}this.$1_1=value;this.notifyPropertyChanged('selectedShape');return value;},get_viewType:function(){return tab.ShapePickerView;},get_viewModel:function(){return this;},disposeViewModel:function(){this.dispose();},updateUberPopupViewModel:function(vm){}}
tab.ShelfViewModel=function(){this.$1_0=[];this.$1_6=0;tab.ShelfViewModel.initializeBase(this);spiff.DragDropManager.add_dragStarted(ss.Delegate.create(this,this.dragStarted));spiff.DragDropManager.add_dragEnded(ss.Delegate.create(this,this.dragEnded));if(tab.FeatureFlags.isEnabled('TypeInPills')){this.$1_2=new tab.CalculationEditorViewModel(tab.ApplicationModel.get_instance().get_typeInPillCalculationModel(),null);this.$1_2.add_calculationEdited(ss.Delegate.create(this,this.$1_19));this.$1_2.add_calculationCanceled(ss.Delegate.create(this,this.$1_1A));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$1_2.remove_calculationEdited(ss.Delegate.create(this,this.$1_19));this.$1_2.remove_calculationCanceled(ss.Delegate.create(this,this.$1_1A));})));this.$1_12();}}
tab.ShelfViewModel.prototype={$1_1:null,$1_2:null,$1_3:null,$1_4:false,$1_5:false,$1_7:null,$1_8:true,$1_9:false,$1_A:null,add_shelfChanged:function(value){this.$1_B=ss.Delegate.combine(this.$1_B,value);},remove_shelfChanged:function(value){this.$1_B=ss.Delegate.remove(this.$1_B,value);},$1_B:null,add_visibleChanged:function(value){this.$1_C=ss.Delegate.combine(this.$1_C,value);},remove_visibleChanged:function(value){this.$1_C=ss.Delegate.remove(this.$1_C,value);},$1_C:null,add_dropStateChanged:function(value){this.$1_D=ss.Delegate.combine(this.$1_D,value);},remove_dropStateChanged:function(value){this.$1_D=ss.Delegate.remove(this.$1_D,value);},$1_D:null,add_dragOverDropPositionChanged:function(value){this.$1_E=ss.Delegate.combine(this.$1_E,value);},remove_dragOverDropPositionChanged:function(value){this.$1_E=ss.Delegate.remove(this.$1_E,value);},$1_E:null,add_openTypeInPill:function(value){this.$1_F=ss.Delegate.combine(this.$1_F,value);},remove_openTypeInPill:function(value){this.$1_F=ss.Delegate.remove(this.$1_F,value);},$1_F:null,get_isVisible:function(){return this.$1_8;},set_isVisible:function(value){if(this.$1_8===value){return;}this.$1_8=value;this.raiseActionEvent(this.$1_C);return value;},get_dropTarget:function(){return this;},get_supportsMultiplePills:function(){switch(this.get_shelfType()){case 'columns-shelf':case 'rows-shelf':case 'pages-shelf':case 'filter-shelf':case 'encoding-shelf':case 'measures-shelf':return true;default:return false;}},get_title:function(){var $0='';switch(this.get_shelfType()){case 'columns-shelf':$0=tab.Strings.AuthCardTitleColumns;break;case 'rows-shelf':$0=tab.Strings.AuthCardTitleRows;break;case 'pages-shelf':$0=tab.Strings.AuthCardTitlePages;break;case 'filter-shelf':$0=tab.Strings.AuthCardTitleFilters;break;case 'measures-shelf':$0=tab.Strings.AuthCardTitleMeasureValues;break;}return $0;},get_name:function(){var $0=this.get_shelfType();return $0.replaceAll('-shelf','');},get_viewModel:function(){return this;},get_collapsedTitleDetail:function(){return (ss.isValue(this.$1_0))?this.$1_0.length.toString():'';},get_viewType:function(){return tab.ShelfView;},get_pills:function(){return this.$1_0;},get_shelfType:function(){if(ss.isNullOrUndefined(this.$1_1)){return 'none-shelf';}return this.$1_1.get_shelfType();},get_orientation:function(){switch(this.get_shelfType()){case 'columns-shelf':case 'rows-shelf':return 1;default:return 0;}},get_shelf:function(){return this.$1_1;},set_shelf:function(value){if(ss.isValue(this.$1_1)){this.$1_1.remove_shelfChanged(ss.Delegate.create(this,this.$1_15));}this.$1_1=value;this.$1_1.add_shelfChanged(ss.Delegate.create(this,this.$1_15));this.$1_12();this.updatePills();return value;},get_typeInPillCalculation:function(){return (this.get_hasTypeInPill())?this.$1_2:null;},get_dropState:function(){return this.$1_6;},set_dropState:function(value){if(this.$1_6===value){return;}this.$1_6=value;if(ss.isValue(this.$1_D)){this.$1_D(this.$1_6);}return value;},get_dragOverDropPosition:function(){return this.$1_7;},set_dragOverDropPosition:function(value){if(this.$1_7===value){return;}this.$1_7=value;if(ss.isValue(this.$1_E)){this.$1_E(value);}return value;},get_feedbackType:function(){return 'dropfeedbackuponentry';},get_hasTypeInPill:function(){return ss.isValue(this.$1_2)&&this.$1_2.get_hasCalculation()&&this.$1_2.get_shelfType()===this.get_shelfType()&&(this.get_shelfType()!=='encoding-shelf'||this.$1_1.get_paneId()===this.$1_2.get_shelfPaneSpecId());},get_animateTypeInPillPending:function(){return this.$1_5;},createPillDividerDropTarget:function(index){return new tab.vqlauthoring$1(this,index);},matchingDropsFrom:function(drag){if(!drag.get_drop().isResolved()){}return _.find(drag.get_dropPresModels(),ss.Delegate.create(this,function($p1_0){
return $p1_0.ajv===this.get_shelfType();}));},canAccept:function(d,index){var $0=Type.safeCast(d,tab.BaseFieldDragInstance);if(!d.get_hasPayload()||ss.isNullOrUndefined($0)){return false;}if(!$0.get_drop().isResolved()){this.set_dragOverDropPosition(null);if(Type.canCast($0,tab.PillDragInstance)){return ss.isValue($0.get_fields());}else if(Type.canCast($0,tab.CalcTextDragInstance)){return true;}return false;}var $1=this.matchingDropsFrom($0);if(ss.isNullOrUndefined($1)){this.set_dragOverDropPosition(null);return false;}var $2=this.$1_11($1,index);this.set_dragOverDropPosition($2);return ss.isValue($2);},dragOver:function(d,index){this.$1_9=true;this.$1_A=index;var $0=this.canAccept(d,index);if(!$0){return null;}if(ss.isValue(this.$1_7)&&this.$1_7.akb==='replace'&&this.$1_7.wz<this.$1_0.length){return this.$1_0[this.$1_7.wz];}return this;},dragExit:function(d){this.$1_9=false;this.$1_A=null;this.set_dragOverDropPosition(null);},getDropTarget:function(hit){return this;},acceptDrop:function(d,index){var $0=$.DeferredData();if(!(Type.canCast(d,tab.BaseFieldDragInstance))){$0.resolve(false);return $0;}var $1=ss.Delegate.create(this,function($p1_0){
var $1_0=this.canAccept($p1_0,index);var $1_1=this.matchingDropsFrom($p1_0);var $1_2=this.$1_11($1_1,index);var $1_3=-1;if(ss.isValue($1_2)){$1_3=$1_2.wz;}if(!$1_0){}else if($p1_0.hasOnlyPills()){var $1_4=$p1_0.get_pill();if($1_4.get_shelf().get_shelfType()===this.get_shelfType()){var $1_5=$1_4.get_indexInShelf();if($1_5>=0&&($1_3===$1_5||$1_3===$1_5+1)){$1_0=false;}}if($1_0){var $1_6=$p1_0.dropPositionForShelf(this,$1_3);tab.ShelfClientCommands.moveShelfPill($1_4.get_shelf().get_shelf(),this.get_shelf(),$1_4.get_pill(),$1_6,$p1_0.isCopyDrag);}}else if($p1_0.hasOnlyFields()){var $1_7=$p1_0.fieldsToDropOnShelf(this.get_shelfType());var $1_8=$p1_0.dropPositionForShelf(this,$1_3);tab.ShelfClientCommands.addShelfField(this.$1_1,$1_7,'invalid-encoding',$1_8);}$0.resolve($1_0);});if((d).get_drop().isResolved()){$1(d);}else{(d).get_drop().done($1);}return $0;},dispose:function(){if(ss.isValue(this.$1_2)){this.$1_2.dispose();}spiff.DragDropManager.remove_dragStarted(ss.Delegate.create(this,this.dragStarted));spiff.DragDropManager.remove_dragEnded(ss.Delegate.create(this,this.dragEnded));if(ss.isValue(this.$1_1)){this.$1_1.remove_shelfChanged(ss.Delegate.create(this,this.$1_15));}this.$1_16();tab.ShelfViewModel.callBaseMethod(this, 'dispose');},dragEnded:function(d){this.$1_9=false;this.$1_A=null;this.set_dropState(0);if(!d.canceled&&!d.isCopyDrop&&ss.isNullOrUndefined(d.target)&&Type.canCast(d.drag,tab.BaseFieldDragInstance)&&(d.drag).hasOnlyPills()){var $0=(d.drag).get_pill();if(this.hasPill($0)){this.removePill($0);}}},dragStarted:function(d){if(d.get_dragType()==='dragdrop'){if(Type.canCast(d,tab.BaseFieldDragInstance)){(d).get_drop().always(ss.Delegate.create(this,this.$1_17));}this.set_dropState((this.canAccept(d,null))?1:2);}else{this.set_dropState(0);}},insertAdHocCalc:function(){if(this.get_hasTypeInPill()){return;}tab.CalculationCommands.createAdHocCalculation(this.$1_1.get_shelfType(),this.$1_0.length,this.$1_1.get_paneId());},editPill:function(fieldName,indexInShelf){tab.CalculationCommands.editPill(fieldName,this.get_shelfType(),indexInShelf,this.get_shelf().get_paneId());},$1_10:function(){return !this.$1_0.length;},removePill:function(p){tab.ShelfClientCommands.removeShelfPill(this.$1_1,p.get_pill());this.$1_1B();},hasPill:function(p){return this.$1_0.contains(p);},updatePills:function(){if(ss.isNullOrUndefined(this.$1_1)){return;}this.$1_16();if(ss.isValue(this.$1_1.get_pills())){var $enum1=ss.IEnumerator.getEnumerator(this.$1_1.get_pills());while($enum1.moveNext()){var $0=$enum1.current;var $1=new tab.PillViewModel();$1.set_pill($0);$1.set_shelf(this);$1.add_disposed(ss.Delegate.create(this,this.$1_18));this.$1_0.add($1);}}this.set_isVisible(this.$1_1.get_shelfType()!=='measures-shelf'||!this.$1_10());this.$1_1B();},$1_11:function($p0,$p1){if(ss.isNullOrUndefined($p0)){return null;}var $0=ss.Delegate.create(this,function($p1_0){
return Math.abs($p1_0.wz-((ss.isValue($p1))?$p1:this.$1_0.length));});var $1=function($p1_0){
return $p1_0.wz===$p1;};var $2=null;if(ss.isValue($p1)){$2=_.find($p0.axj,$1);}if(ss.isNullOrUndefined($2)){$2=_.min($p0.axj,$0);}return $2;},$1_12:function(){this.$1_3=null;if(this.get_hasTypeInPill()){this.$1_3=this.$1_2.get_shelfPosition();}},$1_13:function(){if(this.$1_4){this.$1_4=false;tab.CommandController.get().remove_postBootstrap(ss.Delegate.create(this,this.$1_13));tab.CommandController.get().remove_postRemoteCommand(ss.Delegate.create(this,this.$1_13));if(ss.isValue(this.$1_F)){this.$1_F(this.$1_5);this.$1_5=false;}}},$1_14:function(){if(this.get_hasTypeInPill()&&ss.isValue(this.$1_2.get_shelfPosition())){if(!ss.isValue(this.$1_3)||(this.$1_3!==this.$1_2.get_shelfPosition())){this.$1_5=true;}if(!this.$1_4){this.$1_4=true;tab.CommandController.get().add_postRemoteCommand(ss.Delegate.create(this,this.$1_13));tab.CommandController.get().add_postBootstrap(ss.Delegate.create(this,this.$1_13));}}this.$1_12();},$1_15:function($p0){this.$1_14();this.updatePills();},$1_16:function(){var $enum1=ss.IEnumerator.getEnumerator(this.$1_0);while($enum1.moveNext()){var $0=$enum1.current;$0.remove_disposed(ss.Delegate.create(this,this.$1_18));$0.dispose();}this.$1_0.clear();},$1_17:function($p0){var $0=this.matchingDropsFrom($p0);this.set_dropState((ss.isValue($0))?1:2);if(!this.$1_9){return;}this.canAccept($p0,this.$1_A);},$1_18:function($p0){this.$1_0.remove($p0);this.$1_1B();},$1_19:function(){if(!this.get_hasTypeInPill()){return;}this.$1_14();this.$1_1B();},$1_1A:function(){if(this.$1_3==null){return;}this.$1_12();this.$1_1B();},$1_1B:function(){if(ss.isValue(this.$1_B)){this.$1_B(this);}}}
tab.vqlauthoring$1=function(vm,index){this.vm=vm;this.$0=index;}
tab.vqlauthoring$1.prototype={vm:null,$0:0,get_feedbackType:function(){return 'dropfeedbackuponentry';},dragOver:function($p0){var $0=this.vm.dragOver($p0,this.$0);if(ss.isValue($0)){return this;}return null;},dragExit:function($p0){this.vm.dragExit($p0);},acceptDrop:function($p0){return this.vm.acceptDrop($p0,this.$0);},getDropTarget:function($p0){return this;}}
tab.CalculationDependencyViewModel=function(dependencies,maxWidth){tab.CalculationDependencyViewModel.initializeBase(this);this.$1_0=dependencies;this.$1_1=maxWidth;}
tab.CalculationDependencyViewModel.prototype={$1_0:null,$1_1:0,get_viewType:function(){return tab.CalculationDependencyView;},get_viewModel:function(){return this;},get_dependencies:function(){return this.$1_0;},get_maxWidth:function(){return this.$1_1;},disposeViewModel:function(){this.dispose();},updateUberPopupViewModel:function(vm){}}
tab.ShowMeViewModel=function(){tab.ShowMeViewModel.initializeBase(this);}
tab.ShowMeViewModel.prototype={$1_0:null,$1_1:null,get_viewType:function(){return tab.ShowMeView;},get_viewModel:function(){return this;},get_showMeCommands:function(){return this.$1_0.get_commands();},get_closeOnInteraction:function(){return ss.isValue(this.$1_1)&&this.$1_1.get_mode()===spiff.UberPopupMode.closeOnExternalInteraction;},set_closeOnInteraction:function(value){if(ss.isNullOrUndefined(this.$1_1)){return;}this.$1_1.set_mode((value)?spiff.UberPopupMode.closeOnExternalInteraction:spiff.UberPopupMode.ignoreExternalInteraction);return value;},dispose:function(){tab.ShowMeViewModel.callBaseMethod(this, 'dispose');this.$1_0.remove_commandsChanged(ss.Delegate.create(this,this.$1_3));tab.ApplicationModel.get_instance().get_workbook().removeDashboardHandler(ss.Delegate.create(this,this.$1_2));},disposeViewModel:function(){this.dispose();},updateUberPopupViewModel:function(vm){this.$1_1=vm;},isCommandEnabled:function(c){var $0=tab.CommandItemWrapper.create(c);return $0.get_enabled()||ss.isNullOrUndefined($0.get_enabled());},applyShowMeCommand:function(c){if(ss.isValue(c)&&this.isCommandEnabled(c)){tab.ServerCommands.executeServerCommand(tab.CommandSerializer.deserialize(tab.CommandItemWrapper.create(c).get_command()),'immediately');}},close:function(){if(ss.isNullOrUndefined(this.$1_1)){return;}this.$1_1.hide();},initialize:function(){tab.ApplicationModel.get_instance().get_workbook().addNewDashboardHandler(ss.Delegate.create(this,this.$1_2));},$1_2:function($p0){if(ss.isValue(this.$1_0)){this.$1_0.remove_commandsChanged(ss.Delegate.create(this,this.$1_3));this.$1_0=null;}this.$1_0=tab.ModelUtils.findActiveOrDefaultVisual().get_showMeModel();this.$1_0.add_commandsChanged(ss.Delegate.create(this,this.$1_3));this.$1_3(null);},$1_3:function($p0){this.notifyPropertyChanged('ShowMeCommands');}}
tab.CalcTextDragInstance=function(text){tab.CalcTextDragInstance.initializeBase(this,[text,new tab.CalcTextDragAvatar(text)]);this.$1_0=this.get_dragAvatar();this.$1_1=text;}
tab.CalcTextDragInstance.prototype={$1_0:null,$1_1:null,get_fields:function(){if(this.get_drop().isResolved()){return this.draggedObject;}return null;},get_pills:function(){return null;},get_pill:function(){return null;},get_text:function(){return this.$1_1;},hasOnlyFields:function(){return true;},hasOnlyPills:function(){return false;},resolve:function(dragResponse){if(this.finalDrop.isResolved()||ss.isNullOrUndefined(dragResponse)){return;}this.drag=(dragResponse).axm;var $0=(dragResponse).afc;var $1=tab.ApplicationModel.get_instance().get_workbook().get_dataSchema();var $2=$1.findField($0);if(ss.isValue($2)){this.draggedObject=[$2];this.$1_0.set_label($2.get_description());}this.finalDrop.resolve(this);},reject:function(dragResponse){if(this.finalDrop.isResolved()||!ss.isNullOrUndefined(dragResponse)){return;}if(ss.isNullOrUndefined(this.drag)){this.drag=(dragResponse).axm;}this.finalDrop.reject(this);}}
tab.TooltipContentViewModel=function(layerEncondingModel){tab.TooltipContentViewModel.initializeBase(this);this.$1_0=layerEncondingModel;this.add_resetClicked(ss.Delegate.create(this,this.$1_3));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.remove_resetClicked(ss.Delegate.create(this,this.$1_3));})));}
tab.TooltipContentViewModel.prototype={$1_0:null,$1_1:null,add_resetClicked:function(value){this.$1_2=ss.Delegate.combine(this.$1_2,value);},remove_resetClicked:function(value){this.$1_2=ss.Delegate.remove(this.$1_2,value);},$1_2:null,get_viewType:function(){return tab.TooltipContentView;},get_viewModel:function(){return this;},disposePopupViewModel:function(){if(ss.isValue(this.$1_1)){this.$1_1.dispose();this.$1_1=null;}},disposeViewModel:function(){this.dispose();},updateUberPopupViewModel:function(vm){this.$1_1=vm;},resetTooltip:function(){this.$1_2();this.disposePopupViewModel();},$1_3:function(){tab.PaneClientCommands.resetTooltip(this.$1_0);}}
tab.VizSummaryViewModel=function(){tab.VizSummaryViewModel.initializeBase(this);}
tab.VizSummaryViewModel.prototype={$1_0:null,$1_1:null,$1_2:null,$1_3:false,$1_4:false,add_summaryChanged:function(value){this.$1_5=ss.Delegate.combine(this.$1_5,value);},remove_summaryChanged:function(value){this.$1_5=ss.Delegate.remove(this.$1_5,value);},$1_5:null,get_showShelves:function(){return this.$1_4;},set_showShelves:function(value){this.$1_4=value;this.$1_7();return value;},get_showLayers:function(){return this.$1_3;},set_showLayers:function(value){this.$1_3=value;this.$1_7();return value;},get_numDimensions:function(){if(ss.isNullOrUndefined(this.$1_0)){return 0;}return this.$1_0.nodeTreeForSection('dimensions').length;},get_numMeasures:function(){if(ss.isNullOrUndefined(this.$1_0)){return 0;}return this.$1_0.nodeTreeForSection('measure').length;},get_numSets:function(){if(ss.isNullOrUndefined(this.$1_0)){return 0;}return this.$1_0.nodeTreeForSection('groups').length;},get_numParameters:function(){if(ss.isNullOrUndefined(this.$1_0)){return 0;}return this.$1_0.nodeTreeForSection('parameters').length;},get_numColumnShelfItems:function(){return this.$1_6('columns-shelf');},get_numRowShelfItems:function(){return this.$1_6('rows-shelf');},get_numFilterShelfItems:function(){return this.$1_6('filter-shelf');},get_numPageShelfItems:function(){return this.$1_6('pages-shelf');},get_layers:function(){return [];},get_layerMarkTypes:function(){if(ss.isNullOrUndefined(this.$1_2)){return [];}return _.map(this.$1_2.get_layers(),function($p1_0){
return $p1_0.get_currentPrimitiveType().aik;});},dispose:function(){if(ss.isValue(this.$1_0)){this.$1_0.remove_dataSchemaModified(ss.Delegate.create(this,this.$1_7));}if(ss.isValue(this.$1_1)){this.$1_1.remove_newShelves(ss.Delegate.create(this,this.$1_7));}tab.VizSummaryViewModel.callBaseMethod(this, 'dispose');},update:function(newDataSchema,newShelves,newMarks){if(ss.isValue(this.$1_0)){this.$1_0.remove_dataSchemaModified(ss.Delegate.create(this,this.$1_7));}if(ss.isValue(this.$1_1)){this.$1_1.remove_newShelves(ss.Delegate.create(this,this.$1_7));}this.$1_0=newDataSchema;this.$1_1=newShelves;this.$1_2=newMarks;if(ss.isValue(this.$1_0)){this.$1_0.add_dataSchemaModified(ss.Delegate.create(this,this.$1_7));}if(ss.isValue(this.$1_1)){this.$1_1.add_newShelves(ss.Delegate.create(this,this.$1_7));}this.$1_7();},$1_6:function($p0){if(ss.isNullOrUndefined(this.$1_1)){return 0;}var $0=this.$1_1.findShelf($p0);if(ss.isNullOrUndefined($0)){return 0;}return $0.get_pills().length;},$1_7:function(){if(ss.isNullOrUndefined(this.$1_5)){return;}this.$1_5();}}
tab.AnalyticsDropTargetView=function(viewModel,glassParent){this.$2_1=[];tab.AnalyticsDropTargetView.initializeBase(this,[viewModel,new tab.AnalyticsDropTargetTemplate()]);spiff.DragDropManager.add_dragEnded(ss.Delegate.create(this,this.$2_9));this.$2_0=new tab.GlassDropTarget(glassParent);this.$2_0.set_opaque(true);this.$2_0.show();this.$2_7(glassParent);if(tab.FeatureFlags.isEnabled('AnalyticsObjectsDefaultDrop')&&!!tab.FeatureParamsLookup.getBool(tab.FeatureParam.analyticsObjectsDragToViz)){this.$2_0.set_opaque(false);spiff.DragDropManager.attachDropTarget(this.$2_0.get_element(),this.$2_0);}}
tab.AnalyticsDropTargetView.prototype={$2_0:null,get_$2_2:function(){return this.get_template();},get_$2_3:function(){return this.get_viewModel();},onAddedToDom:function(){tab.AnalyticsDropTargetView.callBaseMethod(this, 'onAddedToDom');this.$2_4();this.$2_5();this.$2_8(null);this.get_element().css('visibility','visible');},$2_4:function(){var $0=this.get_element().find('.tabAdDropTitle').width();var $1=this.get_element().find('.tabAdAxisName');for(var $2=0,$3=$1.length;$2<$3;$2++){if($1.eq($2).width()!==$0){$1.eq($2).width($0);}}},$2_5:function(){var $0=this.get_element().find('.tabAdAxisRow');if(!$0.length){return;}var $1=this.get_element().find('.tabAdDropCell');for(var $2=0;$2<$1.length;$2++){var $3=$1.eq($2).width();var $4=$0.find('.tabAdAxisDropSpotHolder:eq('+$2+')');if($4.width()!==$3){$4.width($3);}}},dispose:function(){spiff.DragDropManager.remove_dragEnded(ss.Delegate.create(this,this.$2_9));this.$2_0.dispose();tab.AnalyticsDropTargetView.callBaseMethod(this, 'dispose');},onViewModelPropertyChanged:function(sender,e){tab.AnalyticsDropTargetView.callBaseMethod(this, 'onViewModelPropertyChanged',[sender,e]);this.$2_6();},$2_6:function(){var $0=this.get_$2_3().get_hoverTarget();var $enum1=ss.IEnumerator.getEnumerator(this.$2_1);while($enum1.moveNext()){var $1=$enum1.current;$1.first.toggleClass('tabDirectHover',$1.second.directMatch($0));$1.first.toggleClass('tabIndirectHover',$1.second.indirectMatch($0));}},$2_7:function($p0){this.$2_1.clear();this.get_$2_2().setDropLabel(this.get_$2_3().get_dropLabel());var $0=1;var $enum1=ss.IEnumerator.getEnumerator(this.get_$2_3().get_dropZoneItems());while($enum1.moveNext()){var $1=$enum1.current;$0=Math.max($0,$1.mc.toString().split('\n').length);}var $enum2=ss.IEnumerator.getEnumerator(this.get_$2_3().get_dropZoneItems());while($enum2.moveNext()){var $2=$enum2.current;var $3=this.get_$2_2().addDropColumnHeader($2.mc,$0,tab.AnalyticsPaneView.getClassNameForIcon($2.mo,'tabAuthAnalyticsPaneDrop'));if($2.an){var $4=new tab.AnalyticsDropSpot($2,null,$2.ic);this.$2_1.add(new ss.Tuple($3,$4));}else{$3.addClass('tabAdDropDisabled');}$3.get(0).id=tab.DomUtil.makeHtmlSafeId('tabAoDropTarget-'+$2.mc);}if(this.get_$2_3().get_showDropMeasures()){var $5=this.get_$2_3().get_dropMeasureNamePairs();var $enum3=ss.IEnumerator.getEnumerator($5);while($enum3.moveNext()){var $9=$enum3.current;var $A=new tab.AnalyticsDropTargetAxisRowTemplate();var $B=$9.r2;$A.setAxisName($B);var $C=new tab.AnalyticsDropSpot(null,$9,false);this.$2_1.add(new ss.Tuple($A.axisHeader,$C));var $enum4=ss.IEnumerator.getEnumerator(this.get_$2_3().get_dropZoneItems());while($enum4.moveNext()){var $D=$enum4.current;var $E=$A.$1_2();if($D.an&&(tab.MiscUtil.isNullOrEmpty($D.aft)||!$D.aft.contains($9.afc))){$C=new tab.AnalyticsDropSpot($D,$9,$D.ic);this.$2_1.add(new ss.Tuple($E,$C));}else{$E.css('visibility','hidden');}$E.get(0).id=tab.DomUtil.makeHtmlSafeId('tabAoDropTarget-'+$B+$D.mc);}this.get_$2_2().axisList.append($A.get_domRoot());}var $6=$($p0).height()-90;this.get_$2_2().axisListScroller.css('max-height',$6+'px');var $7=new tab.AnalyticsScrollSpot(-1,this.get_$2_2().axisListScroller);var $8=new tab.AnalyticsScrollSpot(1,this.get_$2_2().axisListScroller);spiff.DragDropManager.attachDropTarget(this.get_$2_2().axisScrollTopSpot,$7);spiff.DragDropManager.attachDropTarget(this.get_$2_2().axisScrollBottomSpot,$8);(this.get_$2_2().axisListScroller).on('scroll',ss.Delegate.create(this,this.$2_8));}else{this.get_$2_2().horizontalDivider.hide();}var $enum5=ss.IEnumerator.getEnumerator(this.$2_1);while($enum5.moveNext()){var $F=$enum5.current;spiff.DragDropManager.attachDropTarget($F.first,$F.second);}},$2_8:function($p0){var $0=this.get_$2_2().axisListScroller;if(!$0.scrollTop()){this.get_$2_2().axisScrollTopSpot.hide();}else{this.get_$2_2().axisScrollTopSpot.show();}var $1=this.get_$2_2().axisList.height();if(!$1||$0.scrollTop()+parseInt($0.css('max-height'))>=$1){this.get_$2_2().axisScrollBottomSpot.hide();}else{this.get_$2_2().axisScrollBottomSpot.show();}},$2_9:function($p0){this.dispose();}}
tab.GlassDropTarget=function(glassParent){tab.GlassDropTarget.initializeBase(this,[glassParent]);}
tab.GlassDropTarget.prototype={get_feedbackType:function(){return 'dropfeedbackuponentry';},dragOver:function(d){return this;},dragExit:function(d){},acceptDrop:function(d){var $0=Type.safeCast(d.get_payload(),tab.AnalyticsDropTargetViewModel);var $1=$.DeferredData();var $2=ss.isValue($0);$1.resolve($2);if($2){$0.executeDefaultAddCommand();}return $1;},getDropTarget:function(hit){return this;}}
tab.AnalyticsDropSpot=function(dzi,axisPair,commandUsesFieldList){this.$0=dzi;this.$1=axisPair;this.$2=commandUsesFieldList;}
tab.AnalyticsDropSpot.prototype={$0:null,$1:null,$2:false,get_excludedFields:function(){return this.$0.aft;},get_command:function(){return (ss.isValue(this.$0))?this.$0.aow:null;},get_axis:function(){return this.$1;},get_commandUsesFields:function(){return this.$2;},get_feedbackType:function(){return 'dropfeedbackuponentry';},directMatch:function(hoveredTarget){return ss.isValue(hoveredTarget)&&this.get_command()===hoveredTarget.get_command()&&(this.$1===hoveredTarget.$1||ss.isNullOrUndefined(hoveredTarget.$1));},indirectMatch:function(hoveredTarget){return ss.isValue(hoveredTarget)&&(this.get_command()===hoveredTarget.get_command()||ss.isNullOrUndefined(this.get_command())||ss.isNullOrUndefined(hoveredTarget.get_command()))&&(this.get_command()===hoveredTarget.get_command()||this.$1===hoveredTarget.$1||ss.isNullOrUndefined(this.$1)||ss.isNullOrUndefined(hoveredTarget.$1));},dragOver:function(d){var $0=Type.safeCast(d.get_payload(),tab.AnalyticsDropTargetViewModel);if(ss.isValue($0)){$0.setHoveredTarget(this);}return this;},dragExit:function(d){var $0=Type.safeCast(d.get_payload(),tab.AnalyticsDropTargetViewModel);if(ss.isValue($0)){$0.removeHoveredTarget(this);}},acceptDrop:function(d){var $0=Type.safeCast(d.get_payload(),tab.AnalyticsDropTargetViewModel);var $1=$.DeferredData();var $2=ss.isValue($0)&&ss.isValue(this.get_command());$1.resolve($2);if($2){$0.executeDropCommand(this);}return $1;},getDropTarget:function(hit){return this;}}
tab.AnalyticsScrollSpot=function(scrollDir,scrollTarget){this.$3=-1;this.$1=scrollDir*10;this.$2=scrollTarget;}
tab.AnalyticsScrollSpot.prototype={$1:0,$2:null,get_feedbackType:function(){return 'dropfeedbackuponentry';},dragOver:function(d){this.$3=window.setInterval(ss.Delegate.create(this,this.$4),100);return this;},dragExit:function(d){this.$5();},acceptDrop:function(d){this.$5();var $0=$.DeferredData();$0.resolve(false);return $0;},getDropTarget:function(hit){return this;},$4:function(){var $0=this.$2.scrollTop();this.$2.scrollTop($0+this.$1);if($0===this.$2.scrollTop()){this.$5();}},$5:function(){if(this.$3>0){window.clearInterval(this.$3);this.$3=-1;}}}
tab.AnalyticsDropTargetTemplate=function(){tab.AnalyticsDropTargetTemplate.initializeBase(this,[$(tab.AnalyticsDropTargetTemplate.$1_1)]);this.horizontalDivider=this.getElementBySelector('.tabAdHorizontalDivider');this.axisHolder=this.getElementBySelector('.tabAdAxisHolder');this.axisListScroller=this.getElementBySelector('.tabAdAxisListScroller');this.axisList=this.getElementBySelector('.tabAdAxisList');this.$1_2=this.getElementBySelector('.tabAdDropLabel');this.axisScrollTopSpot=this.getElementBySelector('.tabAdScrollHoverTop');this.axisScrollBottomSpot=this.getElementBySelector('.tabAdScrollHoverBottom');}
tab.AnalyticsDropTargetTemplate.prototype={horizontalDivider:null,axisHolder:null,axisListScroller:null,axisList:null,axisScrollTopSpot:null,axisScrollBottomSpot:null,$1_2:null,setDropLabel:function(val){var $0=val;var $1=$0.split('|');this.getElementBySelector('.tabAdDropInstructionTextPre').text($1[0]);this.$1_2.text($1[1]);this.getElementBySelector('.tabAdDropInstructionTextPost').text($1[2]);},addDropColumnHeader:function(description,numLines,iconClass){var $0=$(tab.AnalyticsDropTargetTemplate.$1_0);var $1=$0.find('.tabAdAreaDropLabel');var $2=description.split('\n');for(var $3=0;$3<numLines;++$3){var $4=$('<div />');if($3<$2.length){$4.text($2[$3]);}else{$4.html('&nbsp;');}$1.append($4);}$0.find('.tabAdAreaDropImage').addClass(iconClass);this.getElementBySelector('.tabAdHeaderRow').append($0);return $0;}}
tab.AnalyticsDropTargetAxisRowTemplate=function(){tab.AnalyticsDropTargetAxisRowTemplate.initializeBase(this,[$(tab.AnalyticsDropTargetAxisRowTemplate.$1_1)]);this.axisHeader=this.getElementBySelector('.tabAdAxisName');}
tab.AnalyticsDropTargetAxisRowTemplate.prototype={axisHeader:null,setAxisName:function(val){this.axisHeader.text(val);},$1_2:function(){var $0=$(tab.AnalyticsDropTargetAxisRowTemplate.$1_0);this.get_domRoot().append($0);return $0;}}
tab.AnalyticsPaneView=function(viewModel){this.$2_0=[];tab.AnalyticsPaneView.initializeBase(this,[viewModel,new tab.AnalyticsPaneTemplate()]);this.$2_2();}
tab.AnalyticsPaneView.getClassNameForIcon=function(iconName,className){className=className||'tabAuthAnalyticsPane';return className+'-'+tab.TabResources.getResourceName(tab.TabResources.lookupFullResourceAlias(iconName));}
tab.AnalyticsPaneView.prototype={get_$2_1:function(){return this.get_viewModel();},dispose:function(){this.$2_3();tab.AnalyticsPaneView.callBaseMethod(this, 'dispose');},onViewModelPropertyChanged:function(sender,e){this.$2_2();},$2_2:function(){this.$2_3();var $0=true;var $enum1=ss.IEnumerator.getEnumerator(this.get_$2_1().get_analyticsItemViewModelLists());while($enum1.moveNext()){var $1=$enum1.current;var $2=new tab.AnalyticsListHeaderTemplate($1.first);this.get_element().append($2.get_domRoot());if($0){$0=false;}else{$2.get_domRoot().addClass('tabAnalyticsListHeaderSpacer');}var $enum2=ss.IEnumerator.getEnumerator($1.second);while($enum2.moveNext()){var $3=$enum2.current;var $4=new tab.AnalyticsListItemView($3);this.get_element().append($4.get_element());this.$2_0.add($4);spiff.DragDropManager.attachDragSource($4.get_element(),$4.get_itemViewModel());}}},$2_3:function(){this.get_element().children().remove();var $enum1=ss.IEnumerator.getEnumerator(this.$2_0);while($enum1.moveNext()){var $0=$enum1.current;$0.dispose();}this.$2_0.clear();}}
tab.AnalyticsListItemView=function(vm){tab.AnalyticsListItemView.initializeBase(this,[vm,new tab.AnalyticsListItemTemplate()]);this.get_$2_0().name.text(this.get_itemViewModel().get_analyticsItem().mb);var $0=tab.AnalyticsPaneView.getClassNameForIcon(this.get_itemViewModel().get_analyticsItem().mp);this.get_$2_0().icon.addClass($0);if(tab.FeatureFlags.isEnabled('AnalyticsObjectsDefaultDrop')){this.disposables.add(spiff.TableauClickHandler.target(this.get_element()[0]).onDoubleClick(ss.Delegate.create(this.get_itemViewModel(),this.get_itemViewModel().executeDefaultAddCommand)));}this.$2_1();}
tab.AnalyticsListItemView.prototype={get_itemViewModel:function(){return this.get_viewModel();},get_$2_0:function(){return this.get_template();},onViewModelPropertyChanged:function(sender,e){tab.AnalyticsListItemView.callBaseMethod(this, 'onViewModelPropertyChanged',[sender,e]);this.$2_1();},$2_1:function(){var $0=this.get_itemViewModel().get_analyticsItem().an;this.get_$2_0().name.toggleClass('tabDisabled',!$0);this.get_$2_0().name.toggleClass('tabEnabled',$0);}}
tab.AnalyticsDragAvatar=function(itemViewModel){tab.AnalyticsDragAvatar.initializeBase(this,[itemViewModel,new tab.AnalyticsDragAvatarTemplate(itemViewModel.get_analyticsItem().mb)]);}
tab.AnalyticsDragAvatarTemplate=function(displayName){tab.AnalyticsDragAvatarTemplate.initializeBase(this,[$("\n        <span class='tabAuthAnalyticsDragAvatar'>\n            <div class='tabAuthAnalyticsDragAvatarLabel'></div>\n        </span>")]);this.getElementBySelector('.tabAuthAnalyticsDragAvatarLabel').text(displayName);}
tab.AnalyticsPaneTemplate=function(){tab.AnalyticsPaneTemplate.initializeBase(this,[$("<div class='tabAnalyticsPane'></div>")]);}
tab.AnalyticsListItemTemplate=function(){tab.AnalyticsListItemTemplate.initializeBase(this,[$(tab.AnalyticsListItemTemplate.$1_0)]);this.icon=this.getElementBySelector('.tabAnalyticsListItemIcon');this.name=this.getElementBySelector('.tabAnalyticsListItemName');}
tab.AnalyticsListItemTemplate.prototype={icon:null,name:null}
tab.AnalyticsListHeaderTemplate=function(name){tab.AnalyticsListHeaderTemplate.initializeBase(this,[$(tab.AnalyticsListHeaderTemplate.$1_0)]);var $0=this.getElementBySelector('.tabAnalyticsListHeaderName');$0.text(name);}
tab.AuthoringTabView=function(t){tab.AuthoringTabView.initializeBase(this,[t,new tab.AuthoringTabViewTemplate()]);this.tab=t;this.dom=this.get_template();this.disposables.add(spiff.TableauClickHandler.targetAndClick(this.dom.get_domRoot()[0],ss.Delegate.create(this,this.handleClick)).onDoubleClick(ss.Delegate.create(this,this.handleDoubleClick)).onRightClick(ss.Delegate.create(this,this.handleRightClick)));this.tab.add_onTabChanged(ss.Delegate.create(this,this.$2_0));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.tab.remove_onTabChanged(ss.Delegate.create(this,this.$2_0));})));this.$2_0();}
tab.AuthoringTabView.prototype={dom:null,tab:null,get_authoringTabNavViewModel:function(){return this.tab.get_parent();},menuButtonClicked:function(buttonDom,t){var $0=t.buildMenu();spiff.ObjectRegistry.newView(spiff.MenuView,$0);$0.show(spiff.ShowMenuOptions.create(buttonDom,true));},handleRightClick:function(){this.menuButtonClicked(this.dom.get_domRoot(),this.tab);},handleClick:function(e){if(this.tab===this.get_authoringTabNavViewModel().get_currentTab()&&(tsConfig.is_mobile||tsConfig.is_touch)){this.menuButtonClicked(this.dom.get_domRoot(),this.tab);}else{this.get_authoringTabNavViewModel().selectTab(this.tab);}},handleDoubleClick:function(){this.tab.renameWithPrompt();},$2_0:function(){this.dom.label.text(this.tab.get_name());this.dom.label.attr('title',this.tab.get_name());this.dom.get_domRoot().toggleClass('tabAuthTabChecked',this.tab.get_isCurrent());}}
tab.AuthoringTabViewTemplate=function(){tab.AuthoringTabViewTemplate.initializeBase(this,[$(tab.AuthoringTabViewTemplate.template)]);this.label=this.getElementBySelector('.tabAuthTabLabel');}
tab.AuthoringTabViewTemplate.prototype={label:null}
tab.AuthoringToolbarButtonView=function(){}
tab.AuthoringToolbarToggleButtonTemplate=function(){tab.AuthoringToolbarToggleButtonTemplate.initializeBase(this);this.$2_0=$("<span class='tabAuthToolbarToggleButtonOppositeStateText' />");this.get_domRoot().append(this.$2_0);}
tab.AuthoringToolbarToggleButtonTemplate.prototype={$2_0:null,get_oppositeStateText:function(){return this.$2_0;},setOppositeStateText:function(text){this.$2_0.text(text);}}
tab.AuthoringToolbarToggleButtonView=function(viewModel){tab.AuthoringToolbarToggleButtonView.initializeBase(this,[viewModel]);this.$3_0=$("<span class='tabAuthToolbarToggleButtonOppositeStateText' />");this.get_dom().get_domRoot().append(this.$3_0);this.setOppositeStateText(viewModel.get_toggleToText());}
tab.AuthoringToolbarToggleButtonView.create=function(viewModel){return new tab.AuthoringToolbarToggleButtonView(viewModel);}
tab.AuthoringToolbarToggleButtonView.prototype={$3_0:null,get_oppositeStateText:function(){return this.$3_0;},setOppositeStateText:function(text){this.$3_0.text(text);}}
tab.AuthoringToolbarDropdownButtonView=function(viewModel){tab.AuthoringToolbarDropdownButtonView.initializeBase(this,[viewModel]);this.$3_0=viewModel;this.get_toolbarButton().add_click(ss.Delegate.create(this,this.$3_1));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.get_toolbarButton().remove_click(ss.Delegate.create(this,this.$3_1));})));}
tab.AuthoringToolbarDropdownButtonView.create=function(viewModel){return new tab.AuthoringToolbarDropdownButtonView(viewModel);}
tab.AuthoringToolbarDropdownButtonView.prototype={$3_0:null,$3_1:function(){this.$3_0.dropdownClicked(this.get_element());},onViewModelPropertyChanged:function(sender,e){if(e.get_propertyName()==='isActive'){this.setStateCss();}}}
tab.AuthoringToolbarUberPopupButtonView=function(viewModel){tab.AuthoringToolbarUberPopupButtonView.initializeBase(this,[viewModel]);this.$3_0=viewModel;this.get_toolbarButton().add_click(ss.Delegate.create(this,this.$3_2));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.get_toolbarButton().remove_click(ss.Delegate.create(this,this.$3_2));})));}
tab.AuthoringToolbarUberPopupButtonView.$3_1=function($p0){return new tab.AuthoringToolbarUberPopupButtonView($p0);}
tab.AuthoringToolbarUberPopupButtonView.prototype={$3_0:null,$3_2:function(){this.$3_0.buttonClicked(this.get_element());},onViewModelPropertyChanged:function(sender,e){if(e.get_propertyName()==='isActive'){this.setStateCss();}}}
tab.AuthoringToolbarView=function(viewModel){tab.AuthoringToolbarView.initializeBase(this,[viewModel,new tab.vqlauthoring$5()]);this.$2_1=viewModel;this.$2_0=this.get_template();this.$2_1.add_itemsChanged(ss.Delegate.create(this,function(){
this.updateToolbarButtons();}));this.updateToolbarButtons();}
tab.AuthoringToolbarView.prototype={$2_0:null,$2_1:null,updateToolbarButtons:function(){var $0=this.$2_0.get_$1_1();$0.html('');var $enum1=ss.IEnumerator.getEnumerator(this.$2_1.get_items());while($enum1.moveNext()){var $1=$enum1.current;var $2=Type.safeCast($1,tab.AuthoringToolbarToggleButtonViewModel);var $3=Type.safeCast($1,tab.AuthoringToolbarDropdownButtonViewModel);var $4=Type.safeCast($1,tab.AuthoringToolbarUberPopupButtonViewModel);if($1.get_isSeparator()){$0.append("<span class='tabAuthToolbarSeparator'/>");}else if($2!=null){var $5=tab.AuthoringToolbarToggleButtonView.create($2);$0.append($5.get_element());}else if($3!=null){var $6=tab.AuthoringToolbarDropdownButtonView.create($3);$0.append($6.get_element());}else if($4!=null){var $7=tab.AuthoringToolbarUberPopupButtonView.$3_1($4);$0.append($7.get_element());}else{var $8=tab.ToolbarButtonView.create($1);$0.append($8.get_element());}}}}
tab.vqlauthoring$5=function(){tab.vqlauthoring$5.initializeBase(this,[$("\n<div class='tabAuthToolbar'>\n    <div class='tabAuthToolbarButtonArea' />\n</div>")]);if(!tab.BrowserSupport.get_displayInlineBlock()){this.get_domRoot().addClass('noDisplayInline');}}
tab.vqlauthoring$5.prototype={get_$1_1:function(){return this.getElementBySelector('.tabAuthToolbarButtonArea');}}
tab.AuthoringView=function(authoringViewModel){this.$0=new tab.DisposableHolder();this.authoringViewModel=authoringViewModel;this.leftPanelView=spiff.ObjectRegistry.newView(tab.LeftPanelView,this.authoringViewModel.get_dataSchemaViewModel(),this.authoringViewModel.get_analyticsViewModel());this.toolbar=new tab.AuthoringToolbarView(authoringViewModel.get_toolbarViewModel());this.tabNav=spiff.ObjectRegistry.newView(tab.AuthoringTabNavView,authoringViewModel.get_authoringTabNavViewModel());if(ss.isValue(this.authoringViewModel.get_authoringMastheadViewModel())){this.authoringMastheadView=spiff.ObjectRegistry.newView(tab.AuthoringMastheadView,this.authoringViewModel.get_authoringMastheadViewModel());}this.$4();this.authoringViewModel.add_propertyChanged(ss.Delegate.create(this,this.$8));this.$0.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.authoringViewModel.remove_propertyChanged(ss.Delegate.create(this,this.$8));})));this.$0.add(spiff.EventUtil.bindWithDispose($(window),'resize',ss.Delegate.create(this,this.$9)));this.authoringViewModel.add_disposed(ss.Delegate.create(this,this.$6));this.$0.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.authoringViewModel.remove_disposed(ss.Delegate.create(this,this.$6));})));tab.ReferenceLineConstantValueEditorViewModel.add_showReferenceLineConstantValueEditor(ss.Delegate.create(this,this.$11));spiff.DragDropManager.add_dragStarted(ss.Delegate.create(this,this.$10));this.$0.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
tab.ReferenceLineConstantValueEditorViewModel.remove_showReferenceLineConstantValueEditor(ss.Delegate.create(this,this.$11));spiff.DragDropManager.remove_dragStarted(ss.Delegate.create(this,this.$10));})));}
tab.AuthoringView.get_instance=function(){return tab.AuthoringView.authoringView;}
tab.AuthoringView.prototype={cards:null,mastheadArea:null,toolbarArea:null,insideViewArea:null,leftViewArea:null,tabArea:null,leftViewResizeAffordance:null,leftPanelView:null,authoringMastheadView:null,toolbar:null,tabNav:null,authoringViewModel:null,$1:null,$2:null,$3:false,get_element:function(){return null;},get_viewModel:function(){return this.authoringViewModel;},get_leftPanel:function(){return this.leftPanelView;},$4:function(){this.cards={};this.cards['top']=[];var $enum1=ss.IEnumerator.getEnumerator(tab.AuthoringViewModel.cardLayout['top']);while($enum1.moveNext()){var $0=$enum1.current;var $enum2=ss.IEnumerator.getEnumerator($0);while($enum2.moveNext()){var $1=$enum2.current;this.cards['top'].add(spiff.ObjectRegistry.newView(tab.CardView,this.authoringViewModel.get_cards()[$1]));}}this.cards['left']=[];var $enum3=ss.IEnumerator.getEnumerator(tab.AuthoringViewModel.cardLayout['left']);while($enum3.moveNext()){var $2=$enum3.current;var $enum4=ss.IEnumerator.getEnumerator($2);while($enum4.moveNext()){var $3=$enum4.current;var $4=this.authoringViewModel.get_cards()[$3];var $5=spiff.ObjectRegistry.newView(tab.CardView,$4);this.$5($5);}}},$5:function($p0){this.cards['left'].add($p0);var $0=null;var $1=ss.Delegate.create(this,function($p1_0){
var $1_0=Type.safeCast($p1_0,tab.CardContentView);if($1_0!=null){if($0!=null){$0.dispose();$0=null;}$1_0.add_scrollContentChanged(ss.Delegate.create(this,this.$A));$0=new tab.CallOnDispose(ss.Delegate.create(this,function(){
$1_0.remove_scrollContentChanged(ss.Delegate.create(this,this.$A));}));}this.$A();});$p0.add_cardContentChanged($1);this.$0.add(new tab.CallOnDispose(function(){
$p0.remove_cardContentChanged($1);}));},$6:function($p0){this.dispose();},dispose:function(){this.$0.dispose();this.leftPanelView.dispose();this.toolbar.dispose();this.tabNav.dispose();this.$7();},buildDom:function(){this.buildAreasDom();this.addContentToAreas();this.addDomToBody();this.notifyContentAddedToDom();this.layout();if(ss.isValue(this.authoringViewModel.get_calculationEditorViewModel())){spiff.ObjectRegistry.newView(tab.CalculationDialogView,this.authoringViewModel.get_calculationEditorViewModel());}},addDomToBody:function(){var $0=$(document.body);$0.append(this.insideViewArea).append(this.toolbarArea).append(this.leftViewArea).append(this.tabArea).append(this.mastheadArea);this.leftViewArea.append(this.leftViewResizeAffordance);spiff.DragDropManager.attachDragSource(this.leftViewResizeAffordance,this);var $1=spiff.TableauClickHandler.targetAndClick(document.body,function($p1_0){
if($p1_0.currentTarget===$p1_0.target){$p1_0.stopPropagation();tab.SelectionClientCommands.clearAllSelections(tab.ModelUtils.findActiveOrDefaultVisual().get_visualId());}});$1.set_stopPropagationOnEvent(false);this.$0.add($1);},notifyContentAddedToDom:function(){this.leftPanelView.onAddedToDom();this.tabNav.onAddedToDom();var $dict1=this.cards;for(var $key2 in $dict1){var $0={key:$key2,value:$dict1[$key2]};var $enum3=ss.IEnumerator.getEnumerator($0.value);while($enum3.moveNext()){var $1=$enum3.current;$1.onAddedToDom();if($0.key==='left'&&ss.isValue($1.get_contentView())&&Type.canCast($1.get_contentView(),tab.CardContentView)){($1.get_contentView()).add_scrollContentChanged(ss.Delegate.create(this,this.$A));this.$0.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
($1.get_contentView()).remove_scrollContentChanged(ss.Delegate.create(this,this.$A));})));}}}},buildAreasDom:function(){this.mastheadArea=$("<div class='tabAuthMastheadArea'></div>");this.toolbarArea=$("<div class='tabAuthToolbarArea'></div>");this.leftViewArea=$("<div class='tabAuthLeftViewArea'></div>");this.leftViewResizeAffordance=$("<div class='tabAuthLeftViewAreaResizer'></div>");this.tabArea=$("<div class='tabAuthTabArea'></div>");this.insideViewArea=$("<div class='tabAuthVerticalChrome'></div>");},$7:function(){$('.tabAuthMastheadArea').remove();$('.tabAuthToolbarArea').remove();$('.tabAuthLeftViewArea').remove();$('.tabAuthLeftViewAreaResizer').remove();$('.tabAuthTabArea').remove();$('.tabAuthVerticalChrome').remove();},leftAreaResizerTouch:function(e){},leftAreaResizeStart:function(e){},leftAreaResizeEnd:function(e){this.leftPanelView.resizeEnd();this.authoringViewModel.updatePortSizeAfterManualLayout();},leftAreaResizeTo:function(newWidth){this.tabArea.css('left',(newWidth+2).toString()+'px');this.leftViewResizeAffordance.css('left',(newWidth-1).toString()+'px');this.leftViewArea.width(newWidth-1);this.leftPanelView.set_width(newWidth-1);},leftAreaHandleResizeDrag:function(e){this.leftAreaResizeTo(e.clientX);},leftAreaHandleAutoResize:function(e){var $0=this.leftPanelView.getMaxWidth();var $1=this.leftPanelView.getNewWidth($0);this.leftAreaResizeTo($1);this.leftAreaResizeEnd(e);},startDrag:function(e){return new spiff.MoveDragInstance(this.leftViewResizeAffordance,ss.Delegate.create(this,this.leftAreaHandleResizeDrag),ss.Delegate.create(this,this.leftAreaResizeEnd));},leftAreaWidth:function(){return this.leftPanelView.get_width();},layout:function(){var $0=tabBootstrap.ViewerBootstrap.get_instance();var $1=$0.get_authoringMastheadHeight()+$0.get_authoringToolbarHeight()+$0.get_authoringShelfHeight();var $2=$0.get_authoringShelfWidth()+this.leftAreaWidth();var $3={position:'absolute'};$3['bottom']=$0.get_authoringTabsHeight()+'px';$3['right']='0px';$3['top']=$1+'px';$3['left']=$2+'px';$3['overflow']='hidden';this.authoringViewModel.get_client().get_domNode().css($3);this.$A();this.$B();},handleClientChanged:function(){this.layout();},$8:function($p0,$p1){if($p1.get_propertyName()==='Client'){this.handleClientChanged();}},$9:function($p0){this.$1=null;this.$A();},$A:function(){this.$D();this.$3=true;_.defer(ss.Delegate.create(this,this.$C));},$B:function(){if(ss.isValue(this.authoringMastheadView)){this.authoringMastheadView.layout();}},$C:function(){if(!this.$3){return;}this.$3=false;var $0=!_.isEqual(this.$2,this.$F());if(ss.isNullOrUndefined(this.$1)||$0){this.$E();}this.$D();},$D:function(){if(ss.isNullOrUndefined(this.$1)){return;}for(var $0=0;$0<this.$1.length;$0++){var $1=this.cards['left'][$0];if(Type.canCast($1.get_contentView(),tab.CardContentView)){($1.get_contentView()).setScrollableContentActualHeight(this.$1[$0]);}}},$E:function(){var $0=$('.tabAuthLeftShelves');var $enum1=ss.IEnumerator.getEnumerator(this.cards['left']);while($enum1.moveNext()){var $B=$enum1.current;if(Type.canCast($B.get_contentView(),tab.CardContentView)){var $C=$B.get_contentView();$C.setScrollableContentActualHeight(null);}}this.$2=this.$F();var $1=$0.outerHeight(true);var $2=$0.children().outerHeight(true);if($2<=$1){return;}var $3=18;var $4=0;var $5=0;var $enum2=ss.IEnumerator.getEnumerator(this.cards['left']);while($enum2.moveNext()){var $D=$enum2.current;if($D.get_element().is(':visible')&&Type.canCast($D.get_contentView(),tab.CardContentView)){var $E=$D.get_contentView();$4+=$E.get_scrollableContentPreferredHeight();$5++;}}var $6=$2-$4;var $7=$1-$6;var $8=$7-($3*$5);this.$1=[];var $9=0;var $A=$8;while($9<this.$2.length-1){var $F=null;if(ss.isValue(this.$2[$9])){$F=$3;if($8>0){var $10=Math.floor($8*this.$2[$9]/$4);$F+=$10;$A-=$10;}}this.$1.add($F);$9++;}if(ss.isValue(this.$2[$9])){this.$1.add(($8>0)?$A+$3:$3);}else{this.$1.add(null);}},$F:function(){var $0=[];var $enum1=ss.IEnumerator.getEnumerator(this.cards['left']);while($enum1.moveNext()){var $1=$enum1.current;if($1.get_element().is(':visible')&&Type.canCast($1.get_contentView(),tab.CardContentView)){var $2=$1.get_contentView();var $3=$2.get_scrollableContentPreferredHeight();$0.add($3);}else{$0.add(null);}}return $0;},$10:function($p0){var $0=Type.safeCast($p0.get_payload(),tab.AnalyticsDropTargetViewModel);if(ss.isNullOrUndefined($0)){return;}var $1=$("<div class='tabAuthTempGlassForDropTarget' />");var $2=this.calculateDropTargetOffset();$1.css({position:'absolute',top:$2.y+'px',bottom:this.tabArea.css('height'),left:$2.x+'px',right:'0px'});this.insideViewArea.append($1);var $3=new tab.AnalyticsDropTargetView($0,$1.get(0));$3.addToDom($1);var $4=function(){
$1.remove();};$3.add_disposed($4);this.$0.add(new tab.CallOnDispose(function(){
$3.remove_disposed($4);}));},$11:function($p0){var $0=new tab.ReferenceLineConstantValueEditorView($p0,this.calculateDropTargetOffset());$0.addToDom(this.insideViewArea);}}
tab.CalculationEditorDragFeedback=function(editor){this.$5='tabTok_replace';this.$6='tabTok_noreplace';this.$8={};this.$4=editor;this.$2=$("<div class='tabEditorDropTargetPointer'></div>");this.$3=$("<div class='tabEditorDropTargetHighlighter'></div>");}
tab.CalculationEditorDragFeedback.prototype={$2:null,$3:null,$4:null,$7:0,$9:null,$A:null,get_replaceableMarkerName:function(){return this.$5;},set_replaceableMarkerName:function(value){this.$5=value;return value;},get_nonReplaceableMarkerName:function(){return this.$6;},set_nonReplaceableMarkerName:function(value){this.$6=value;return value;},get_pillDragCursorPadding:function(){return this.$7;},set_pillDragCursorPadding:function(value){this.$7=value;return value;},get_cursorIndex:function(){return this.$4.indexFromPos(this.$8);},get_cursorPosition:function(){return this.$8;},dragOver:function(d){this.switchDragFeedback(d,true);this.showDragOverFeedback();},dragExit:function(d){this.switchDragFeedback(d,false);},handleDropStateChanged:function(state){if(state===1){this.$4.execCommand('singleSelection');this.$A=$(this.$4.getWrapperElement()).find('.CodeMirror-selected');this.$9=$(this.$4.getWrapperElement()).find('.CodeMirror-lines');}else{this.switchDragFeedback(null,false);this.$A=null;this.$9=null;}},switchDragFeedback:function(d,show){if(ss.isValue(d)&&ss.isValue(d.get_dragAvatar())){d.get_dragAvatar().get_element().toggleClass('tabPillBelowCursor',show);}if(ss.isValue(this.$9)){this.$9.toggleClass('tabActiveDropTarget',show);}if(!show){this.$3.remove();this.$2.remove();this.$D(false);}},showDragOverFeedback:function(){this.$8=this.getDocumentPositionForEvent(spiff.DragDropManager.get_lastDragEvent(),this.$4.getCursor());var $0=this.$4.indexFromPos(this.$8);if(this.$B($0)){return;}if(this.$C(this.$8,$0)){return;}this.$F();},$B:function($p0){var $0=tab.CalculationEditorView.getSelectionAtIndex(this.$4,$p0);if(ss.isValue($0)){this.$2.remove();this.$3.remove();this.$D(true);return true;}this.$D(false);return false;},$C:function($p0,$p1){var $0=this.$10(this.$4.findMarksAt($p0));if(ss.isValue($0)){var $1=$0.find();var $2=this.$4.indexFromPos($1.from);var $3=this.$4.indexFromPos($1.to);if($p1>$2&&$p1<$3){if(String.equals(this.$5,$0.className,false)){this.$E($1);return true;}if(String.equals(this.$6,$0.className,false)){this.$8=($p1>($2+(($3-$2)/2)))?$1.to:$1.from;this.$F();return true;}}}return false;},$D:function($p0){if(ss.isValue(this.$A)){this.$A.toggleClass('tabActiveDropTarget',$p0);}},$E:function($p0){var $0={};if($p0.to.line>$p0.from.line){var $3=this.$4.getLine($p0.from.line);var $4=$3.length-$p0.from.ch;$0.ch=$p0.from.ch+$4;$0.line=$p0.from.line;}else{$0=$p0.to;}var $1=this.$4.charCoords($p0.from,'local');var $2=this.$4.charCoords($0,'local');this.$3.width($2.left-$1.left);this.$2.remove();this.$4.addWidget($p0.from,this.$3[0],false,'over',null);},$F:function(){this.$3.remove();this.$4.addWidget(this.$8,this.$2[0],false,'over',null);},$10:function($p0){if(ss.isNullOrUndefined($p0)){return null;}for(var $0=0,$1=$p0.length;$0<$1;$0++){var $2=$p0[$0];if(String.equals(this.$5,$2.className,false)||String.equals(this.$6,$2.className,false)){return $2;}}return null;},getDocumentPositionForEvent:function(evt,defaultPos){var $0={};$0.left=evt.pageX;$0.top=evt.pageY-this.$7;if(ss.isValue(defaultPos)&&$0.top>this.$4.heightAtLine(this.$4.lineCount(),'page')){return defaultPos;}return this.$4.coordsChar($0);}}
tab.CalcTextDragAvatar=function(text){tab.CalcTextDragAvatar.initializeBase(this,[$("\n<span class='tabCalcEditorTextDragAvatar'>\n    <div class='tabCalcEditorTextDragAvatarLabel'></div>\n</span>")]);this.set_label(text);}
tab.CalcTextDragAvatar.prototype={$1_1:null,get_viewModel:function(){return null;},get_label:function(){return this.$1_1;},set_label:function(value){this.$1_1=value;this.get_element().find('.tabCalcEditorTextDragAvatarLabel').text(this.$1_1);return value;}}
tab.CalculationAutoCompleteHelper=function(cm,viewModel){this.$4=new tab.DisposableHolder();this.$C=-1;this.$1=cm;this.$2=viewModel;this.$B=_.debounce(ss.Delegate.create(this,this.$20),100);this.$5={};this.$5['hint']=ss.Delegate.create(this,this.getHints);this.$5['completeSingle']=false;this.$5['completeOnSingleClick']=true;this.$5['alignWithWord']=false;this.$5['closeOnUnfocus']=true;var $0=(tab.BrowserSupport.get_isMac())?'Cmd-Enter':'Ctrl-Enter';var $1={};$1[$0]=function($p1_0,$p1_1){
$p1_1.pick();};this.$5['extraKeys']=$1;this.$3=new tab.Tooltip(new tab.vqlauthoring$A());this.$3.set_horizontalOffset(0);this.$3.set_showAbove(false);this.$1.on('change',ss.Delegate.create(this,this.$15));this.$1.on('cursorActivity',ss.Delegate.create(this,this.$19));this.$1.on('blur',ss.Delegate.create(this,this.$18));this.$1.on('focus',ss.Delegate.create(this,this.$17));spiff.GlobalTouchWatcher.add_firstTouch(ss.Delegate.create(this,this.$1A));this.$2.add_calculationUpdated(ss.Delegate.create(this,this.$12));}
tab.CalculationAutoCompleteHelper.prototype={$1:null,$2:null,$3:null,$5:null,$6:null,$7:null,$8:false,$9:false,$A:false,$B:null,$D:null,get_isShowingMenu:function(){return this.$8;},set_isShowingMenu:function(value){this.$8=value;return value;},get_$E:function(){if(ss.isValue(this.$3)){return this.$3.get_element()[0];}return null;},get_$F:function(){var $0=$('.CodeMirror-hints');if(ss.isValue($0)&&$0.length>0){return $0[0];}return null;},get_validFormulaTooltip:function(){return this.$D;},set_validFormulaTooltip:function(value){this.$D=value;return value;},dispose:function(){this.$9=true;this.$6=null;this.$11();this.$3.dispose();spiff.GlobalTouchWatcher.remove_firstTouch(ss.Delegate.create(this,this.$1A));this.$4.dispose();this.$2.remove_calculationUpdated(ss.Delegate.create(this,this.$12));},close:function(closeHelpTooltip){if(closeHelpTooltip){this.$10();}this.$7=null;},$10:function(){this.$3.close();this.$C=-1;},$11:function(){var $0=this.$1B();if($0!=null){$0.close();}},$12:function(){this.$13(this.get_isShowingMenu());},$13:function($p0){var $0=this.$1.getValue();var $1=this.$1.indexFromPos(this.$1.getCursor());if(this.$7!=null&&$p0&&$1>=this.$7.get_startIndex()&&$1<=this.$7.get_endIndex()&&this.$7.get_calculation()===$0){this.$10();this.$1.showHint(this.$5);}else if(this.$7!=null&&!tab.MiscUtil.isNullOrEmpty(this.$7.get_functionTooltip())){this.$14(this.$7.get_functionTooltip(),this.$7.get_functionHelpPosition());}else if(!String.isNullOrEmpty(this.$D)&&this.$2.isValidFormula()&&this.$2.get_isDirty()){this.$14(this.$D,$1);}else{this.$10();}},$14:function($p0,$p1){if(String.isNullOrEmpty($p0)){this.$10();}else{var $0=0;if($p1>=0&&ss.isValue(this.$7)){$0=tab.CalculationEditorView.getNewLineOffset(this.$7.get_calculation().toString().substr(0,$p1));}this.$C=$p1;var $1=this.$1.posFromIndex($0+this.$C);var $2=this.$1.cursorCoords($1,'page');var $3=this.$1.cursorCoords(this.$1.getCursor(),'page');var $4=this.$1.cursorCoords(this.$1.posFromIndex(0),'page').left+this.$1.getScrollInfo().left;var $5=Math.max($4,$2.left);var $6=$3.top;this.$3.show($p0,tab.$create_Point($5,$6));}},$15:function($p0,$p1){switch($p1.origin){case '+input':case '+delete':this.$1F(true);break;case 'complete':this.$1F(false);break;default:break;}},$16:function(){this.close(false);this.$1F(false);},$17:function(){this.$16();},$18:function(){this.$6=null;this.$10();},$19:function(){this.$16();},$1A:function($p0,$p1){this.close(false);},$1B:function(){var $0=this.$1.state.completionActive;return $0;},$1C:function($p0,$p1,$p2,$p3,$p4){var $0={};$0.from=$p1;$0.to=$p2;$0.text=$p0.get_replaceText();$0.displayText=(String.isNullOrEmpty($p0.get_styledLabel()))?$p0.get_label():$p0.get_styledLabel();$0.caretIndex=$p0.get_caretIndex();$0.hint=ss.Delegate.create(this,this.$1E);var $1;switch($p0.get_itemType()){case 'field':$1=new tab.vqlauthoring$8($0.displayText,$p0.get_iconResource());break;case 'func':$1=new tab.vqlauthoring$9($0.displayText);break;default:return null;}$1.$1_6($p3);$1.$1_7($p4);$1.$1_8($p0.get_tooltip());$0.render=ss.Delegate.create(this,function($p1_0,$p1_1,$p1_2){
$1.$1_9($p1_0);if(tsConfig.is_mobile){var $1_0=spiff.TableauClickHandler.target($p1_0).onClick(ss.Delegate.create(this,function($p2_0){
$p2_0.preventDefault();var $2_0=this.$1B();if($2_0!=null&&$2_0.active()&&$2_0.widget!=null){var $2_1=($p1_0.hintId||0);$2_0.widget.changeActive($2_1,true);$2_0.widget.pick();}}));this.$4.add($1_0);}});return $0;},$1D:function($p0,$p1){},$1E:function($p0,$p1,$p2){$p0.replaceRange($p2.text,$p2.from,$p2.to,'complete');$p0.setCursor($p0.posFromIndex($p2.caretIndex));},getHints:function(cm,options){if(this.$6==null||this.$7==null||this.$7.get_items().length<1){return null;}var $0={};$0.from=cm.posFromIndex(this.$7.get_startIndex());$0.to=cm.posFromIndex(this.$7.get_endIndex());CodeMirror.on($0,'select',ss.Delegate.create(this,this.$1D));CodeMirror.on($0,'shown',ss.Delegate.create(this,function(){
this.set_isShowingMenu(true);}));CodeMirror.on($0,'close',ss.Delegate.create(this,function(){
this.set_isShowingMenu(false);this.$4.dispose();}));var $1=[];var $2=false;var $3=null;var $enum1=ss.IEnumerator.getEnumerator(this.$7.get_items());while($enum1.moveNext()){var $4=$enum1.current;switch($4.get_itemType()){case 'separator':$2=true;break;case 'header':$3=$4.get_label();break;default:$1.add(this.$1C($4,$0.from,$0.to,$2,$3));$2=false;$3=null;break;}}$0.list=$1;return $0;},$1F:function($p0){this.$A=this.$A||$p0;this.$B();},$20:function(){if(this.$9){return;}var $0=new tab.vqlauthoring$2(this.$1);var $1=this.$A;this.$A=false;if(!$0.get_$2()){this.$6=null;return;}if(this.$6!=null&&$0.$1===this.$6.$1&&$0.$0===this.$6.$0){return;}this.$6=$0;this.$2.requestAutoCompleteMenu(this.$6.$0,$0.$1).done(ss.Delegate.create(this,function($p1_0){
if(!this.$9&&this.$6!=null&&this.$6.$0===$p1_0.get_calculation()){this.$7=$p1_0;this.$13($1);}})).fail(function($p1_0){
});},isEqualOrAncestorOf:function(testElement){return tab.DomUtil.isEqualOrAncestorOf(this.get_$F(),testElement)||tab.DomUtil.isEqualOrAncestorOf(this.get_$E(),testElement);}}
tab.vqlauthoring$2=function(cm){this.$0=cm.getValue();this.$1=cm.indexFromPos(cm.getCursor());}
tab.vqlauthoring$2.prototype={$0:null,$1:0,get_$2:function(){return this.$0!=null&&this.$0.length>0;}}
tab.vqlauthoring$6=function(){tab.vqlauthoring$6.initializeBase(this,[$(tab.vqlauthoring$6.$1_4)]);this.$1_3=this.getElementBySelector('.autocomplete_item');this.$1_2=this.getElementBySelector('.schema-field-icon');}
tab.vqlauthoring$6.prototype={$1_2:null,$1_3:null,$1_5:function($p0){$('<span>'+$p0+'</span>').appendTo(this.$1_3);},$1_6:function($p0){if($p0){$("<div class='autocomplete_separator'></div>").insertBefore(this.$1_3);}},$1_7:function($p0){if(!String.isNullOrEmpty($p0)){var $0=$("<div class='autocomplete_header'></div>");$0.text($p0);$0.insertBefore(this.$1_3);}},$1_8:function($p0){if(!String.isNullOrEmpty($p0)){this.$1_3.attr('title',$p0);}},$1_9:function($p0){this.get_domRoot().appendTo($p0);}}
tab.vqlauthoring$8=function(text,iconRes){tab.vqlauthoring$8.initializeBase(this);this.$1_3.addClass('autocomplete_field');this.$1_5(text);if(iconRes.length>0){this.$1_2.addClass(String.format('tab-schema-{0}-icon',iconRes));}}
tab.vqlauthoring$9=function(text){tab.vqlauthoring$9.initializeBase(this);this.$1_3.addClass('autocomplete_func');this.$1_5(text);this.$1_2.addClass('autocomplete-menu-function');}
tab.vqlauthoring$A=function(){tab.vqlauthoring$A.initializeBase(this);this.get_domRoot().addClass('tabCalcFunctionHelp');}
tab.CalculationEditorView=function(viewModel,template){this.$2_8=[];tab.CalculationEditorView.initializeBase(this,[viewModel,template]);this.$2_3=this.get_template();this.calcViewModel=viewModel;this.calcViewModel.add_calculationUpdated(ss.Delegate.create(this,this.updateDomFromModel));this.calcViewModel.add_calculationEdited(ss.Delegate.create(this,this.onCalculationEdited));this.calcViewModel.add_dropStateChanged(ss.Delegate.create(this,this.handleDropStateChanged));this.calcViewModel.add_calculationCanceled(ss.Delegate.create(this,this.onCalculationCanceled));this.calcViewModel.add_dropCommandCompleted(ss.Delegate.create(this,this.$2_B));this.calcViewModel.add_insertFunctionCompleted(ss.Delegate.create(this,this.$2_C));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.calcViewModel.remove_calculationUpdated(ss.Delegate.create(this,this.updateDomFromModel));this.calcViewModel.remove_calculationEdited(ss.Delegate.create(this,this.onCalculationEdited));this.calcViewModel.remove_dropStateChanged(ss.Delegate.create(this,this.handleDropStateChanged));this.calcViewModel.remove_calculationCanceled(ss.Delegate.create(this,this.onCalculationCanceled));this.calcViewModel.remove_dropCommandCompleted(ss.Delegate.create(this,this.$2_B));this.calcViewModel.remove_insertFunctionCompleted(ss.Delegate.create(this,this.$2_C));})));spiff.DragDropManager.attachDropTarget(this.$2_3.get_dropTarget(),this);spiff.DragDropManager.attachDragSource(this.$2_3.get_dragSource(),this);}
tab.CalculationEditorView.markStyleAndErrorForTokens=function(editor,vm){var $0=vm.get_formula();var $1={};var $2=0;var $3=[];var $enum1=ss.IEnumerator.getEnumerator(vm.get_tokens());while($enum1.moveNext()){var $4=$enum1.current;var $5=editor.posFromIndex($4.ye+$2);var $enum2=ss.IEnumerator.getEnumerator(vm.get_errors());while($enum2.moveNext()){var $9=$enum2.current;if(($9.yc+$9.yd)<=$4.ye||$9.yc>=($4.ye+$4.yf)){continue;}var $A=editor.posFromIndex($9.yc+$2);var $B=editor.posFromIndex($9.yc+$9.yd+$2);var $C={};$C.className=tab.CalculationEditorView.$2_1;$C.title=$9.oz;$3.add(editor.markText($A,$B,$C));}$2-=tab.CalculationEditorView.getNewLineOffset($0.substr($4.ye,$4.yf));var $6=editor.posFromIndex($4.ye+$4.yf+$2);var $7=editor.getRange($5,$6);var $8=$7.length-$7.trimStart().length;if($8>0){$1.className=tab.CalculationEditorView.$2_2;var $D=editor.posFromIndex($4.ye+$8+$2);$3.add(editor.markText($5,$D,$1));$5=$D;}if($8<$7.length){$1.className='tabTok_'+$4.aya;$3.add(editor.markText($5,$6,$1));var $E=tab.CalculationEditorView.$2_E($4,$7);if(ss.isValue($E)){$1.className=$E;$3.add(editor.markText($5,$6,$1));}}}return $3;}
tab.CalculationEditorView.getNewLineOffset=function(s,pos){var $0=0;var $1=0;var $2=0;var $3=function($p1_0){
return !ss.isValue(pos)||$p1_0<pos.line;};while($3($0)&&($1=s.indexOf('\n',$1))>=0){if($1>=1&&s.charAt($1-1)==='\r'){$2++;}$0++;$1++;}return $2;}
tab.CalculationEditorView.$2_9=function($p0){return ($p0.indexOf('\r\n')>=0)?'\r\n':'\n';}
tab.CalculationEditorView.$2_E=function($p0,$p1){if($p1.length<=1){return null;}switch($p0.aya){case 'style_prim_field':case 'style_sec_field':case 'style_invalid_field':case 'style_param':return 'tabTok_replace';case 'style_remote_func':case 'style_local_func':case 'style_comment':case 'style_default':return 'tabTok_noreplace';}return null;}
tab.CalculationEditorView.getTextSelectionUnderMouse=function(editor,e){var $0={};$0.left=e.pageX;$0.top=e.pageY;var $1=editor.coordsChar($0);var $2=editor.indexFromPos($1);return tab.CalculationEditorView.getSelectionAtIndex(editor,$2);}
tab.CalculationEditorView.getSelectionAtIndex=function(editor,charIndex){var $0=editor.listSelections();for(var $1=0,$2=$0.length;$1<$2;$1++){var $3=tab.CalculationEditorView.$2_F(editor,$0[$1]);if(ss.isValue($3)&&charIndex>$3.yi&&charIndex<$3.yj){return $3;}}return null;}
tab.CalculationEditorView.getSelection=function(editor){var $0=editor.listSelections();if(ss.isValue($0)&&$0.length>0){return tab.CalculationEditorView.$2_F(editor,$0[0]);}return null;}
tab.CalculationEditorView.$2_F=function($p0,$p1){if(ss.isNullOrUndefined($p1)||ss.isNullOrUndefined($p0)){return null;}var $0=$p0.indexFromPos($p1.anchor);var $1=$p0.indexFromPos($p1.head);if($0===$1){return null;}var $2={};$2.yi=Math.min($0,$1);$2.yj=Math.max($0,$1);return $2;}
tab.CalculationEditorView.prototype={calcViewModel:null,$2_3:null,$2_4:null,$2_5:null,$2_6:'\r\n',$2_7:null,get_hasEditor:function(){return ss.isValue(this.$2_4);},get_editor:function(){return this.$2_4;},get_dom:function(){return this.$2_3;},get_pillViewModel:function(){return null;},set_pillViewModel:function(value){return value;},get_feedbackType:function(){return 'dropfeedbackmousemove';},get_pillDragFeedback:function(){return this.$2_5;},get_autoCompleteHelper:function(){return this.$2_7;},createCodeMirrorOptions:function(){var $0={};$0.indentUnit=2;$0.indentWithTabs=false;$0.lineNumbers=false;$0.lineWrapping=false;$0.smartIndent=false;$0.dragDrop=true;$0.extraKeys={};$0.extraKeys[(tab.BrowserSupport.get_isMac())?'Cmd-Enter':'Ctrl-Enter']=ss.Delegate.create(this,this.$2_A);this.addExtraKeys($0.extraKeys);return $0;},addExtraKeys:function(extraKeys){},initDom:function(){if(ss.isValue(this.$2_4)){return;}this.$2_4=CodeMirror(this.get_dom().get_formulaEditorHolder()[0],this.createCodeMirrorOptions());this.$2_4.on('change',ss.Delegate.create(this,this.$2_D));this.$2_4.on('dragstart',ss.Delegate.create(this,this.onDragStart));this.$2_5=new tab.CalculationEditorDragFeedback(this.$2_4);this.$2_7=new tab.CalculationAutoCompleteHelper(this.$2_4,this.calcViewModel);this.disposables.add(this.$2_7);if(this.calcViewModel.get_hasCalculation()){this.onCalculationEdited();}},onAddedToDom:function(){tab.CalculationEditorView.callBaseMethod(this, 'onAddedToDom');if(this.get_hasEditor()){this.$2_4.refresh();}},focusEditor:function(){if(this.$2_4.hasFocus()){return;}this.$2_4.focus();},$2_A:function(){this.calcViewModel.applyCalculation(this.get_pillViewModel(),false);},onDragStart:function(cm,e){if(tab.BrowserSupport.get_isIE()&&tab.BrowserSupport.get_browserVersion()<9){e.returnValue=false;}else{e.preventDefault();}},updateDomFromModel:function(){this.$2_6=tab.CalculationEditorView.$2_9(this.calcViewModel.get_formula());var $0=this.$2_4.getValue(this.$2_6)!==this.calcViewModel.get_formula();if($0){var $1=this.$2_4.getCursor();this.$2_4.setValue(this.calcViewModel.get_formula());this.$2_4.setCursor($1);}var $enum1=ss.IEnumerator.getEnumerator(this.$2_8);while($enum1.moveNext()){var $2=$enum1.current;$2.clear();}this.$2_8=tab.CalculationEditorView.markStyleAndErrorForTokens(this.$2_4,this.calcViewModel);},$2_B:function($p0){if($p0>=0){var $0=tab.CalculationEditorView.getNewLineOffset(this.calcViewModel.get_formula().substr(0,$p0));var $1=this.$2_4.posFromIndex($p0-$0);this.$2_4.setCursor($1);this.focusEditor();}},$2_C:function($p0,$p1){this.get_editor().setValue($p0);this.$2_B($p1);},onCalculationCanceled:function(){if(ss.isValue(this.get_autoCompleteHelper())){this.get_autoCompleteHelper().close(true);}},onCalculationEdited:function(){this.updateDomFromModel();this.$2_4.clearHistory();this.$2_4.execCommand('goDocEnd');},$2_D:function($p0,$p1){this.calcViewModel.set_formula($p0.getValue(this.$2_6));},handleDropStateChanged:function(state){this.get_dom().get_dropInviteBorder().toggleClass('tabDropInvited',state===1);this.$2_5.handleDropStateChanged(state);},dragOver:function(d){if(!tab.CalculationEditorViewModel.canAccept(d)){return null;}this.$2_5.dragOver(d);return this;},dragExit:function(d){this.$2_5.dragExit(d);},acceptDrop:function(d){this.$2_5.dragExit(d);var $0=this.$2_5.get_cursorIndex()+tab.CalculationEditorView.getNewLineOffset(this.calcViewModel.get_formula(),this.$2_5.get_cursorPosition());return this.calcViewModel.handleDrop(d,$0,tab.CalculationEditorView.getSelectionAtIndex(this.$2_4,$0));},getDropTarget:function(hit){return this;},startDrag:function(e){var $0=tab.CalculationEditorView.getTextSelectionUnderMouse(this.$2_4,e);if(ss.isNullOrUndefined($0)){return null;}var $1=this.$2_4.posFromIndex($0.yi);var $2=this.$2_4.posFromIndex($0.yj);return this.calcViewModel.getDragInstanceForText(this.$2_4.getRange($1,$2));},isEqualOrAncestorOf:function(testElement){if(tab.DomUtil.isEqualOrAncestorOf(this.get_element()[0],testElement)){return true;}if(ss.isValue(this.get_autoCompleteHelper())){return this.get_autoCompleteHelper().isEqualOrAncestorOf(testElement);}return false;}}
tab.CalculationEditorTemplate=function(root){tab.CalculationEditorTemplate.initializeBase(this,[root]);}
tab.CardContentView=function(viewModel,template){tab.CardContentView.initializeBase(this,[viewModel,template]);}
tab.CardContentView.prototype={add_scrollContentChanged:function(value){this.$2_0=ss.Delegate.combine(this.$2_0,value);},remove_scrollContentChanged:function(value){this.$2_0=ss.Delegate.remove(this.$2_0,value);},$2_0:null,raiseScrollContentChanged:function(){if(ss.isValue(this.$2_0)){this.$2_0();}}}
tab.CardView=function(viewModel,t){tab.CardView.initializeBase(this,[viewModel,t]);this.dom=t;this.$2_0=viewModel;this.$2_0.add_cardChanged(ss.Delegate.create(this,this.$2_9));this.$2_0.add_collapsedChanged(ss.Delegate.create(this,this.$2_4));this.$2_0.add_contentDropStateChanged(ss.Delegate.create(this,this.$2_3));this.disposables.add(spiff.ClickHandler.targetAndClick(this.dom.expandoTarget,ss.Delegate.create(this,this.$2_5)));this.$2_9(this.$2_0);if(Type.getInstanceType(this.$2_0.get_content())===tab.ShelfViewModel){spiff.DragDropManager.attachDropTarget(this.dom.dropTarget,this.$2_0.get_content());}this.dom.get_domRoot().addClass('tabAuthCardType-'+viewModel.get_content().get_name());}
tab.CardView.prototype={dom:null,$2_0:null,$2_1:null,add_cardContentChanged:function(value){this.$2_2=ss.Delegate.combine(this.$2_2,value);},remove_cardContentChanged:function(value){this.$2_2=ss.Delegate.remove(this.$2_2,value);},$2_2:null,get_contentView:function(){return this.$2_1;},dispose:function(){if(ss.isValue(this.$2_0)){this.$2_0.remove_cardChanged(ss.Delegate.create(this,this.$2_9));this.$2_0.remove_collapsedChanged(ss.Delegate.create(this,this.$2_4));this.$2_0.remove_contentDropStateChanged(ss.Delegate.create(this,this.$2_3));}tab.CardView.callBaseMethod(this, 'dispose');},onAddedToDom:function(){if(ss.isValue(this.$2_1)&&Type.canCast(this.$2_1,spiff.BaseView)){(this.$2_1).onAddedToDom();}tab.CardView.callBaseMethod(this, 'onAddedToDom');},$2_3:function($p0){var $0=false;var $1=false;switch($p0){case 1:$0=true;break;case 2:$1=true;break;}this.get_element().toggleClass('tabAuthCardDropInvited',$0);this.get_element().toggleClass('tabAuthCardDropNotValid',$1);},$2_4:function($p0){if($p0.get_isCollapsed()){this.dom.content.slideUp();}else{this.dom.content.slideDown();}this.$2_6();this.$2_7();},$2_5:function($p0){this.$2_0.toggleExpanded();},$2_6:function(){this.dom.expando.toggleClass('Closed',this.$2_0.get_isCollapsed());this.dom.expando.toggleClass('Open',!this.$2_0.get_isCollapsed());},$2_7:function(){var $0='';if(ss.isValue(this.$2_0.get_content())){$0=this.$2_0.get_content().get_title();if(this.$2_0.get_isCollapsed()&&!tab.MiscUtil.isNullOrEmpty(this.$2_0.get_content().get_collapsedTitleDetail())){$0=tab.Strings.AuthCardCollapsedTitle($0,this.$2_0.get_content().get_collapsedTitleDetail());}}this.dom.label.html($0);},$2_8:function(){if(this.$2_0.get_hasIcon()){this.dom.icon.addClass(this.$2_0.get_iconClass());}},$2_9:function($p0){if(this.$2_0.get_isVisible()){this.dom.get_domRoot().show();}else{this.dom.get_domRoot().hide();}var $0=!$p0.get_orientation();this.dom.get_domRoot().toggleClass('tabAuthCardVertical',$0);this.dom.get_domRoot().toggleClass('tabAuthCardHorizontal',!$0);this.$2_6();if(this.$2_0.get_isCollapsible()){this.dom.expando.show();}else{this.dom.expando.hide();}this.$2_8();this.$2_7();var $enum1=ss.IEnumerator.getEnumerator(spiff.Widget.getWidgets(this.dom.content.children()));while($enum1.moveNext()){var $1=$enum1.current;$1.dispose();}if(ss.isValue($p0.get_content())){if(ss.isValue(this.$2_1)){(this.$2_1).dispose();}this.$2_1=spiff.ObjectRegistry.newView($p0.get_content().get_viewType(),$p0.get_content().get_viewModel());this.dom.content.append(this.$2_1.get_element());if(this.get_addedToDom()&&Type.canCast(this.$2_1,spiff.Widget)){(this.$2_1).onAddedToDom();}if(ss.isValue(this.$2_2)){this.$2_2(this.$2_1);}}}}
tab.CardViewTemplate=function(){tab.CardViewTemplate.initializeBase(this,[$(tab.CardViewTemplate.template)]);this.icon=this.getElementBySelector('.tabAuthCardIcon');this.label=this.getElementBySelector('.tabAuthCardLabel');this.content=this.getElementBySelector('.tabAuthCardContent');this.expando=this.getElementBySelector('.tabAuthCardExpando');this.expandoTarget=this.getElementBySelector('.tabAuthCardExpandoTarget');this.dropTarget=this.get_domRoot();}
tab.CardViewTemplate.prototype={icon:null,label:null,content:null,expando:null,expandoTarget:null,dropTarget:null}
tab.CalculationDependencyView=function(viewModel){tab.CalculationDependencyView.initializeBase(this,[viewModel,spiff.Template.fromHtml("<div class='tabCalcDependencyContent'>\n            <div class='tabCalcDependencyPrefix'></div>\n            <div class='tabCalcDependencyInfo'></div>\n        </div>")]);this.get_template().getElementBySelector('.tabCalcDependencyPrefix').text(tab.Strings.CalcEditorDependenciesPrefix);this.get_template().getElementBySelector('.tabCalcDependencyInfo').text(viewModel.get_dependencies());}
tab.CalculationDependencyView.prototype={get_dependencyViewModel:function(){return this.get_viewModel();},onAddedToDom:function(){tab.CalculationDependencyView.callBaseMethod(this, 'onAddedToDom');this.get_element().parents('.tabUberPopup').css('max-width',this.get_dependencyViewModel().get_maxWidth()+'px').addClass('tabCalcEditorDependsPopup');}}
tab.LeftPanelView=function(dataSchemaViewModel,analyticsPaneViewModel){this.leftAreaMinWidth=(!!tab.FeatureParamsLookup.getBool(tab.FeatureParam.collapseSidePane))?160:115;this.$2_0=new tab.DisposableHolder();tab.LeftPanelView.initializeBase(this,[dataSchemaViewModel,new tab.LeftPanelTemplate()]);this.dom=this.get_template();this.dataSchema=spiff.ObjectRegistry.newView(tab.DataSchemaView,dataSchemaViewModel);if(tsConfig.features['AnalyticsPane']&&!!tab.FeatureParamsLookup.getBool(tab.FeatureParam.aoPaneUI)){this.analyticsPane=spiff.ObjectRegistry.newView(tab.AnalyticsPaneView,analyticsPaneViewModel);}}
tab.LeftPanelView.prototype={leftAreaDefaultWidth:170,leftAreaResizerWidth:2,leftAreaMaxWidth:500,dataSchema:null,analyticsPane:null,dom:null,get_dataSchemaView:function(){return this.dataSchema;},get_analyticsPaneView:function(){return this.analyticsPane;},get_width:function(){return this.get_dataSchemaView().get_width();},set_width:function(value){this.get_dataSchemaView().set_width(value);return value;},onAddedToDom:function(){tab.LeftPanelView.callBaseMethod(this, 'onAddedToDom');if(ss.isValue(this.get_dataSchemaView())){this.get_dataSchemaView().onAddedToDom();}if(ss.isValue(this.get_analyticsPaneView())){this.get_analyticsPaneView().onAddedToDom();}},dispose:function(){this.$2_0.dispose();if(ss.isValue(this.get_dataSchemaView())){this.get_dataSchemaView().dispose();}if(tsConfig.features['AnalyticsPane']&&ss.isValue(this.get_analyticsPaneView())&&!!tab.FeatureParamsLookup.getBool(tab.FeatureParam.aoPaneUI)){this.get_analyticsPaneView().dispose();}this.dom.dispose();tab.LeftPanelView.callBaseMethod(this, 'dispose');},resizeEnd:function(){(this.get_dataSchemaView().get_viewModel()).set_specifiedWidth(this.get_dataSchemaView().get_width());},getMaxWidth:function(){return Math.min(this.get_dataSchemaView().get_maxDesiredWidth(),this.leftAreaMaxWidth);},getNewWidth:function(maxWidth){return (this.get_dataSchemaView().get_width()+this.leftAreaResizerWidth<maxWidth)?maxWidth:this.leftAreaDefaultWidth;},getBracketWidth:function(width){return Math.max(this.leftAreaMinWidth,Math.min(this.leftAreaMaxWidth,width));}}
tab.LeftPanelTemplate=function(){tab.LeftPanelTemplate.initializeBase(this,[$("\n            <div class='tabAuthLeftPanel'>\n            </div>")]);}
tab.ColorOptionView=function(viewModel,template){tab.ColorOptionView.initializeBase(this,[viewModel,template]);this.colorOptionViewModel=viewModel;this.colorOptionViewModel.add_commitChanges(ss.Delegate.create(this,this.commitChangesInView));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.colorOptionViewModel.remove_commitChanges(ss.Delegate.create(this,this.commitChangesInView));})));}
tab.ColorOptionView.prototype={colorOptionViewModel:null}
tab.ColorPickerView=function(viewModel,t){tab.ColorPickerView.initializeBase(this,[viewModel,t]);this.dom=t;this.colorPickerViewModel=viewModel;}
tab.ColorPickerView.prototype={dom:null,colorPickerViewModel:null,$2_4:null,$2_5:null,$2_6:null,get_colorTransparencyControlView:function(){return this.$2_4;},set_colorTransparencyControlView:function(value){this.$2_4=value;return value;},get_linePatternPickerView:function(){return this.$2_5;},set_linePatternPickerView:function(value){this.$2_5=value;return value;},get_strokeWidthPickerView:function(){return this.$2_6;},set_strokeWidthPickerView:function(value){this.$2_6=value;return value;},onViewModelPropertyChanged:function(sender,e){this.updateContent();},updateContent:function(){this.dom.removeAllColors();this.$2_7();},$2_7:function(){this.$2_8(this.colorPickerViewModel.get_blackAndWhiteColors()[0],$('<span/>').addClass('tabColorPickerGroup').appendTo(this.dom.black));this.$2_9(this.colorPickerViewModel.get_darkGrayColors(),this.dom.darkGrays,this.colorPickerViewModel.get_darkGrayColors().length);this.$2_8(this.colorPickerViewModel.get_blackAndWhiteColors()[1],$('<span/>').addClass('tabColorPickerGroup').appendTo(this.dom.white));this.$2_9(this.colorPickerViewModel.get_lightGrayColors(),this.dom.lightGrays,this.colorPickerViewModel.get_lightGrayColors().length);this.$2_9(this.colorPickerViewModel.get_presetColors1(),this.dom.preset1,3);this.$2_9(this.colorPickerViewModel.get_presetColors2(),this.dom.preset2,3);},$2_8:function($p0,$p1){spiff.ClickHandler.targetAndClick($('<div/>').addClass('tabColorPickerColor').toggleClass('tabColorSelected',$p0.equals(this.colorPickerViewModel.get_selectedColor())).css('background-color',$p0.toRgb()).append($('<div/>').addClass('tabColorPickerColorBorder')).appendTo($p1),this.$2_A($p0));},$2_9:function($p0,$p1,$p2){var $0=null;for(var $1=0;$1<$p0.length;$1++){if(!($1%$p2)){$0=$('<span/>').addClass('tabColorPickerGroup').appendTo($p1);}this.$2_8($p0[$1],$0);}},$2_A:function($p0){return ss.Delegate.create(this,function(){
this.colorPickerViewModel.set_selectedColor($p0);});},onAddedToDom:function(){tab.ColorPickerView.callBaseMethod(this, 'onAddedToDom');if(ss.isValue(this.get_colorTransparencyControlView())){this.get_colorTransparencyControlView().addToDom(this.dom.addColorTransparencyControlContainer());}if(ss.isValue(this.get_linePatternPickerView())){this.get_linePatternPickerView().addToDom(this.dom.addLinePatternPickerContainer());}if(ss.isValue(this.get_strokeWidthPickerView())){this.get_strokeWidthPickerView().addToDom(this.dom.addStrokeWidthPickerContainer());}}}
tab.ColorPickerTemplate=function(){tab.ColorPickerTemplate.initializeBase(this,[$("<div class='tabColorPicker'>\n                <div class='tabColorPickerContainer'>\n                    <div class='tabColorPickerBlack'/>\n                    <div class='tabColorPickerDarkGrays'/>\n                    <div class='tabColorPickerWhite'/>\n                    <div class='tabColorPickerLightGrays'/>\n                    <div class='tabColorPickerPreset1'/>\n                    <div class='tabColorPickerPreset2'/>\n                </div>\n            </div>")]);this.black=this.getElementBySelector('.tabColorPickerBlack');this.white=this.getElementBySelector('.tabColorPickerWhite');this.darkGrays=this.getElementBySelector('.tabColorPickerDarkGrays');this.lightGrays=this.getElementBySelector('.tabColorPickerLightGrays');this.preset1=this.getElementBySelector('.tabColorPickerPreset1');this.preset2=this.getElementBySelector('.tabColorPickerPreset2');this.$1_5=this.getElementBySelector('.tabColorPickerContainer');}
tab.ColorPickerTemplate.prototype={black:null,darkGrays:null,white:null,lightGrays:null,preset1:null,preset2:null,$1_5:null,addColorTransparencyControlContainer:function(){return $("<div class='tabAuthTransparencyControlContainer'/>").appendTo(this.$1_5);},addLinePatternPickerContainer:function(){var $0=$("<div class='tabLinePatternPickerContainer'/>").insertBefore(this.$1_5);$("<div class='tabAuthDivider'/>").insertBefore(this.$1_5);return $0;},addStrokeWidthPickerContainer:function(){var $0=$("<div class='tabStrokeWidthPickerContainer'/>").insertBefore(this.$1_5);$("<div class='tabAuthDivider'/>").insertBefore(this.$1_5);return $0;},removeAllColors:function(){this.black.children().remove();this.darkGrays.children().remove();this.white.children().remove();this.lightGrays.children().remove();this.preset1.children().remove();this.preset2.children().remove();}}
tab.MarkSizePickerView=function(viewModel){tab.MarkSizePickerView.initializeBase(this,[viewModel,spiff.Template.fromHtml("<div class='tabAuthMarkSizePickerContent'><span class='tabAuthMarkSizeLabel'></span></div>")]);this.markSizePickerViewModel=viewModel;this.markSizePickerViewModel.add_modelUpdated(ss.Delegate.create(this,this.$2_0));this.sliderViewModel=new tab.ContinuousSliderViewModel(this.markSizePickerViewModel.get_markSize());this.sliderViewModel.add_propertyChanged(ss.Delegate.create(this,this.handleSliderPropertyChange));this.sliderViewModel.add_sliderValueChange(ss.Delegate.create(this,this.sliderValueChanged));this.sliderViewModel.set_sliderClassName('tabAuthMarkSizeSlider');this.get_template().getElementBySelector('.tabAuthMarkSizeLabel').text(tab.Strings.AuthMarkSizeLabel);this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.markSizePickerViewModel.remove_modelUpdated(ss.Delegate.create(this,this.$2_0));this.sliderViewModel.remove_propertyChanged(ss.Delegate.create(this,this.handleSliderPropertyChange));this.sliderViewModel.remove_sliderValueChange(ss.Delegate.create(this,this.sliderValueChanged));})));this.disposables.add(this.sliderViewModel);}
tab.MarkSizePickerView.prototype={markSizePickerViewModel:null,sliderViewModel:null,handleSliderPropertyChange:function(sender,args){this.markSizePickerViewModel.set_currentFraction(this.sliderViewModel.get_currentFraction());},$2_0:function($p0){this.sliderViewModel.set_currentFraction($p0.get_currentFraction());},onViewModelPropertyChanged:function(sender,e){this.sliderViewModel.set_currentFraction(this.markSizePickerViewModel.get_currentFraction());},sliderValueChanged:function(newValue){this.markSizePickerViewModel.set_currentFraction(newValue);}}
tab.LayerEncodingView=function(viewModel,t){tab.LayerEncodingView.initializeBase(this,[viewModel,t]);this.dom=t;this.leViewModel=viewModel;this.leViewModel.add_modelChanged(ss.Delegate.create(this,this.$2_5));this.leViewModel.add_dragOverEncodingChanged(ss.Delegate.create(this,this.$2_9));this.leViewModel.add_validDropEncodingsChanged(ss.Delegate.create(this,this.$2_8));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.leViewModel.remove_modelChanged(ss.Delegate.create(this,this.$2_5));this.leViewModel.remove_dragOverEncodingChanged(ss.Delegate.create(this,this.$2_9));this.leViewModel.remove_validDropEncodingsChanged(ss.Delegate.create(this,this.$2_8));})));this.$2_2=new tab.ComboBoxViewModel();this.$2_2.add_selectedItemChanged(ss.Delegate.create(this,this.$2_7));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$2_2.remove_selectedItemChanged(ss.Delegate.create(this,this.$2_7));this.$2_2.dispose();})));this.leViewModel.get_encodingShelf().add_shelfChanged(ss.Delegate.create(this,this.$2_4));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.leViewModel.get_encodingShelf().remove_shelfChanged(ss.Delegate.create(this,this.$2_4));})));this.dom.primitives.append(spiff.ObjectRegistry.newView(tab.ComboBoxView,this.$2_2).get_element());this.$2_3=spiff.ObjectRegistry.newView(tab.ShelfView,this.leViewModel.get_encodingShelf());this.disposables.add(this.$2_3);this.dom.encodingShelf.append(this.$2_3.get_element());if(this.get_addedToDom()){this.$2_3.onAddedToDom();}}
tab.LayerEncodingView.prototype={leViewModel:null,dom:null,$2_2:null,$2_3:null,onAddedToDom:function(){tab.LayerEncodingView.callBaseMethod(this, 'onAddedToDom');if(ss.isValue(this.$2_3)){this.$2_3.onAddedToDom();}},update:function(){this.removeEncodingButtonEvents();this.dom.encodingButtonsRow0.children().remove();this.dom.encodingButtonsRow1.children().remove();this.$2_2.clearItems();if(ss.isValue(this.leViewModel.get_layerEncoding())){var $1=null;var $enum1=ss.IEnumerator.getEnumerator(this.leViewModel.get_layerEncoding().get_primitiveTypes());while($enum1.moveNext()){var $2=$enum1.current;var $3=new tab.ComboBoxItem(tab.IconUtils.getPrimitiveTypeIcon($2),$2.mb,$2,null);this.$2_2.addItem($3);if($2.ao){$1=$3;}}this.$2_2.set_selectedItem($1);}var $0=(ss.isValue(this.leViewModel.get_layerEncoding())&&ss.isValue(this.leViewModel.get_layerEncoding().get_encodings()))?this.leViewModel.get_layerEncoding().get_encodings():[];$0=_.sortBy($0,function($p1_0){
if(Object.keyExists(tab.LayerEncodingView.$2_1,$p1_0.ahq)){return tab.LayerEncodingView.$2_1[$p1_0.ahq];}return $0.length;});for(var $4=0;$4<6;$4++){var $5;if($0.length>$4){var $6=new tab.EncodingTypeButtonTemplate();$6.get_domRoot().addClass('tabAuthEncodingButtonType-'+$0[$4].ahq);$6.name.text($0[$4].mb);switch($0[$4].ahq){case 'text-encoding':case 'size-encoding':case 'color-encoding':case 'shape-encoding':case 'sort-encoding':case 'wedge-size-encoding':$6.icon.addClass(tab.IconUtils.getEncodingTypeIcon($0[$4].ahq));break;default:$6.get_domRoot().addClass('tabAuthEncodingButtonNoIcon');break;}spiff.DragDropManager.attachDropTarget($6.get_domRoot(),this.leViewModel.createEncodingButtonDropTarget($0[$4].ahq));$6.get_domRoot().data('tabAuthEncodingType',$0[$4].ahq);$5=$6.get_domRoot();var $7=new spiff.Button($6.get_domRoot());$7.set_hoverTooltipText(this.leViewModel.getEncodingTypeTooltip($0[$4].ahq));$7.add_click(this.$2_6($0[$4].ahq,$6.button));this.attachEventHandlers($7,$0[$4].ahq);}else{$5=$("<span class='tabAuthEncodingButtonArea'><span class='tabAuthEmptyEncodingButton' /></span>");}(($4<3)?this.dom.encodingButtonsRow0:this.dom.encodingButtonsRow1).append($5);}this.$2_8(this.leViewModel.get_validDropEncodings());},$2_4:function($p0){this.update();},$2_5:function($p0){this.update();},$2_6:function($p0,$p1){return ss.Delegate.create(this,function(){
this.leViewModel.encodingTypeClicked($p0,$p1);});},$2_7:function($p0){if(ss.isNullOrUndefined($p0)){return;}var $0=$p0.get_data();if($0.ao){return;}this.leViewModel.updatePrimitive($0);},$2_8:function($p0){if(ss.isNullOrUndefined($p0)){this.dom.get_encodingButtons().toggleClass('tabDropInvalid',false).toggleClass('tabDropInvited',false);}else{this.dom.get_encodingButtons().each(function($p1_0,$p1_1){
var $1_0=$($p1_1);var $1_1=$1_0.data('tabAuthEncodingType');var $1_2=$p0.contains($1_1);$1_0.toggleClass('tabDropInvalid',!$1_2).toggleClass('tabDropInvited',$1_2);});}},$2_9:function($p0){this.dom.get_encodingButtons().each(function($p1_0,$p1_1){
var $1_0=$($p1_1);$1_0.toggleClass('tabDragOver',$1_0.data('tabAuthEncodingType')===$p0);});}}
tab.LayerEncodingTemplate=function(){tab.LayerEncodingTemplate.initializeBase(this,[$("<div class='tabAuthLayerEncoding'>\n    <div class='tabAuthLayerEncodingPrimitives'/>\n    <div class='tabAuthLayerEncodingButtonRow' />\n<div class='tabAuthLayerEncodingButtonRow' />\n<div class='tabAuthLayerEncodingShelf' />\n</div>")]);this.primitives=this.getElementBySelector('.tabAuthLayerEncodingPrimitives');this.encodingButtonsRow0=this.getElementsBySelector('.tabAuthLayerEncodingButtonRow').first();this.encodingButtonsRow1=this.getElementsBySelector('.tabAuthLayerEncodingButtonRow').slice(1);this.encodingShelf=this.getElementsBySelector('.tabAuthLayerEncodingShelf');}
tab.LayerEncodingTemplate.prototype={encodingButtonsRow0:null,encodingButtonsRow1:null,encodingShelf:null,primitives:null,get_encodingButtons:function(){return this.getElementsBySelector('.tabAuthEncodingButtonArea');}}
tab.EncodingTypeButtonTemplate=function(){tab.EncodingTypeButtonTemplate.initializeBase(this,[$("<span class='tabAuthEncodingButtonArea'><span class='tabAuthEncodingButton'><div class='tabAuthEncodingButtonName'/><div class='tabAuthEncodingButtonIcon'/></span></span>")]);this.button=this.getElementBySelector('.tabAuthEncodingButton');this.name=this.getElementBySelector('.tabAuthEncodingButtonName');this.icon=this.getElementBySelector('.tabAuthEncodingButtonIcon');}
tab.EncodingTypeButtonTemplate.prototype={name:null,icon:null,button:null}
tab.MarksContentView=function(viewModel,t){tab.MarksContentView.initializeBase(this,[viewModel,t]);this.$2_2=viewModel;this.$2_2.add_layersChanged(ss.Delegate.create(this,this.handleLayersChanged));this.$2_1=t;}
tab.MarksContentView.prototype={$2_1:null,$2_2:null,$2_3:null,$2_4:null,$2_5:null,$2_6:null,get_scrollContent:function(){if(!this.$2_2.get_layers().length){return this.$2_1.get_domRoot();}return this.$2_1.get_domRoot().find('.tabAuthShelf');},get_scrollableContentPreferredHeight:function(){var $0=spiff.Widget.getWidgets(this.get_scrollContent(),tab.CardContentView);if($0.length>0){var $1=0;var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $2=$enum1.current;$1=Math.max($1,($2).get_scrollableContentPreferredHeight());}return $1;}return this.$2_1.get_domRoot().outerHeight(true);},get_chooseLayersThreshold:function(){return 7;},get_$2_7:function(){if(ss.isNullOrUndefined(this.$2_4)){this.$2_4=spiff.ObjectRegistry.newView(tab.AccordionView,this.get_$2_8());}return this.$2_4;},get_$2_8:function(){if(ss.isNullOrUndefined(this.$2_3)){this.$2_3=new tab.AccordionViewModel();this.$2_3.set_allowDragOverExpand(false);this.$2_3.add_propertyChanged(ss.Delegate.create(this,function($p1_0,$p1_1){
if($p1_1.get_propertyName()!==tab.AccordionViewModel.propertyActiveItem){return;}var $1_0=this.$2_3.get_activeItem();if(ss.isNullOrUndefined($1_0)){return;}var $1_1=$1_0.get_content().get_viewModel();this.$2_2.set_currentLayer($1_1);}));}return this.$2_3;},get_$2_9:function(){if(ss.isNullOrUndefined(this.$2_6)){this.$2_6=$("<div class='tabAuthMarksContentMore'/>");this.$2_6.append($('<span>').text(tab.Strings.AuthMarksCardChooseField));this.$2_6.append($('<span>').addClass('tabAuthMarksContentMoreIcon'));this.disposables.add(spiff.TableauClickHandler.targetAndClick(this.$2_6[0],ss.Delegate.create(this,this.$2_10)));}return this.$2_6;},dispose:function(){this.$2_2.remove_layersChanged(ss.Delegate.create(this,this.handleLayersChanged));if(ss.isValue(this.$2_4)){this.$2_4.dispose();this.$2_4=null;}if(ss.isValue(this.$2_3)){this.$2_3.dispose();this.$2_3=null;}if(ss.isValue(this.$2_5)){this.$2_5.dispose();this.$2_5=null;}tab.MarksContentView.callBaseMethod(this, 'dispose');},onAddedToDom:function(){tab.MarksContentView.callBaseMethod(this, 'onAddedToDom');this.$2_A();},$2_A:function(){if(!this.get_addedToDom()){return;}if(ss.isValue(this.$2_5)){this.$2_5.onAddedToDom();}if(ss.isValue(this.$2_4)){this.$2_4.onAddedToDom();}},setScrollableContentActualHeight:function(height){var $0=spiff.Widget.getWidgets(this.get_scrollContent(),tab.CardContentView);if($0.length>0){var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $1=$enum1.current;($1).setScrollableContentActualHeight(height);}}},onViewModelPropertyChanged:function(sender,e){if(e.get_propertyName()==='CurrentLayer'){this.$2_E();}tab.MarksContentView.callBaseMethod(this, 'onViewModelPropertyChanged',[sender,e]);},handleLayersChanged:function(){if(ss.isValue(this.$2_5)){this.$2_5.dispose();this.$2_5=null;}if(this.$2_2.get_layers().length===1){this.$2_5=spiff.ObjectRegistry.newView(tab.LayerEncodingView,this.$2_2.get_currentLayer());if(ss.isValue(this.$2_4)){this.$2_4.dispose();this.$2_4=null;}}else{this.$2_B();}this.$2_F();},$2_B:function(){if(this.$2_2.get_layers().length<=this.get_chooseLayersThreshold()){this.get_$2_8().updateItems(_.map(this.$2_2.get_layers(),ss.Delegate.create(this,this.$2_C)));}else{this.get_$2_8().updateItems([this.$2_C(this.$2_2.get_currentLayer())]);}this.$2_D();},$2_C:function($p0){var $0=new tab.AccordionItem($p0.get_layerEncoding().get_name(),tab.IconUtils.getLayerIcon($p0.get_layerEncoding()),new tab.vqlauthoring$3($p0));if($p0.get_layerEncoding().get_isTableCalc()){$0.set_iconClassTwo('tabAuthPillIconTableCalc');}return $0;},$2_D:function(){this.get_$2_8().set_activeItem(_.find(this.get_$2_8().get_items(),ss.Delegate.create(this,function($p1_0){
var $1_0=$p1_0.get_content();return $1_0.get_id()===this.$2_2.get_currentLayer().get_layerEncoding().get_id();})));this.raiseScrollContentChanged();},$2_E:function(){if(this.$2_2.get_layers().length===1){this.handleLayersChanged();}else if(this.$2_2.get_layers().length<=this.get_chooseLayersThreshold()){this.$2_D();}else{this.$2_B();}},$2_F:function(){this.$2_1.get_domRoot().children().detach();if(!this.$2_2.get_layers().length){return;}if(this.$2_2.get_layers().length===1){this.$2_1.get_domRoot().append(this.$2_5.get_element());}else{this.$2_1.get_domRoot().append(this.get_$2_7().get_element());if(this.$2_2.get_layers().length>this.get_chooseLayersThreshold()){this.$2_1.get_domRoot().append(this.get_$2_9());}}this.$2_A();this.raiseScrollContentChanged();},$2_10:function($p0){var $0=[];var $enum1=ss.IEnumerator.getEnumerator(this.$2_2.get_layers());while($enum1.moveNext()){var $4=$enum1.current;var $5=spiff.MenuItem.newItemWithIcon($4,$4.get_layerEncoding().get_name(),tab.IconUtils.getLayerIcon($4.get_layerEncoding()));if($4===this.$2_2.get_currentLayer()){$5.set_itemClass('tabMenuSelectedItem');}if($4.get_layerEncoding().get_isTableCalc()){$5.set_iconClassTwo('tabAuthPillIconTableCalc');}$0.add($5);}var $1=$($p0.target);var $2=new spiff.ShowMenuOptions($1,false,$1.outerWidth());var $3=new spiff.Menu($0);spiff.MenuViewModel.createForMenu($3,ss.Delegate.create(this,this.$2_11),new tab.ComboBoxMenuTheme()).show($2);},$2_11:function($p0){this.$2_2.set_currentLayer($p0.get_data());}}
tab.MarksContentTemplate=function(){tab.MarksContentTemplate.initializeBase(this,[$("<div class='tabAuthMarksContent'/>")]);}
tab.vqlauthoring$3=function(layer){this.$0=layer;}
tab.vqlauthoring$3.prototype={$0:null,get_id:function(){return this.$0.get_layerEncoding().get_id();},get_viewType:function(){return tab.LayerEncodingView;},get_viewModel:function(){return this.$0;},get_active:function(){return false;},set_active:function($p0){return $p0;}}
tab.AuthoringTabNavView=function(viewModel){tab.AuthoringTabNavView.initializeBase(this,[viewModel,new tab.AuthoringTabNavViewTemplate()]);this.authoringTabNavViewModel=viewModel;this.dom=this.get_template();this.authoringTabNavViewModel.add_tabsChanged(ss.Delegate.create(this,this.updateContent));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.authoringTabNavViewModel.remove_tabsChanged(ss.Delegate.create(this,this.updateContent));})));}
tab.AuthoringTabNavView.prototype={authoringTabNavViewModel:null,dom:null,get_tabsWidth:function(){return this.dom.tabContainer.outerWidth(true);},get_availableWidth:function(){return this.dom.tabContainer.parent().width()-this.dom.controlsArea.width();},onViewModelPropertyChanged:function(sender,e){this.updateContent();},updateContent:function(){this.$2_0();},$2_0:function(){var $enum1=ss.IEnumerator.getEnumerator(spiff.Widget.getWidgets(this.dom.tabContainer.children(),tab.AuthoringTabView));while($enum1.moveNext()){var $1=$enum1.current;$1.dispose();}this.dom.tabContainer.empty();this.dom.tabContainer.append($("<span class='tabAuthTabSpacer'/>"));var $enum2=ss.IEnumerator.getEnumerator(this.authoringTabNavViewModel.get_workbookTabs());while($enum2.moveNext()){var $2=$enum2.current;var $3=new tab.AuthoringTabView($2);this.dom.tabContainer.append($3.get_element());this.dom.tabContainer.append($("<span class='tabAuthTabSpacer'/>"));}this.dom.tabContainer.append($("<span class='tabAuthTabSpacer tabAuthTabSpacerLast'/>"));var $0=$("<span class='tabAuthTab tabAuthTabNewBtn'><div class='tabAuthNewTabIcon'></div></span>");spiff.ClickHandler.targetAndClick($0,ss.Delegate.create(this,function(){
this.authoringTabNavViewModel.createNewWorksheet(true);}));this.dom.newButton=$0;this.dom.tabContainer.append($0);}}
tab.AuthoringTabNavViewTemplate=function(){tab.AuthoringTabNavViewTemplate.initializeBase(this,[$(tab.AuthoringTabNavViewTemplate.template)]);this.tabContainer=this.getElementBySelector('.tabAuthTabNavTabs');this.controlsArea=this.getElementBySelector('.tabAuthTabNavControls');this.leftButton=this.getElementBySelector('.tabAuthTabNavLeftButton');this.rightButton=this.getElementBySelector('.tabAuthTabNavRightButton');this.menuButton=this.getElementBySelector('.tabAuthTabNavMenuButton');}
tab.AuthoringTabNavViewTemplate.prototype={tabContainer:null,controlsArea:null,leftButton:null,rightButton:null,menuButton:null,newButton:null,tabs:function(){return this.tabContainer.children();}}
tab.AuthoringMastheadView=function(viewModel){this.$2_0=new tab.DisposableHolder();tab.AuthoringMastheadView.initializeBase(this,[viewModel,spiff.Template.fromHtml("<div class='tabAuthMasthead'>")]);this.authoringMastheadViewModel=viewModel;this.workbookNameDom=$('<div>').addClass('tabAuthMastheadWorkbookAreaName');this.userLinksAreaDom=$('<span>').addClass('tabAuthMastheadUserLinks');this.workbookLinksAreaDom=$('<div>').addClass('tabAuthMastheadWorkbookAreaLinks');this.logoDom=$('<a>').addClass('tabAuthMastheadLogo').css('background',String.format("url('{0}') center center no-repeat",tsConfig.serverSmallLogo));var $0=$('<span>').addClass('tabAuthMastheadWorkbookArea').append(this.workbookNameDom).append(this.workbookLinksAreaDom);this.get_element().append(this.logoDom).append($0).append(this.userLinksAreaDom);this.updateContent();}
tab.AuthoringMastheadView.prototype={authoringMastheadViewModel:null,workbookNameDom:null,userLinksAreaDom:null,workbookLinksAreaDom:null,logoDom:null,dispose:function(){this.$2_0.dispose();tab.AuthoringMastheadView.callBaseMethod(this, 'dispose');},onViewModelPropertyChanged:function(sender,e){this.updateContent();},updateContent:function(){this.workbookNameDom.text(this.authoringMastheadViewModel.get_workbookName());this.$2_0.dispose();this.userLinksAreaDom.children().remove();this.$2_4(this.authoringMastheadViewModel.get_userMenu(),this.userLinksAreaDom);this.workbookLinksAreaDom.children().remove();this.$2_4(this.authoringMastheadViewModel.get_workbookMenu(),this.workbookLinksAreaDom);},layout:function(){},$2_1:function($p0,$p1){var $0;if(ss.isValue($p0.get_subMenu())){$0=ss.Delegate.create(this,function(){
this.$2_3($p0.get_subMenu(),$p1);});}else{$0=function(){
($p0.get_data())();};}this.$2_0.add(spiff.TableauClickHandler.targetAndClick($p1[0],$0));},$2_2:function($p0){if($.isFunction($p0.get_data())){($p0.get_data())();}},$2_3:function($p0,$p1){var $0=spiff.MenuViewModel.createForMenu($p0,ss.Delegate.create(this,this.$2_2));$p1.addClass('tab-masthead-toolbar-button-open');$0.add_hidden(function(){
$p1.removeClass('tab-masthead-toolbar-button-open');});$0.show(spiff.ShowMenuOptions.preferDownAndLeft($p1,$p1.outerWidth(false)));},$2_4:function($p0,$p1){var $enum1=ss.IEnumerator.getEnumerator($p0.get_menuItems());while($enum1.moveNext()){var $0=$enum1.current;var $1=$("<a class='tab-masthead-toolbar-button'></a>");var $2=$('<a>').addClass('tabAuthMastheadLink').text($0.get_name());$1.append($2);if(ss.isValue($0.get_subMenu())){$1.append("<span class='tabAuthMastheadIcon'>\u25bc</span>");}if($0.get_enabled()){this.$2_1($0,$1);}else{$1.addClass('tabDisabled');}$p1.append($1);}}}
tab.PillDragAvatar=function(name,fieldType){tab.PillDragAvatar.initializeBase(this,[$("\n<span class='tabAuthPillAvatar'>\n    <div class='tabAuthPillAvatarLabel'>{0}</div>\n</span>")]);this.set_label(name);this.set_fieldType(fieldType);}
tab.PillDragAvatar.prototype={$1_1:null,$1_2:null,get_viewModel:function(){return null;},get_label:function(){return this.$1_1;},set_label:function(value){this.$1_1=value;this.get_element().find('.tabAuthPillAvatarLabel').text(this.$1_1);return value;},get_fieldType:function(){return this.$1_2;},set_fieldType:function(value){this.$1_2=value;var $0=false;var $1=false;var $2=false;var $3=false;switch(this.$1_2){case 'ordinal':$0=true;break;case 'quantitative':$1=true;break;case 'nominal':$2=true;break;default:$3=true;break;}this.get_element().toggleClass('tabAuthPillOrdinal',$0);this.get_element().toggleClass('tabAuthPillQuantatative',$1);this.get_element().toggleClass('tabAuthPillNominal',$2);this.get_element().toggleClass('tabAuthPillOther',$3);return value;}}
tab.PillView=function(viewModel,template){tab.PillView.initializeBase(this,[viewModel,template]);this.$2_1=viewModel;this.dom=template;this.disposables.add(spiff.TableauClickHandler.targetAndClick(this.dom.get_domRoot()[0],ss.Delegate.create(this,this.handlePillClick)).onRightClick(ss.Delegate.create(this,this.handleMenuButtonClick)).onDoubleClick(ss.Delegate.create(this.$2_1,this.$2_1.editPill)));this.disposables.add(spiff.TableauClickHandler.targetAndClick(this.dom.drillIcon[0],ss.Delegate.create(this,this.handleIconClick)));this.disposables.add(spiff.TableauClickHandler.targetAndClick(this.dom.menuButton[0],ss.Delegate.create(this,this.handleMenuButtonClick)));spiff.DragDropManager.attachDragSource(this.dom.dragSource,viewModel);spiff.DragDropManager.attachDropTarget(this.dom.get_domRoot(),viewModel);this.updateDom();this.$2_1.add_showDragAccept(ss.Delegate.create(this,this.$2_D));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$2_1.remove_showDragAccept(ss.Delegate.create(this,this.$2_D));})));_.defer(ss.Delegate.create(this,function(){
this.updateLabelSizeForIcons();}));}
tab.PillView.prototype={dom:null,$2_1:null,$2_2:null,$2_3:false,$2_4:null,$2_5:null,get_hasExternalIcon:function(){return this.$2_3;},dispose:function(){if(ss.isValue(this.$2_4)){this.$2_4.dispose();}tab.PillView.callBaseMethod(this, 'dispose');},handleMenuButtonClick:function(e){e.preventDefault();e.stopPropagation();this.$2_1.menuButtonClicked(this.dom.content);},handleIconClick:function(e){e.preventDefault();e.stopPropagation();this.$2_1.iconClicked();this.$2_A();},handlePillClick:function(e){e.preventDefault();e.stopPropagation();this.$2_1.pillClicked();},updateDom:function(){this.$2_C();this.$2_B();this.$2_A();this.$2_9();this.$2_8();this.$2_6();this.dom.label.text(this.$2_1.get_displayName());this.dom.label.attr('title',this.$2_1.get_pill().get_tooltip());},updateLabelSizeForIcons:function(){var $0=(this.dom.icons.is(':visible'))?this.dom.icons.outerWidth(true):10;this.dom.label.css('padding-right',String.format('{0}px',$0));},$2_6:function(){if(!this.$2_1.get_pill().get_alternateEncodings().length){return;}if(ss.isNullOrUndefined(this.$2_4)){this.dom.externalIcon.hide();this.$2_3=true;this.$2_4=new tab.ComboBoxViewModel();this.$2_4.set_theme(tab.ComboBoxTheme.compact);this.$2_4.set_showSelectedItem(false);this.$2_4.set_showDropdownIcon(!this.$2_1.get_pill().get_isMultipleFields());this.$2_4.set_enabled(!this.$2_1.get_pill().get_isMultipleFields());this.$2_4.add_selectedItemChanged(ss.Delegate.create(this,this.$2_7));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$2_4.remove_selectedItemChanged(ss.Delegate.create(this,this.$2_7));})));this.$2_5=spiff.ObjectRegistry.newView(tab.ComboBoxView,this.$2_4);this.dom.encodingType.append(this.$2_5.get_element());}this.$2_4.clearItems();var $enum1=ss.IEnumerator.getEnumerator(this.$2_1.get_pill().get_alternateEncodings());while($enum1.moveNext()){var $0=$enum1.current;var $1=new tab.ComboBoxItem(tab.IconUtils.getEncodingTypeIcon($0.ahq),$0.mb,$0.ahq,null);this.$2_4.addItem($1);if($0.ahq===this.$2_1.get_pill().get_encodingType()){this.$2_4.set_selectedItem($1);}}if(ss.isNullOrUndefined(this.$2_4.get_selectedItem())){var $enum2=ss.IEnumerator.getEnumerator(this.$2_1.get_pill().get_item().as0);while($enum2.moveNext()){var $2=$enum2.current;if($2.ahq===this.$2_1.get_pill().get_encodingType()){var $3=new tab.ComboBoxItem(tab.IconUtils.getEncodingTypeIcon($2.ahq),$2.mb,$2.ahq,null);this.$2_4.set_selectedItem($3);break;}}}},$2_7:function($p0){this.$2_1.updateEncodingType($p0.get_data());},$2_8:function(){var $0=tab.IconUtils.getPillFilterTypeIcon(this.$2_1.get_pill());this.$2_3=ss.isValue($0);if(ss.isValue($0)){this.dom.externalIcon.addClass($0);this.dom.externalIcon.attr('title',this.$2_1.get_pill().get_sideIconToolip());}},$2_9:function(){var $0=false;var $1=false;switch(this.$2_1.get_item().aji){case 'opened':$0=true;break;case 'closed':$1=true;break;}this.dom.content.toggleClass('tabAuthPillOpened',$0);this.dom.content.toggleClass('tabAuthPillClosed',$1);},$2_A:function(){this.dom.drillIcon.removeClass(this.$2_2);if(this.$2_1.get_pill().get_hasDrill()){this.$2_2=(this.$2_1.get_pill().get_shouldDrill())?'tabAuthPillIconDrillDown':'tabAuthPillIconDrillUp';}else{this.$2_2='';}this.dom.drillIcon.addClass(this.$2_2);this.dom.content.toggleClass('tabAuthPillHasDrill',this.$2_1.get_pill().get_hasDrill());this.dom.icons.empty();var $enum1=ss.IEnumerator.getEnumerator(tab.IconUtils.getPillIcons(this.$2_1.get_pill()));while($enum1.moveNext()){var $0=$enum1.current;this.dom.icons.append($('<span/>').addClass($0).addClass('tabAuthPillIcon'));}this.updateLabelSizeForIcons();},$2_B:function(){var $0=this.$2_1.get_pill().get_isMultipleFields();var $1=false;var $2=false;var $3=false;var $4=false;var $5=false;if(this.$2_1.get_item().ak){$5=true;}else if(!$0){switch(this.$2_1.get_field().get_fieldType()){case 'ordinal':$1=true;break;case 'quantitative':$2=true;break;case 'nominal':$3=true;break;default:$4=true;break;}}this.dom.content.toggleClass('tabAuthPillOrdinal',$1);this.dom.content.toggleClass('tabAuthPillQuantatative',$2);this.dom.content.toggleClass('tabAuthPillNominal',$3);this.dom.content.toggleClass('tabAuthPillOther',$4);this.dom.content.toggleClass('tabAuthPillMultiple',$0);this.dom.content.toggleClass('tabAuthPillInvalid',$5);},$2_C:function(){switch(this.$2_1.get_role()){case 'measure':this.dom.content.toggleClass('tabAuthPillDimension',false);this.dom.content.toggleClass('tabAuthPillMeasure',true);break;case 'dimension':case 'unknown':default:this.dom.content.toggleClass('tabAuthPillDimension',true);this.dom.content.toggleClass('tabAuthPillMeasure',false);break;}},$2_D:function($p0){this.dom.content.toggleClass('tabDropInvited',$p0);}}
tab.PillViewTemplate=function(html){tab.PillViewTemplate.initializeBase(this,[$(html)]);var $0=ss.Delegate.create(this,this.getElementBySelector);this.drillIcon=$0('.tabAuthPillDrillIcon');this.icons=$0('.tabAuthPillIcons');this.label=$0('.tabAuthPillLabel');this.menuButton=$0('.tabAuthPillMenuBtn');this.content=$0('.tabAuthPillContent');this.externalIcon=$0('.tabAuthPillExternalIcon');this.encodingType=$0('.tabAuthPillEncodingType');this.dragSource=this.get_domRoot();}
tab.PillViewTemplate.prototype={drillIcon:null,icons:null,label:null,menuButton:null,dragSource:null,content:null,externalIcon:null,encodingType:null}
tab.RenameSheetDialog=function(oldSheetName,existingSheetNames,postAction){tab.RenameSheetDialog.initializeBase(this,[oldSheetName,$(tab.RenameSheetDialog.renameTemplate)]);this.$3_0=oldSheetName;this.$3_1=existingSheetNames;this.$3_2=postAction;this.set_closeButtonVisible(false);this.set_titleUnescaped(tab.Strings.AuthRenameSheet);var $0=spiff.StyledButton.createStyledButton(ss.Delegate.create(this,this.handleRename),tab.Strings.DialogButtonOK,'commit',2);this.disposables.add($0);$0.set_disabled(true);var $1=spiff.StyledButton.createStyledButton(ss.Delegate.create(this,this.handleCancel),tab.Strings.DialogButtonCancel,'cancel',3);this.disposables.add($1);this.get_element().find('.tab-dialog-actions').append($0.get_element()).append($1.get_element());this.$3_3=this.get_body().find('.newSheetName');this.$3_3.val(this.$3_0);this.$3_3.keyup(ss.Delegate.create(this,function(){
$0.set_disabled(!this.validateNewSheetName(this.$3_3.val()));}));this.$3_3.keydown(ss.Delegate.create(this,function($p1_0){
if($p1_0.which===13){this.handleRename();}}));this.$3_4=this.get_body().find('.tab-dialog-status-msg');this.$3_4.hide();this.set_setFocusOnShow(false);}
tab.RenameSheetDialog.prototype={$3_0:null,$3_1:null,$3_2:null,$3_3:null,$3_4:null,get_$3_5:function(){return this.$3_4.text();},set_$3_5:function($p0){this.$3_4.text($p0);if(ss.isNull($p0)){this.$3_4.hide();}else{this.$3_4.show();}return $p0;},validateNewSheetName:function(newSheetName){return !(String.isNullOrEmpty(newSheetName.toString().trim())||newSheetName===this.$3_0||newSheetName.toString().length>254||this.$3_1.contains(newSheetName));},handleRename:function(){var $0=this.$3_3.val();if(!this.validateNewSheetName($0)){this.set_$3_5(tab.Strings.AuthRenameSheetError);}else{this.set_$3_5(null);this.$3_2($0);this.closeAndDispose();}},handleCancel:function(){this.closeAndDispose();},show:function(){tab.RenameSheetDialog.callBaseMethod(this, 'show');this.$3_3.select();if(!tsConfig.is_touch){this.$3_3.focus();}}}
tab.SaveView=function(viewModel){tab.SaveView.initializeBase(this,[viewModel,spiff.Template.fromHtml("<div class='tabAuthSave'>")]);this.saveViewModel=viewModel;this.saveViewModel.add_shown(ss.Delegate.create(this,this.$2_D));this.saveViewModel.add_hidden(ss.Delegate.create(this,this.$2_C));this.buildDom();this.updateContent();this.enableTextSelection();}
tab.SaveView.$2_8=function($p0,$p1,$p2,$p3){return $('<label>').addClass($p2).append($('<span>').text($p1)).prepend($("<input type='checkbox'>").attr('tabindex',$p3.toString()).change($p0));}
tab.SaveView.prototype={saveViewModel:null,$2_0:null,$2_1:null,$2_2:null,$2_3:null,$2_4:null,$2_5:null,$2_6:null,$2_7:null,dispose:function(){this.saveViewModel.remove_shown(ss.Delegate.create(this,this.$2_D));this.saveViewModel.remove_hidden(ss.Delegate.create(this,this.$2_C));this.$2_1.dispose();if(ss.isValue(this.$2_5)){this.$2_5.dispose();}tab.SaveView.callBaseMethod(this, 'dispose');},onViewModelPropertyChanged:function(sender,e){this.updateContent();},updateContent:function(){if(this.$2_0.val()!==this.saveViewModel.get_workbookName()){this.$2_0.val(this.saveViewModel.get_workbookName());}this.$2_1.remove_selectedItemChanged(ss.Delegate.create(this,this.$2_13));this.$2_1.clearItems();var $0=null;var $enum1=ss.IEnumerator.getEnumerator(this.saveViewModel.get_projects());while($enum1.moveNext()){var $1=$enum1.current;var $2=new tab.ComboBoxItem('',$1.get_name(),$1,null);this.$2_1.addItem($2);if($1===this.saveViewModel.get_currentProject()){$0=$2;}}this.$2_1.set_selectedItem($0);this.$2_1.add_selectedItemChanged(ss.Delegate.create(this,this.$2_13));this.$2_3.find('input').prop('checked',this.saveViewModel.get_showTabs());this.$2_4.find('input').prop('checked',this.saveViewModel.get_embedCredentials());this.$2_7.set_disabled(!this.saveViewModel.get_saveEnabled());this.get_element().find('.tabAuthSaveProjectRow').toggle(this.saveViewModel.get_showProjects());},buildDom:function(){this.$2_0=$("<input type='text' tabindex='1'>").keyup(ss.Delegate.create(this,this.$2_12));spiff.Widget.enableTextSelectionOnElement(this.$2_0);this.$2_1=new tab.ComboBoxViewModel();this.$2_2=spiff.ObjectRegistry.newView(tab.ComboBoxView,this.$2_1);this.$2_2.get_element().addClass('tabAuthSaveProjects').prop('tabindex','2');this.$2_3=tab.SaveView.$2_8(ss.Delegate.create(this,this.$2_11),tab.Strings.AuthSaveLabelShowTabs,'tabAuthSaveShowTabsCheck',3);this.$2_4=tab.SaveView.$2_8(ss.Delegate.create(this,this.$2_10),tab.Strings.AuthSaveLabelEmbedPassword,'tabAuthSaveEmbedCredsCheck',4);this.$2_6=spiff.StyledButton.createStyledButton(ss.Delegate.create(this,this.$2_B),tab.Strings.AuthSaveButtonCancel,'tabAuthSaveCancelButton',6);this.$2_7=spiff.StyledButton.createStyledButton(ss.Delegate.create(this,this.$2_A),tab.Strings.AuthSaveButtonSave,'tabAuthSaveSaveButton',5);if(ss.isValue(this.saveViewModel.get_saveWarning())){this.get_element().append($('<div>').addClass('tabAuthSaveWarning').append($('<div>').addClass('tabAuthSaveWarningIcon')).append($('<div>').addClass('tabAuthSaveWarningText').text(this.saveViewModel.get_saveWarning())));}this.get_element().append($('<table>').addClass('tabAuthSaveLayoutTable').append($('<tr>').append($('<td>').append($('<div>').addClass('tabAuthSaveLabel').text(tab.Strings.AuthSaveLabelName)))).append($('<tr>').append($('<td>').append($('<div>').addClass('tabAuthSaveNameRowValue').append(this.$2_0)))).append($('<tr>').append($("<td class='tabAuthSaveProject'>").append($('<div>').addClass('tabAuthSaveLabel').text(tab.Strings.AuthSaveLabelProject)))).append($('<tr>').append($('<td>').append(this.$2_2.get_element()))).append($('<tr>').append($("<td class='tabAuthFirstSaveOption'>").append($('<div>').addClass('tabAuthSaveOption').append(this.$2_3)))).append($('<tr>').append($('<td>').append($('<div>').addClass('tabAuthSaveOption').append(this.$2_4)))));this.get_element().append($('<div>').addClass('tabAuthSaveButtons').append(this.$2_7.get_element()).append(this.$2_6.get_element()));},$2_9:function($p0){switch($p0.which){case 13:$p0.preventDefault();$p0.stopPropagation();this.saveViewModel.save();break;}},$2_A:function(){this.saveViewModel.save();},$2_B:function(){this.saveViewModel.cancelled();this.saveViewModel.hide();},$2_C:function(){if(ss.isValue(this.$2_5)){spiff.ClickBuster.remove_clickBustDetected(ss.Delegate.create(this,this.$2_E));this.$2_5.remove_closed(ss.Delegate.create(this,this.$2_F));this.$2_5.close();this.get_element().detach();this.$2_5.dispose();}this.$2_5=null;},$2_D:function(){this.$2_5=new spiff.ModalDialog(tab.Strings.AuthSaveTitle,this.get_element());this.$2_5.enableTextSelection();this.$2_5.set_setFocusOnShow(true);this.$2_5.get_element().keydown(ss.Delegate.create(this,this.$2_9));this.$2_5.add_closed(ss.Delegate.create(this,this.$2_F));this.$2_5.show();},$2_E:function($p0){if(ss.isValue(this.$2_5)){this.$2_5.setInitialFocus();spiff.ClickBuster.remove_clickBustDetected(ss.Delegate.create(this,this.$2_E));}},$2_F:function($p0,$p1){this.saveViewModel.cancelled();this.saveViewModel.hide();},$2_10:function($p0){this.saveViewModel.set_embedCredentials($($p0.target).prop('checked'));},$2_11:function($p0){this.saveViewModel.set_showTabs($($p0.target).prop('checked'));},$2_12:function($p0){this.saveViewModel.set_workbookName(this.$2_0.val());},$2_13:function($p0){this.saveViewModel.set_currentProject((ss.isValue($p0))?$p0.get_data():null);}}
tab.DataSchemaView=function(viewModel){this.perInitDisposables=new tab.DisposableHolder();this.$2_2={};tab.DataSchemaView.initializeBase(this,[viewModel,new tab.SchemaViewerTemplate()]);this.dom=this.get_template();if(tab.FeatureFlags.isEnabled('AnalyticsPane')&&!!tab.FeatureParamsLookup.getBool(tab.FeatureParam.aoPaneUI)){this.dom.sourcesHeader.css('display','none');}else{this.dom.sourcesHeader.text(tab.Strings.AuthSchemaViewerHeaderData);}this.dom.headers['dimensions'].text(tab.Strings.AuthSchemaViewerHeaderDimensions);this.dom.headers['measure'].text(tab.Strings.AuthSchemaViewerHeaderMeaures);this.dom.headers['groups'].text(tab.Strings.AuthSchemaViewerHeaderSets);this.dom.headers['parameters'].text(tab.Strings.AuthSchemaViewerHeaderParameters);this.get_dataSchemaViewModel().add_dataSchemaModified(ss.Delegate.create(this,this.initFromModel));this.get_dataSchemaViewModel().add_dataSourceListChanged(ss.Delegate.create(this,this.$2_16));this.get_dataSchemaViewModel().add_nodeActivated(ss.Delegate.create(this,this.ensureNodeIsVisible));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.get_dataSchemaViewModel().remove_dataSchemaModified(ss.Delegate.create(this,this.initFromModel));this.get_dataSchemaViewModel().remove_dataSourceListChanged(ss.Delegate.create(this,this.$2_16));this.get_dataSchemaViewModel().remove_nodeActivated(ss.Delegate.create(this,this.ensureNodeIsVisible));})));spiff.DragDropManager.attachDropTarget(this.dom.sections['dimensions'],this.get_dataSchemaViewModel().get_dimensionDropTarget());spiff.DragDropManager.attachDropTarget(this.dom.sections['measure'],this.get_dataSchemaViewModel().get_measureDropTarget());spiff.DragDropManager.attachDropTarget(this.dom.get_domRoot(),this.get_dataSchemaViewModel().get_schemaDropTarget());this.get_dataSchemaViewModel().get_schemaDropTarget().add_dropStateChanged(ss.Delegate.create(this,this.$2_5));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.get_dataSchemaViewModel().get_schemaDropTarget().remove_dropStateChanged(ss.Delegate.create(this,this.$2_5));})));if(tab.FeatureFlags.isEnabled('NonModalCalculationDialog')){this.$2_1=new spiff.ToggleButton($("<span><span class='icon'/></span>"));this.$2_1.get_element().addClass('tab-schema-menu-button');this.dom.headers['dimensions'].append(this.$2_1.get_element());this.$2_1.add_click(ss.Delegate.create(this,this.$2_6));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$2_1.remove_click(ss.Delegate.create(this,this.$2_6));})));this.disposables.add(this.$2_1);}tab.DataSchemaViewModel.sectionsInOrder.forEach(ss.Delegate.create(this,function($p1_0){
spiff.DragDropManager.attachDragSource(this.dom.sections[$p1_0],this.get_dataSchemaViewModel().createDragSource());}));}
tab.DataSchemaView.prototype={dom:null,$2_1:null,lastSelected:null,$2_3:null,$2_4:null,get_dataSchemaViewModel:function(){return this.get_viewModel();},get_width:function(){return this.dom.get_domRoot().width();},set_width:function(value){this.dom.get_domRoot().width(value);return value;},get_maxDesiredWidth:function(){var $0=0;this.dom.contentArea.find('.tab-schema-field-label-area').each(function($p1_0,$p1_1){
if($p1_1.clientWidth>$0){$0=$p1_1.clientWidth;}});return $0+22;},get_allElements:function(){return this.dom.get_schemaElements().toArray();},get_dataSourceTitles:function(){return this.$2_4;},dispose:function(){this.perInitDisposables.dispose();tab.DataSchemaView.callBaseMethod(this, 'dispose');},findFieldTemplate:function(node){var $0=null;this.dom.get_schemaElements().each(function($p1_0,$p1_1){
var $1_0=tab.FieldTemplate.fromDom($($p1_1));if($1_0.get_node()===node){$0=$1_0;return false;}return true;});return $0;},initFromModel:function(){this.perInitDisposables.dispose();this.$2_15();tab.DataSchemaViewModel.sectionsInOrder.forEach(ss.Delegate.create(this,function($p1_0){
this.$2_14($p1_0);}));},fieldExpanded:function(field,expanded){},ensureNodeIsVisible:function(node){var $0=this.findFieldTemplate(node);if($0==null){return;}this.scrollFieldIntoView($0);},scrollFieldIntoView:function(field){var $0=this.get_scrollTop();var $1=this.dom.contentAreaScroll.height();var $2=field.get_domRoot().position().top;var $3=$2+field.get_domRoot().height();var $4=null;if($2<0){$4=$0+$2-10;}else if($3>$1){$4=$0+$3-$1+10;}if(!ss.isValue($4)){return;}this.set_scrollTop($4);},onViewModelPropertyChanged:function(sender,e){tab.DataSchemaView.callBaseMethod(this, 'onViewModelPropertyChanged',[sender,e]);if(e.get_propertyName()==='SelectedField'){this.$2_8();}},$2_5:function($p0){this.dom.dropInviteElements.toggle($p0===1);},$2_6:function(){this.$2_1.set_selected(true);this.get_dataSchemaViewModel().showContextMenu(this.$2_1.get_element(),ss.Delegate.create(this,this.$2_7));},$2_7:function(){this.$2_1.set_selected(false);},$2_8:function(){this.dom.get_domRoot().find('.selected').removeClass('selected');if(this.get_dataSchemaViewModel().hasSelection()){this.dom.get_schemaElements().each(ss.Delegate.create(this,function($p1_0,$p1_1){
var $1_0=tab.FieldTemplate.fromDom($($p1_1));if(ss.isValue($1_0)&&this.get_dataSchemaViewModel().isSelected($1_0.get_node())){if(!$1_0.get_node().isUnsortedContainer){$1_0.pill.addClass('selected');}else{$1_0.name.addClass('selected');}}return true;}));}else{this.lastSelected=null;}},$2_9:function($p0){var $0=$($p0.target).parents('.tab-schema-field').first();var $1=tab.FieldTemplate.fromDom($0);var $2=$1.get_node();if(ss.isValue($2)&&$2.canHaveChildren){this.$2_A($1,$1.expandoIcon.hasClass('tab-schema-collapsed'),true);}},$2_A:function($p0,$p1,$p2){this.$2_2[$p0.get_node().get_comparisonKey()]=$p1;var $0=ss.Delegate.create(this,function(){
this.fieldExpanded($p0,$p1);});if($p1){if(ss.isValue($p0.deferredCreateChildren)){$p0.deferredCreateChildren();$p0.deferredCreateChildren=null;}if($p2){$p0.children.slideDown('fast',$0);}else{$p0.children.show();}}else{if($p2){$p0.children.slideUp('fast',$0);}else{$p0.children.hide();}}if($p0.get_node().isCubeFolder){$p0.icon.toggleClass('tab-schema-cube-d-folder-closed-icon',!$p1).toggleClass('tab-schema-cube-d-folder-open-icon',$p1);}else if($p0.get_node().isFolder){$p0.icon.toggleClass('tab-schema-folder-closed-icon',!$p1).toggleClass('tab-schema-folder-open-icon',$p1);}$p0.expandoIcon.toggleClass('tab-schema-expanded',$p1).toggleClass('tab-schema-collapsed',!$p1);},$2_B:function($p0){var $0=new tab.FieldTemplate();$0.set_node($p0);$0.get_domRoot().addClass('tab-field-column').attr('title',$p0.tooltip);$0.name.text($p0.displayName);this.$2_19($0,$p0);return $0;},$2_C:function($p0,$p1,$p2,$p3){if($p1.isSelectable||$p0.children.length>0){var $0=$p1.childToSelect;this.attachFieldEventHandlers($p2.get_node(),$0,$p2,$p3);}},toggleSelection:function(node,selectedFieldElement){if(this.get_dataSchemaViewModel().isSelected(node)){this.get_dataSchemaViewModel().deSelectNode(node);}else{this.get_dataSchemaViewModel().addNodeToSelection(node);this.lastSelected=selectedFieldElement;}},$2_D:function($p0){if(ss.isNullOrUndefined(this.lastSelected)||ss.isNullOrUndefined($p0)){return;}var $0=this.get_allElements();var $1=$0.indexOf($p0);var $2=$0.indexOf(this.lastSelected);var $3=Math.min($1,$2);var $4=Math.max($1,$2);if(this.$2_E($3,$4)){if(ss.isValue(this.$2_3)){$3=Math.min($3,this.$2_3.first);$4=Math.max($4,this.$2_3.second);}this.$2_F($3,$4);}else{this.$2_10($3,$4);}},$2_E:function($p0,$p1){return ss.isNullOrUndefined(this.$2_3)||(this.$2_3.first>$p0||this.$2_3.second<$p1);},$2_F:function($p0,$p1){var $0=this.get_allElements().length;if($p0<0||$p1<0||$p0>=$0||$p1>=$0){return;}var $1=[];var $2=this.get_allElements();for(var $3=$p0;$3<=$p1;$3++){var $4=tab.FieldTemplate.fromDom($($2[$3])).get_node();$1.add($4);}this.$2_3=new ss.Tuple($p0,$p1);this.get_dataSchemaViewModel().addNodesToSelection($1);},$2_10:function($p0,$p1){var $0=[];var $1=this.get_allElements();for(var $2=this.$2_3.first;$2<=this.$2_3.second;$2++){if($2<$p0||$2>$p1){var $3=tab.FieldTemplate.fromDom($($1[$2])).get_node();$0.add($3);}}this.$2_3=new ss.Tuple($p0,$p1);this.get_dataSchemaViewModel().deSelectNodes($0);},attachSelectionEventHandler:function(ft){ft.getLabelClickHandler(this.perInitDisposables).onPress(ss.Delegate.create(this,function($p1_0){
var $1_0=ft.get_domRoot().get(0);if($p1_0.shiftKey){if(ss.isValue(this.lastSelected)&&this.get_dataSchemaViewModel().hasSelection()){this.$2_D($1_0);}else{this.get_dataSchemaViewModel().clearAllAndSelect(ft.get_node());}this.lastSelected=$1_0;}else if($p1_0.ctrlKey||(tab.BrowserSupport.get_isMac()&&$p1_0.metaKey)){this.toggleSelection(ft.get_node(),$1_0);this.$2_3=null;}else if(!this.get_dataSchemaViewModel().isSelected(ft.get_node())){this.$2_11(ft);}})).onClick(ss.Delegate.create(this,function($p1_0){
if(!$p1_0.shiftKey&&!$p1_0.ctrlKey){this.$2_11(ft);}})).onRightClick(ss.Delegate.create(this,function($p1_0){
if(!this.get_dataSchemaViewModel().isSelected(ft.get_node())){this.$2_11(ft);}}));},$2_11:function($p0){this.get_dataSchemaViewModel().clearAllAndSelect($p0.get_node());this.lastSelected=$p0.get_domRoot().get(0);this.$2_3=null;},attachFieldEventHandlers:function(field,dragField,ft,isHidden){if(!isHidden){if(field.isDraggable){ft.labelArea.dblclick(ss.Delegate.create(this,function(){
this.get_dataSchemaViewModel().addFieldToSheet(dragField);}));}else if(field.isUnsortedContainer){ft.getLabelClickHandler(this.perInitDisposables).onDoubleClick(ss.Delegate.create(this,this.$2_9));}}this.attachSelectionEventHandler(ft);if(field.canHaveChildren){ft.getExpandoClickHandler(this.perInitDisposables).onPress(ss.Delegate.create(this,this.$2_9));}},$2_12:function($p0,$p1){if($p1){return 'tab-schema-field-pill-inactive';}switch($p0){case 'quantitative':return 'tab-schema-field-pill-measure';case 'ordinal':case 'nominal':default:return 'tab-schema-field-pill-dimension';}},$2_13:function($p0,$p1,$p2){var $0=this.$2_B($p1);if($p1.isSelectable){$0.pill.addClass(this.$2_12($p1.fieldType,$p2));}if(!$p1.hasContextMenu){$0.menuButton.hide();}if($p1.isGenerated&&!$p1.children.length){$0.get_domRoot().addClass('tab-field-generated');}if($p1.isHierarchyRoot&&$p1.children.length>0){$0.name.addClass('tab-schema-dimension-label');}if($p1.isGroup){$0.get_domRoot().add('tab-set');}if(this.get_dataSchemaViewModel().isSelected($p1)){if(!$p1.isUnsortedContainer){$0.pill.addClass('selected');}else{$0.name.addClass('selected');}}var $1=$p2||$p1.isHidden;if($1){$0.name.addClass('tab-schema-field-hidden');}if($p1.children.length>0){var $2=(this.$2_2[$p1.get_comparisonKey()]||false);var $3=ss.Delegate.create(this,function(){
var $enum1=ss.IEnumerator.getEnumerator($p1.children);while($enum1.moveNext()){var $1_0=$enum1.current;this.$2_13($0.children,$1_0,$1);}});if($2){$3();}else{$0.deferredCreateChildren=$3;$0.children.hide();}this.$2_A($0,$2,false);}else{$0.children.hide();}this.$2_C($p1,$p1,$0,$1);$p0.append($0.get_domRoot());},$2_14:function($p0){var $0=this.dom.sections[$p0];var $1=this.get_dataSchemaViewModel().nodeTreeForSection($p0);$0.empty();var $enum1=ss.IEnumerator.getEnumerator($1);while($enum1.moveNext()){var $4=$enum1.current;this.$2_13($0,$4,$4.isHidden);}var $2=true;if($p0==='groups'||$p0==='parameters'){$2=$1.length>0;}$0.toggle($2);this.dom.headers[$p0].toggle($2);var $3=$1.some(function($p1_0){
return $p1_0.children.length>0;});$0.toggleClass('tab-schema-has-hierarchies',$3);$0.toggleClass('tab-schema-no-hierarchies',!$3);},$2_15:function(){this.$2_4=[];var $enum1=ss.IEnumerator.getEnumerator(this.get_dataSchemaViewModel().get_selectableDataSources());while($enum1.moveNext()){var $1=$enum1.current;var $2=new tab.DataSourceTemplate();$2.get_domRoot().prop('title',$1.get_caption());$2.get_domRoot().prop('DataSource',$1);this.$2_17($2,$1);this.perInitDisposables.add(spiff.TableauClickHandler.target($2.get_domRoot()[0]).onClick(this.$2_18($1)));this.get_dataSourceTitles().add($2);}this.get_dataSourceTitles().sort(function($p1_0,$p1_1){
return $p1_0.name.text().localeCompare($p1_1.name.text());});this.dom.sourceTitles.empty();this.get_dataSourceTitles().forEach(ss.Delegate.create(this,function($p1_0){
this.dom.sourceTitles.append($p1_0.get_domRoot());}));var $0=new spiff.IconButton();$0.setIcon('tabAuthDataRefreshIcon');$0.set_hoverTooltipText(tab.Strings.ToolbarRefreshData);$0.addClass('tabDataRefresh');$0.add_click(ss.Delegate.create((this.get_viewModel()),(this.get_viewModel()).refreshButtonClicked));this.perInitDisposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
$0.remove_click(ss.Delegate.create((this.get_viewModel()),(this.get_viewModel()).refreshButtonClicked));})));this.dom.refreshButtonArea.empty();this.dom.refreshButtonArea.append($0.get_element());},$2_16:function(){var $enum1=ss.IEnumerator.getEnumerator(this.get_dataSourceTitles());while($enum1.moveNext()){var $0=$enum1.current;var $1=_.find(this.get_dataSchemaViewModel().get_selectableDataSources(),function($p1_0){
return $0.get_domRoot().prop('DataSource')===$p1_0;});if(ss.isValue($1)){this.$2_17($0,$1);}}},$2_17:function($p0,$p1){var $0=this.get_dataSchemaViewModel().get_currentSheetSchema();var $1=$0.v4;$p0.name.text($p1.get_caption());$p0.icon.removeClass();$p0.icon.addClass('tab-schema-dataSourceIcon');$p0.icon.addClass(tab.IconUtils.getDataSourceIcon($1,$p1));var $2=this.get_dataSchemaViewModel().get_selectableDataSources().length>1;if($2&&$p1===this.get_dataSchemaViewModel().get_selectedDataSource()){$p0.get_domRoot().addClass('tab-schema-dataSourceSelected');}},$2_18:function($p0){return ss.Delegate.create(this,function(){
this.get_dataSchemaViewModel().set_selectedDataSource($p0);});},$2_19:function($p0,$p1){if(ss.isNullOrUndefined($p1.fieldIconResource)||!$p1.fieldIconResource.length){$p0.iconArea.toggleClass('no-icon',true);return;}$p0.iconArea.toggleClass('no-icon',false);$p0.icon.addClass(tab.IconUtils.getFieldIcon($p1));}}
tab.DataSourceTemplate=function(){tab.DataSourceTemplate.initializeBase(this,[$("<div class='tab-dataSource'><div class='tab-schema-dataSourceIcon'/><div class='tab-schema-dataSourceName'/></div>")]);this.icon=this.getElementBySelector('.tab-schema-dataSourceIcon');this.name=this.getElementBySelector('.tab-schema-dataSourceName');}
tab.DataSourceTemplate.prototype={icon:null,name:null}
tab.FieldTemplate=function(){tab.FieldTemplate.initializeBase(this,[$(tab.FieldTemplate.template)]);this.get_domRoot().data('FieldTemplate',this);this.icon=this.getElementBySelector('.tab-schema-field-icon');this.iconArea=this.getElementBySelector('.tab-schema-field-icon-area');this.name=this.getElementBySelector('.tab-schema-field-label');this.children=this.getElementBySelector('.tab-schema-field-children');this.expandoIcon=this.getElementBySelector('.tab-schema-field-expando-icon');this.labelArea=this.getElementBySelector('.tab-schema-field-label-area');this.pill=this.getElementBySelector('.tab-schema-field-pill');this.menuButton=this.getElementBySelector('.tab-schema-field-pill-menu-btn');if(!tab.FeatureFlags.isEnabled('NonModalCalculationDialog')){this.pill.addClass('disablecontextmenu');}}
tab.FieldTemplate.fromDom=function(dom){return dom.data('FieldTemplate');}
tab.FieldTemplate.prototype={expandoIcon:null,icon:null,iconArea:null,name:null,labelArea:null,children:null,pill:null,menuButton:null,deferredCreateChildren:null,$1_0:null,$1_1:null,$1_2:null,get_node:function(){return this.get_domRoot().data('Node');},set_node:function(value){this.get_domRoot().data('Node',value);return value;},firstChild:function(){return tab.FieldTemplate.fromDom(this.children.find('.tab-schema-field').first());},getMenuClickHandler:function(d){if(ss.isNullOrUndefined(this.$1_0)){this.$1_0=spiff.TableauClickHandler.target(this.menuButton[0]);d.add(this.$1_0);}return this.$1_0;},getExpandoClickHandler:function(d){if(ss.isNullOrUndefined(this.$1_2)){this.$1_2=spiff.TableauClickHandler.target(this.expandoIcon[0]);d.add(this.$1_2);}return this.$1_2;},getLabelClickHandler:function(d){if(ss.isNullOrUndefined(this.$1_1)){this.$1_1=spiff.TableauClickHandler.target(this.labelArea[0]);d.add(this.$1_1);}return this.$1_1;}}
tab.SchemaViewerTemplate=function(){this.sections={};this.headers={};tab.SchemaViewerTemplate.initializeBase(this,[$("\n<div class='tab-schemaViewer'>\n  <div class='tab-schemaViewerScroll'>\n      <div class='tab-schemaViewerContentArea'>\n        <div class='tab-schemaHeader tab-schemaDataSourcesHeader'>Data</div>\n        <div class='tab-dataSources'>\n            <div class='tab-dataSourceTitles'/>\n            <div class='tab-dataRefreshButtonArea'/>\n        </div>\n        <div class='tab-schemaHeader tab-schemaDimensionsHeader'>Dimensions</div>\n        <div class='tab-schemaDimensions'><div class='tab-schemaViewerContent'></div></div>\n        <div class='tab-schemaHeader tab-schemaMeasuresHeader'>Measures</div>\n        <div class='tab-schemaMeasures'><div class='tab-schemaViewerContent'></div></div>\n        <div class='tab-schemaHeader tab-schemaSetsHeader'>Sets</div>\n        <div class='tab-schemaSets'><div class='tab-schemaViewerContent'></div></div>\n        <div class='tab-schemaHeader tab-schemaParametersHeader'>Parameters</div>\n        <div class='tab-schemaParameters'><div class='tab-schemaViewerContent'></div></div>\n      </div>\n  </div>\n  <div class='tab-schemaDropInviteTop'></div>\n  <div class='tab-schemaDropInviteLeft'></div>\n  <div class='tab-schemaDropInviteBottom'></div>\n  <div class='tab-schemaDropInviteRight'></div>\n</div>")]);this.sources=this.getElementBySelector('.tab-dataSources');this.sourceTitles=this.getElementBySelector('.tab-dataSourceTitles');this.refreshButtonArea=this.getElementBySelector('.tab-dataRefreshButtonArea');this.sections['dimensions']=this.getElementBySelector('.tab-schemaDimensions .tab-schemaViewerContent');this.sections['measure']=this.getElementBySelector('.tab-schemaMeasures .tab-schemaViewerContent');this.sections['groups']=this.getElementBySelector('.tab-schemaSets .tab-schemaViewerContent');this.sections['parameters']=this.getElementBySelector('.tab-schemaParameters .tab-schemaViewerContent');this.sourcesHeader=this.getElementBySelector('.tab-schemaDataSourcesHeader');this.headers['dimensions']=this.getElementBySelector('.tab-schemaDimensionsHeader');this.headers['measure']=this.getElementBySelector('.tab-schemaMeasuresHeader');this.headers['groups']=this.getElementBySelector('.tab-schemaSetsHeader');this.headers['parameters']=this.getElementBySelector('.tab-schemaParametersHeader');this.contentArea=this.getElementBySelector('.tab-schemaViewerContentArea');this.contentAreaScroll=this.getElementBySelector('.tab-schemaViewerScroll');this.dropInviteElements=this.getElementsBySelector('.tab-schemaDropInviteTop, .tab-schemaDropInviteLeft, .tab-schemaDropInviteBottom, .tab-schemaDropInviteRight');}
tab.SchemaViewerTemplate.prototype={sources:null,sourceTitles:null,refreshButtonArea:null,sourcesHeader:null,contentArea:null,contentAreaScroll:null,dropInviteElements:null,get_schemaElements:function(){return this.get_domRoot().find('.tab-schema-field');}}
tab.ShapePickerView=function(viewModel,t){tab.ShapePickerView.initializeBase(this,[viewModel,t]);this.dom=t;this.shapePickerViewModel=viewModel;}
tab.ShapePickerView.$2_0=function($p0){return 'tabShape-'+((ss.isValue($p0.get_palette()))?$p0.get_palette().toString():'def')+'-'+$p0.get_shapeType();}
tab.ShapePickerView.prototype={dom:null,shapePickerViewModel:null,onViewModelPropertyChanged:function(sender,e){this.updateContent();},updateContent:function(){this.dom.rows.children().remove();var $0=null;var $1=0;var $enum1=ss.IEnumerator.getEnumerator(this.shapePickerViewModel.get_shapes());while($enum1.moveNext()){var $2=$enum1.current;if($0==null||$1===this.shapePickerViewModel.get_shapesPerRow()){$0=$("<div class='tabAuthShapePickerRow'/>");this.dom.rows.append($0);$1=0;}spiff.ClickHandler.targetAndClick($("<span class='tabAuthShapePickerItem'/>").addClass(tab.ShapePickerView.$2_0($2)).toggleClass('tabAuthShapeSelected',$2.equals(this.shapePickerViewModel.get_selectedShape())).data('tabShape',$2).appendTo($0),this.$2_1($2));$1++;}},$2_1:function($p0){return ss.Delegate.create(this,function(){
this.shapePickerViewModel.set_selectedShape($p0);});}}
tab.ShapePickerTemplate=function(){tab.ShapePickerTemplate.initializeBase(this,[$("<div class='tabAuthShapePicker'><div class='tabAuthShapePickerRows'/></div>")]);this.rows=this.getElementBySelector('.tabAuthShapePickerRows');}
tab.ShapePickerTemplate.prototype={rows:null}
tab.ShelfView=function(viewModel,t){this.$2_6=new tab.DisposableHolder();this.$2_8=[];tab.ShelfView.initializeBase(this,[viewModel,t]);this.shelfViewModel=viewModel;this.shelfViewModel.add_shelfChanged(ss.Delegate.create(this,this.initFromModel));this.shelfViewModel.add_dropStateChanged(ss.Delegate.create(this,this.$2_10));this.shelfViewModel.add_dragOverDropPositionChanged(ss.Delegate.create(this,this.$2_F));this.shelfViewModel.add_openTypeInPill(ss.Delegate.create(this,this.$2_D));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.shelfViewModel.remove_shelfChanged(ss.Delegate.create(this,this.initFromModel));this.shelfViewModel.remove_dropStateChanged(ss.Delegate.create(this,this.$2_10));this.shelfViewModel.remove_dragOverDropPositionChanged(ss.Delegate.create(this,this.$2_F));this.shelfViewModel.remove_openTypeInPill(ss.Delegate.create(this,this.$2_D));})));this.disposables.add(spiff.TableauClickHandler.target(this.get_element()[0]).onDoubleClick(ss.Delegate.create(viewModel,viewModel.insertAdHocCalc)));this.dom=t;spiff.DragDropManager.attachDropTarget(this.dom.dropTarget,viewModel);}
tab.ShelfView.prototype={shelfViewModel:null,dom:null,$2_7:null,$2_9:null,$2_A:0,$2_B:0,get_preferredWidth:function(){if(!this.$2_B){this.$2_E();}return this.$2_B;},get_scrollableContentPreferredHeight:function(){if(!this.$2_A){this.$2_E();}return this.$2_A;},get_typeInPillView:function(){return this.$2_9;},setScrollableContentActualHeight:function(height){this.dom.pillHolder.css('height',(ss.isValue(height))?(height+'px'):'');},dispose:function(){this.$2_6.dispose();if(ss.isValue(this.$2_9)){this.$2_9.dispose();this.$2_9=null;}tab.ShelfView.callBaseMethod(this, 'dispose');},onAddedToDom:function(){tab.ShelfView.callBaseMethod(this, 'onAddedToDom');this.$2_C();},ensureItemInView:function(item){var $0=this.shelfViewModel.get_orientation()===1;var $1=($0)?item.position().left:item.position().top;var $2=$1+(($0)?item.outerWidth(true):item.outerHeight(true));var $3=this.get_scrollContainerSize();if($1<0){this.set_scroll($1);}else if($2>$3){this.set_scroll(this.get_scroll()+($2-$3+10));}},$2_C:function(){if(!this.get_addedToDom()){return;}if(ss.isValue(this.$2_9)){this.$2_9.onAddedToDom();}this.$2_E();this.$2_11();this.$2_12();this.raiseScrollContentChanged();if(ss.isValue(this.$2_9)){this.ensureItemInView(this.$2_9.get_element());}},initFromModel:function(vm){if(!ss.isValue(vm.get_pills())){return;}this.$2_6.dispose();this.dom.pillContent.toggleClass('tabAuthPillsHorizOverflow',false);this.dom.get_clickSpacer().remove();this.dom.get_dividers().remove();this.$2_8.clear();var $0=false;var $1=-1;var $2=false;if(this.shelfViewModel.get_hasTypeInPill()){$1=this.shelfViewModel.get_typeInPillCalculation().get_shelfPosition();if(ss.isNullOrUndefined(this.$2_9)){$2=true;this.$2_9=spiff.ObjectRegistry.newView(tab.TypeInPillView,this.shelfViewModel.get_typeInPillCalculation());}}else if(ss.isValue(this.$2_9)){this.$2_9.dispose();this.$2_9=null;}var $3;var $4=0;var $enum1=ss.IEnumerator.getEnumerator(vm.get_pills());while($enum1.moveNext()){var $5=$enum1.current;if(this.shelfViewModel.get_supportsMultiplePills()){$3=$(tab.ShelfCardTemplate.templatePillDivider);if(!$4){$3.addClass('tabAuthShelfPillDividerFirst');}this.dom.pillContent.append($3);this.$2_8.add($3);spiff.DragDropManager.attachDropTarget($3,this.shelfViewModel.createPillDividerDropTarget($4));}if($4===$1){if($2){this.$2_9.addToDom(this.dom.pillContent);}this.$2_9.set_pillViewModel($5);}else{var $6=spiff.ObjectRegistry.newView(tab.PillView,$5);this.$2_6.add($6);if($4<$1&&!$2){$6.get_element().insertBefore(this.$2_9.get_element());}else{this.dom.pillContent.append($6.get_element());}$0=$0||$6.get_hasExternalIcon();}$4++;}if(ss.isValue(vm.get_shelf())){this.dom.get_domRoot().attr('title',vm.get_shelf().get_tooltip());}if(this.shelfViewModel.get_supportsMultiplePills()){$3=$(tab.ShelfCardTemplate.templatePillDivider);this.dom.pillContent.append($3);this.$2_8.add($3);spiff.DragDropManager.attachDropTarget($3,this.shelfViewModel.createPillDividerDropTarget($4));}if($1>=$4){if($2){this.$2_9.addToDom(this.dom.pillContent);}this.$2_9.set_pillViewModel(null);}if(this.shelfViewModel.get_supportsMultiplePills()){var $7=$(tab.ShelfCardTemplate.templateClickSpacer);this.dom.pillContent.append($7);}this.dom.get_dividers().hide();this.dom.pillContent.toggleClass('tabHasExternalIcon',$0);this.$2_C();},$2_D:function($p0){if(ss.isNullOrUndefined(this.$2_9)){return;}if($p0&&this.shelfViewModel.get_orientation()===1){this.$2_E();this.$2_9.animateOpen(this.$2_15(),this.$2_14(),this.$2_13());}else{this.$2_9.onOpenCompleted();}this.ensureItemInView(this.$2_9.get_element());},$2_E:function(){this.dom.pillHolder.css('position','absolute');this.$2_A=this.dom.pillContent.outerHeight(true);this.$2_B=this.dom.pillContent.outerWidth(true);this.dom.pillHolder.css('position','relative');},$2_F:function($p0){if(ss.isValue($p0)&&($p0.akb||'insert')==='insert'){if(ss.isValue($p0.wz)&&$p0.wz<this.$2_8.length){var $0=this.$2_8[$p0.wz];if(this.$2_7===$0){return;}if(ss.isValue(this.$2_7)){this.dom.placeholdersIn(this.$2_7).hide();}this.dom.placeholdersIn($0).show();this.$2_7=$0;}}else{this.$2_7=null;this.dom.placeholdersIn(this.dom.pillHolder).hide();}},$2_10:function($p0){switch($p0){case 0:case 2:if(ss.isValue(this.$2_7)){this.dom.placeholdersIn(this.$2_7).toggle('fast');this.$2_7=null;}this.dom.get_dividers().hide();break;case 1:this.dom.get_dividers().css('display','');break;}},$2_11:function(){var $0=this.dom.pillContent.hasClass('tabAuthPillsHorizOverflow');var $1=this.shelfViewModel.get_orientation()===1&&this.get_preferredWidth()>this.dom.pillHolder.outerWidth();this.dom.pillContent.toggleClass('tabAuthPillsHorizOverflow',$1);if($0!==$1){this.$2_E();}},$2_12:function(){if(this.shelfViewModel.get_orientation()===1&&ss.isValue(this.$2_9)){var $0=this.$2_14();var $1=this.$2_13();if(this.shelfViewModel.get_animateTypeInPillPending()){var $2=this.$2_15();$0=$2;$1=$2;}this.$2_9.get_dom().get_domRoot().css('min-width',$0+'px');this.$2_9.get_dom().get_domRoot().css('max-width',$1+'px');this.$2_E();}},$2_13:function(){var $0=this.get_preferredWidth();if(ss.isValue(this.$2_9)){$0-=this.$2_9.get_dom().get_domRoot().outerWidth();}var $1=this.dom.pillContent.outerWidth()-$0-this.dom.get_clickSpacer().outerWidth();return Math.max($1,108);},$2_14:function(){return Math.min(this.$2_13(),250);},$2_15:function(){var $0=12;var $1=this.shelfViewModel.get_typeInPillCalculation().get_shelfPosition()<this.shelfViewModel.get_pills().length;if($1){var $2=this.dom.get_domRoot().find('.tabAuthShelfPill');$0=(ss.isValue($2)&&$2.length>0)?$2.first().outerWidth():148;}return $0;}}
tab.ShelfCardTemplate=function(){tab.ShelfCardTemplate.initializeBase(this,[$(tab.ShelfCardTemplate.template)]);this.pillHolder=this.getElementBySelector('.tabAuthShelfPills');this.pillContent=this.getElementBySelector('.tabAuthShelfPillsContent');this.dropTarget=this.getElementBySelector('.tabAuthShelfDropTarget');}
tab.ShelfCardTemplate.prototype={pillHolder:null,pillContent:null,dropTarget:null,get_dividers:function(){return this.getElementsBySelector('.tabAuthShelfPillDivider');},get_clickSpacer:function(){return this.getElementsBySelector('.tabAuthShelfClickArea');},placeholdersIn:function(divider){return divider.find('.tabAuthShelfPillDividerPlaceholder');}}
tab.ShowMeView=function(viewModel){this.perUpdateDisposables=new tab.DisposableHolder();tab.ShowMeView.initializeBase(this,[viewModel,new spiff.Template($('<div/>').addClass('tabAuthShowMe'))]);this.smViewModel=viewModel;this.smViewModel.initialize();this.smViewModel.add_propertyChanged(ss.Delegate.create(this,this.onViewModelPropertyChanged));this.smViewModel.set_closeOnInteraction(false);}
tab.ShowMeView.prototype={smViewModel:null,summaryDom:null,buttonsDom:null,onViewModelPropertyChanged:function(sender,e){tab.ShowMeView.callBaseMethod(this, 'onViewModelPropertyChanged',[sender,e]);if(e.get_propertyName()==='ShowMeCommands'){this.updateCommands();}},initContent:function(){this.summaryDom=$('<div/>').addClass('tabAuthShowMeSummary');this.buttonsDom=$('<div/>').addClass('tabAuthShowMeButtons');this.updateCommands();this.get_element().append(this.buttonsDom);this.get_element().append(this.summaryDom);},updateCommands:function(){if(ss.isNullOrUndefined(this.buttonsDom)){return;}this.buttonsDom.children().remove();this.perUpdateDisposables.dispose();var $0=tab.CommandsPresModelWrapper.create(this.smViewModel.get_showMeCommands());var $1=($0.get_defaultItem()||0);var $2=-1;var $enum1=ss.IEnumerator.getEnumerator($0.get_commandItems());while($enum1.moveNext()){var $3=$enum1.current;var $4=tab.CommandItemWrapper.create($3);$2++;if($4.get_commandsType()==='separator'){$('<div/>').addClass('tabAuthShowMeDivider').appendTo(this.buttonsDom);continue;}var $5=$('<div/>').addClass('tabAuthShowMeRow').appendTo(this.buttonsDom);if(ss.isNullOrUndefined($4.get_commands())){continue;}var $6=tab.CommandsPresModelWrapper.create($4.get_commands());var $7=-1;var $8=($6.get_defaultItem()||0);var $enum2=ss.IEnumerator.getEnumerator($6.get_commandItems());while($enum2.moveNext()){var $9=$enum2.current;$7++;var $A=$('<span/>').addClass('tabAuthShowMeButton').appendTo($5);if($7===$8&&$2===$1){this.setActiveItem($9,$A);}this.attachEventHandlers($9,$A);this.setCommandIcon($9,$A);}}},updateDescription:function(c){this.summaryDom.children().remove().end().append(this.$2_0(tab.CommandItemWrapper.create(c).get_description()));if(tab.BrowserSupport.get_isIE()&&tab.BrowserSupport.get_browserVersion()>=9){var $0=$(document.body);$0.css('z-index','1').css('z-index','0');}},setActiveItem:function(c,activeButton){this.get_element().find('.active').removeClass('active');activeButton.addClass('active');this.updateDescription(c);},setCommandIcon:function(c,obj){var $0=this.$2_1(tab.CommandItemWrapper.create(c).get_iconRes());if(ss.isValue($0)){var $1=$0;var $2=this.smViewModel.isCommandEnabled(c);obj.toggleClass('tabAuthShowMe-'+$1,$2);obj.toggleClass('tabAuthShowMeDisabled-'+$1,!$2);}},$2_0:function($p0){var $0=new RegExp("<img src=['\"]([^'\"]*)['\"][^>]*>",'g');var $1=null;var $2=[];do{$1=$0.exec($p0);if($1!=null){$2.push($1[1]);}}while(ss.isValue($1)&&$1.length>0);$p0=$p0.replace($0,'<img>');var $3=$($p0);if($3[0].tagName.toUpperCase()==='FONT'){$3=$3.children();}var $4=$3.find('img');if(ss.isValue($4)&&$4.length>0){$4.each(ss.Delegate.create(this,function($p1_0,$p1_1){
var $1_0=$($p1_1);var $1_1=this.$2_1($2[$p1_0]);if(!String.isNullOrEmpty($1_1)){$1_0.replaceWith($('<span>').css('display','inline-block').addClass('tabAuthShowMeIcon-'+$1_1));}}));}return $3;},$2_1:function($p0){var $0=new RegExp('/(\\w+)\\.png');var $1=tab.TabResources.lookupFullResourceAlias($p0).match($0);if(ss.isValue($1)&&$1.length>=2){return $1[1];}return null;}}
tab.SidebarCollapsedWidget=function(){tab.SidebarCollapsedWidget.initializeBase(this,[$("<div class='tabAuthSchemaCollapsed'>\n                <div class='tabAuthSchemaCollapsed collapsedItems'>\n                </div>\n            </div>")]);this.buttonHeader=this.get_element().find('.collapsedItems');this.contentArea=this.get_element().find('.tabAuthSchemaCollapsed');this.$1_7();if(tab.BrowserSupport.get_isIE()&&tab.BrowserSupport.get_browserVersion()<9){this.$1_3.addClass(this.$1_1);this.$1_4.addClass(this.$1_1);this.$1_3.get_labelElement().addClass(this.$1_1);this.$1_4.get_labelElement().addClass(this.$1_1);}}
tab.SidebarCollapsedWidget.prototype={$1_1:'ie678',dom:null,buttonHeader:null,contentArea:null,$1_2:null,$1_3:null,$1_4:null,add_expandButtonClicked:function(value){this.$1_5=ss.Delegate.combine(this.$1_5,value);},remove_expandButtonClicked:function(value){this.$1_5=ss.Delegate.remove(this.$1_5,value);},$1_5:null,add_tabButtonClicked:function(value){this.$1_6=ss.Delegate.combine(this.$1_6,value);},remove_tabButtonClicked:function(value){this.$1_6=ss.Delegate.remove(this.$1_6,value);},$1_6:null,get_width:function(){return this.get_element().width();},set_width:function(value){this.get_element().width(value);return value;},$1_7:function(){this.$1_2=new spiff.IconButton();this.$1_2.add_click(ss.Delegate.create(this,this.$1_8));this.$1_2.setIcon('tabAuthExpandIcon');this.$1_2.set_hoverTooltipText(tab.Strings.ExpandSchemaPane);this.$1_2.addClass('tabExpandSidebar');this.buttonHeader.append(this.$1_2.get_element());this.$1_3=spiff.LabelButton.newTextButton();this.$1_3.set_label(tab.Strings.AuthSchemaViewerHeaderData);this.$1_3.add_click(ss.Delegate.create(this,this.$1_9));this.$1_3.addClass('dataTabButton');this.contentArea.append(this.$1_3.get_element());this.$1_4=spiff.LabelButton.newTextButton();this.$1_4.set_label(tab.Strings.AuthLeftPaneTabLabelAnalytics);this.$1_4.add_click(ss.Delegate.create(this,this.$1_A));this.$1_4.addClass('analyticsTabButton');this.contentArea.append(this.$1_4.get_element());},$1_8:function(){if(ss.isValue(this.$1_5)){this.$1_5();}},$1_9:function(){if(ss.isValue(this.$1_6)){this.$1_6(this.$1_3.get_label());}},$1_A:function(){if(ss.isValue(this.$1_6)){this.$1_6(this.$1_4.get_label());}}}
tab.TooltipContentView=function(viewModel){tab.TooltipContentView.initializeBase(this,[viewModel,spiff.Template.fromHtml("<div class='tabTooltipContent'></div>")]);this.tooltipContentViewModel=viewModel;this.$2_0=spiff.StyledButton.createStyledButton(ss.Delegate.create(this,this.$2_1),tab.Strings.AuthResetTooltip,'tabTooltipContentReset',1);this.get_element().append(this.$2_0.get_element());}
tab.TooltipContentView.prototype={tooltipContentViewModel:null,$2_0:null,$2_1:function(){this.tooltipContentViewModel.resetTooltip();}}
tab.VizSummaryView=function(viewModel,t){tab.VizSummaryView.initializeBase(this,[viewModel,t]);this.$2_0=viewModel;this.$2_0.add_summaryChanged(ss.Delegate.create(this,this.update));this.t=t;}
tab.VizSummaryView.prototype={$2_0:null,t:null,dispose:function(){this.$2_0.remove_summaryChanged(ss.Delegate.create(this,this.update));tab.VizSummaryView.callBaseMethod(this, 'dispose');},update:function(){this.t.numDimensions.updateLabelCount(this.$2_0.get_numDimensions(),false);this.t.numMeasures.updateLabelCount(this.$2_0.get_numMeasures(),false);this.t.numSets.updateLabelCount(this.$2_0.get_numSets(),true);this.t.numParameters.updateLabelCount(this.$2_0.get_numParameters(),true);this.t.numCol.updateLabelCount(this.$2_0.get_numColumnShelfItems(),false);this.t.numRows.updateLabelCount(this.$2_0.get_numRowShelfItems(),false);this.t.numPages.updateLabelCount(this.$2_0.get_numPageShelfItems(),true);this.t.numFilters.updateLabelCount(this.$2_0.get_numFilterShelfItems(),true);this.t.shelfArea.toggle(this.$2_0.get_showShelves());this.t.layerArea.children('.tabAuthVizSummaryBadge').remove();var $enum1=ss.IEnumerator.getEnumerator(this.$2_0.get_layerMarkTypes());while($enum1.moveNext()){var $0=$enum1.current;var $1=new tab.VizSummaryBadgeTemplate();$1.get_domRoot().appendTo(this.t.layerArea).addClass('tabAuthVizSummaryMark-'+$0);}this.t.layerArea.toggle(this.$2_0.get_showLayers());}}
tab.VizSummaryTemplate=function(){tab.VizSummaryTemplate.initializeBase(this,[$("<div class='tabAuthVizSummary'>\n<div class='tabAuthVizSummaryArea tabAuthVizSummarySchema'>\n</div>\n<div class='tabAuthVizSummaryArea tabAuthVizSummaryShelf'>\n    <div class='tabAuthVizSummaryDivider'/>\n</div>\n<div class='tabAuthVizSummaryArea tabAuthVizSummaryLayers'>\n    <div class='tabAuthVizSummaryDivider'/>\n</div>\n<div class='tabAuthBorderRight'/>\n</div>")]);this.schemaArea=this.getElementBySelector('.tabAuthVizSummarySchema');this.shelfArea=this.getElementBySelector('.tabAuthVizSummaryShelf');this.layerArea=this.getElementBySelector('.tabAuthVizSummaryLayers');var $0=function($p1_0,$p1_1){
var $1_0=new tab.VizSummaryBadgeTemplate();$1_0.get_domRoot().appendTo($p1_1).addClass($p1_0);return $1_0;};this.numDimensions=$0('tabAuthVizSummaryDims',this.schemaArea);this.numMeasures=$0('tabAuthVizSummaryMeas',this.schemaArea);this.numSets=$0('tabAuthVizSummarySets',this.schemaArea);this.numParameters=$0('tabAuthVizSummaryParams',this.schemaArea);this.numCol=$0('tabAuthVizSummaryCols',this.shelfArea);this.numRows=$0('tabAuthVizSummaryRows',this.shelfArea);this.numPages=$0('tabAuthVizSummaryPages',this.shelfArea);this.numFilters=$0('tabAuthVizSummaryFilters',this.shelfArea);}
tab.VizSummaryTemplate.prototype={schemaArea:null,shelfArea:null,layerArea:null,numDimensions:null,numMeasures:null,numSets:null,numParameters:null,numCol:null,numRows:null,numPages:null,numFilters:null}
tab.VizSummaryBadgeTemplate=function(){tab.VizSummaryBadgeTemplate.initializeBase(this,[$("<div class='tabAuthVizSummaryBadge'><div class='tabAuthIcon'/><div class='tabAuthLabel'/></div>")]);this.label=this.getElementBySelector('.tabAuthLabel');}
tab.VizSummaryBadgeTemplate.prototype={label:null,updateLabelCount:function(count,hideIfZero){this.label.text(count.toString());this.get_domRoot().toggle(count>0||!hideIfZero);}}
tab.AuthoringCommandsViewModel=function(){this.$0={};}
tab.AuthoringCommandsViewModel.commandMenuItemClicked=function(menuItem){if(Type.getInstanceType(menuItem.get_data())===Function){(menuItem.get_data())();}else{var $0=menuItem.get_data();tab.ServerCommands.executeServerCommand($0,'immediately');}}
tab.AuthoringCommandsViewModel.prototype={update:function(commands){var $0=tab.CommandsPresModelWrapper.create(commands);Object.clearKeys(this.$0);if(ss.isNullOrUndefined($0)||ss.isNullOrUndefined($0.get_commandItems())){return;}var $enum1=ss.IEnumerator.getEnumerator($0.get_commandItems());while($enum1.moveNext()){var $1=$enum1.current;this.$1($1);}},$1:function($p0){var $0=tab.CommandItemWrapper.create($p0);switch($0.get_commandsType()){case 'item':var $1=tab.CommandSerializer.deserialize($0.get_command());if($1.commandNamespace==='tabdoc'){var $2=this.$0[$1.commandName];if(ss.isNullOrUndefined($2)){this.$0[$1.commandName]=$2=[];}$2.add($p0);}break;case 'subcommands':var $3=tab.CommandsPresModelWrapper.create($0.get_commands());var $enum1=ss.IEnumerator.getEnumerator($3.get_commandItems());while($enum1.moveNext()){var $4=$enum1.current;this.$1($4);}break;}},commandsCount:function(){return Object.getKeyCount(this.$0);},getCommands:function(commandKey){return this.$0[commandKey];},createMenuItem:function(commandType,text,expectedNumberOfCommands,predicate,commandParams){var $0=this.$0[commandType];var $enum1=ss.IEnumerator.getEnumerator($0);while($enum1.moveNext()){var $1=$enum1.current;var $2=tab.CommandItemWrapper.create($1);var $3=tab.CommandSerializer.deserialize($2.get_command());if(predicate($3)){var $4=($2.get_isRadioOn())?spiff.MenuItemCheckState.radio:spiff.MenuItemCheckState.none;if($2.get_isChecked()){$4=spiff.MenuItemCheckState.check;}if(ss.isValue(commandParams)){$3.commandParams=commandParams;}var $5=spiff.MenuItem.newItem($3,text,$4);$5.set_enabled(!ss.isValue($2.get_enabled())||$2.get_enabled());return $5;}}throw Error.createError("Couldn't create a menu item for the '"+commandType+"' command.",null);},createCommandMenuItem:function(commandType,text,commandParam){return this.createMenuItem(commandType,text,1,function($p1_0){
return $p1_0.commandName===commandType;},commandParam);}}
tab.CategoricalColorOptionViewModel=function(layerEncondingModel){tab.CategoricalColorOptionViewModel.initializeBase(this,[layerEncondingModel]);this.$1_3=new tab.ColorPalettePickerViewModel(this.get_selectedColorPalette(),tab.ApplicationModel.get_instance().get_colorPalettes().get_catColorPaletteGroups());this.$1_3.add_propertyChanged(ss.Delegate.create(this,function($p1_0,$p1_1){
if($p1_1.get_propertyName()==='SelectedPalette'){this.set_selectedColorPalette(this.$1_3.get_selectedPalette());}}));}
tab.CategoricalColorOptionViewModel.prototype={$1_3:null,get_selectedColorPalette:function(){if(ss.isValue(this.get_layerEncodingModel().get_colorEncodingDropdown().atl)){return this.get_layerEncodingModel().get_colorEncodingDropdown().atl.ne;}return '';},set_selectedColorPalette:function(value){tab.PaneClientCommands.setCatColorPalette(this.get_layerEncodingModel(),value);return value;},get_viewType:function(){return tab.CategoricalColorOptionView;},get_palettePickerViewModel:function(){return this.$1_3;},handleUpdatedLayerEncoding:function(){this.get_palettePickerViewModel().set_selectedPalette(this.get_layerEncodingModel().get_colorEncodingDropdown().atl.ne);}}
tab.ColorTransparencyControlViewModel=function(model){tab.ColorTransparencyControlViewModel.initializeBase(this);this.$1_1=model;this.$1_0=new tab.LinearRangeTransform(0,255);this.$1_1.add_newLayerEncoding(ss.Delegate.create(this,this.$1_4));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$1_1.remove_newLayerEncoding(ss.Delegate.create(this,this.$1_4));})));}
tab.ColorTransparencyControlViewModel.$1_3=function($p0){return Math.round($p0*100)/100;}
tab.ColorTransparencyControlViewModel.prototype={$1_0:null,$1_1:null,add_sliderFractionUpdated:function(value){this.$1_2=ss.Delegate.combine(this.$1_2,value);},remove_sliderFractionUpdated:function(value){this.$1_2=ss.Delegate.remove(this.$1_2,value);},$1_2:null,get_viewType:function(){return tab.ColorTransparencyControlView;},get_viewModel:function(){return this;},get_layerEncodingModel:function(){return this.$1_1;},get_alphaLevel:function(){return this.get_layerEncodingModel().get_colorEncodingDropdown().xq;},set_alphaLevel:function(value){var $0=Math.round(value);if($0!==Math.round(this.get_alphaLevel())){tab.PaneClientCommands.setColorAlphaLevel(this.get_layerEncodingModel(),$0);}return value;},getCurrentFraction:function(){return tab.ColorTransparencyControlViewModel.$1_3(this.$1_0.valueToFraction(this.get_alphaLevel()));},setCurrentFraction:function(newValue){this.set_alphaLevel(this.$1_0.fractionToValue(tab.ColorTransparencyControlViewModel.$1_3(newValue)));},$1_4:function(){this.$1_2(this.getCurrentFraction());}}
tab.LinePatternPickerViewModel=function(){this.$1_0='none';tab.LinePatternPickerViewModel.initializeBase(this);}
tab.LinePatternPickerViewModel.prototype={get_selectedLinePattern:function(){return this.$1_0;},set_selectedLinePattern:function(value){if(this.$1_0===value){return;}this.$1_0=value;this.notifyPropertyChanged('SelectedLinePattern');return value;}}
tab.StrokeWidthPickerViewModel=function(){tab.StrokeWidthPickerViewModel.initializeBase(this);}
tab.StrokeWidthPickerViewModel.prototype={$1_0:1,get_selectedStrokeWidth:function(){return this.$1_0;},set_selectedStrokeWidth:function(value){if(this.$1_0===value){return;}this.$1_0=value;this.notifyPropertyChanged('SelectedStrokeWidth');return value;}}
tab.QuantitativeColorOptionViewModel=function(layerEncodingModel){tab.QuantitativeColorOptionViewModel.initializeBase(this,[layerEncodingModel]);this.$1_9=layerEncodingModel.get_colorEncodingDropdown().atk.xt;this.$1_A=this.$1_9>=2;this.$1_B=layerEncodingModel.get_colorEncodingDropdown().atk.ez;this.$1_7=new tab.ColorPalettePickerViewModel(this.get_selectedColorPalette(),tab.ApplicationModel.get_instance().get_colorPalettes().get_qColorPaletteGroups());this.$1_7.add_propertyChanged(ss.Delegate.create(this,function($p1_0,$p1_1){
if($p1_1.get_propertyName()==='SelectedPalette'){this.set_selectedColorPalette(this.$1_7.get_selectedPalette());}}));this.$1_8=new tab.StepperControlViewModel(2,100,1,(this.$1_A)?this.$1_9:5);this.$1_8.textClass=tab.QuantitativeColorOptionViewModel.colorStepTextClassName;this.$1_8.set_isEnabled(this.$1_A);this.$1_8.add_propertyChanged(ss.Delegate.create(this,function($p1_0,$p1_1){
if($p1_1.get_propertyName()===tab.StepperControlViewModel.valueProperty){this.set_stepCount(this.$1_8.get_value());}}));}
tab.QuantitativeColorOptionViewModel.$1_E=function($p0){return ss.isValue($p0)&&$p0>0&&isFinite($p0);}
tab.QuantitativeColorOptionViewModel.prototype={$1_7:null,$1_8:null,$1_9:0,$1_A:false,$1_B:false,add_isSteppedChanged:function(value){this.$1_C=ss.Delegate.combine(this.$1_C,value);},remove_isSteppedChanged:function(value){this.$1_C=ss.Delegate.remove(this.$1_C,value);},$1_C:null,add_isReversedChanged:function(value){this.$1_D=ss.Delegate.combine(this.$1_D,value);},remove_isReversedChanged:function(value){this.$1_D=ss.Delegate.remove(this.$1_D,value);},$1_D:null,get_viewType:function(){return tab.QuantitativeColorOptionView;},get_palettePickerViewModel:function(){return this.$1_7;},get_stepperControlViewModel:function(){return this.$1_8;},get_isStepped:function(){return this.$1_A;},set_isStepped:function(value){if(this.$1_A===value){return;}this.$1_A=value;if(ss.isValue(this.$1_C)){this.$1_C(this.$1_A);}return value;},get_stepCount:function(){return this.$1_9;},set_stepCount:function(value){if(tab.QuantitativeColorOptionViewModel.$1_E(value)&&this.$1_9!==value){this.$1_9=value;tab.PaneClientCommands.setSteppedColor(this.get_layerEncodingModel(),this.$1_9);}return value;},get_isReversed:function(){return this.$1_B;},set_isReversed:function(value){if(this.$1_B===value){return;}this.$1_B=value;if(ss.isValue(this.$1_D)){this.$1_D(this.$1_B);}return value;},get_selectedColorPalette:function(){return this.get_layerEncodingModel().get_colorEncodingDropdown().atk.ne;},set_selectedColorPalette:function(value){tab.PaneClientCommands.setQuantColorPalette(this.get_layerEncodingModel(),value);return value;},toggleColorReversal:function(){tab.PaneClientCommands.reverseColor(this.get_layerEncodingModel(),!this.get_isReversed());},toggleIsStepped:function(){this.set_isStepped(!this.get_isStepped());this.get_stepperControlViewModel().set_isEnabled(this.get_isStepped());tab.PaneClientCommands.setSteppedColor(this.get_layerEncodingModel(),(this.get_isStepped())?this.get_stepperControlViewModel().get_value():0);},handleUpdatedLayerEncoding:function(){this.get_palettePickerViewModel().set_selectedPalette(this.get_layerEncodingModel().get_colorEncodingDropdown().atk.ne);this.set_isReversed(this.get_layerEncodingModel().get_colorEncodingDropdown().atk.ez);this.set_isStepped(this.get_layerEncodingModel().get_colorEncodingDropdown().atk.xt>=2);this.get_stepperControlViewModel().set_isEnabled(this.get_isStepped());this.$1_8.set_value(this.get_layerEncodingModel().get_colorEncodingDropdown().atk.xt);},dispose:function(){if(ss.isValue(this.$1_7)){this.$1_7.dispose();}if(ss.isValue(this.$1_8)){this.$1_8.dispose();}tab.QuantitativeColorOptionViewModel.callBaseMethod(this, 'dispose');}}
tab.ColorOptionViewModel=function(model){tab.ColorOptionViewModel.initializeBase(this);this.$1_0=model;this.transparencyControlViewModel=new tab.ColorTransparencyControlViewModel(this.$1_0);this.patternPickerViewModel=new tab.LinePatternPickerViewModel();this.widthPickerViewModel=new tab.StrokeWidthPickerViewModel();this.$1_0.add_newLayerEncoding(ss.Delegate.create(this,this.handleUpdatedLayerEncoding));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$1_0.remove_newLayerEncoding(ss.Delegate.create(this,this.handleUpdatedLayerEncoding));})));}
tab.ColorOptionViewModel.prototype={$1_0:null,transparencyControlViewModel:null,patternPickerViewModel:null,widthPickerViewModel:null,add_commitChanges:function(value){this.$1_1=ss.Delegate.combine(this.$1_1,value);},remove_commitChanges:function(value){this.$1_1=ss.Delegate.remove(this.$1_1,value);},$1_1:null,get_layerEncodingModel:function(){return this.$1_0;},get_colorTransparencyControlViewModel:function(){return this.transparencyControlViewModel;},get_linePatternPickerViewModel:function(){return this.patternPickerViewModel;},get_strokeWidthPickerViewModel:function(){return this.widthPickerViewModel;},get_viewModel:function(){return this;},get_viewType:function(){return tab.ColorOptionView;},handleUpdatedLayerEncoding:function(){},disposeViewModel:function(){this.dispose();},updateUberPopupViewModel:function(vm){vm.add_commit(ss.Delegate.create(this,this.$1_2));vm.addDisposables(new tab.CallOnDispose(ss.Delegate.create(this,function(){
vm.remove_commit(ss.Delegate.create(this,this.$1_2));})));},$1_2:function(){if(ss.isValue(this.$1_1)){this.$1_1();}},dispose:function(){this.transparencyControlViewModel.dispose();this.patternPickerViewModel.dispose();this.widthPickerViewModel.dispose();tab.ColorOptionViewModel.callBaseMethod(this, 'dispose');}}
tab.ColorPalettePickerViewModel=function(selectedPalette,paletteGroups){this.$1_1=[];tab.ColorPalettePickerViewModel.initializeBase(this);this.$1_3=selectedPalette;this.$1_2=0;this.$1_0=paletteGroups;this.$1_4();}
tab.ColorPalettePickerViewModel.prototype={$1_0:null,$1_2:0,$1_3:null,get_selectedPalette:function(){return this.$1_3;},set_selectedPalette:function(value){if(value!==this.$1_3){this.$1_3=value;this.notifyPropertyChanged('SelectedPalette');}return value;},get_automaticPaletteSelected:function(){return String.isNullOrEmpty(this.$1_3)||this.$1_3===tab.Strings.AuthColorPaletteAutomatic;},set_automaticPaletteSelected:function(value){if(value){this.$1_3='';}return value;},get_currentPageIndex:function(){return this.$1_2;},set_currentPageIndex:function(value){var $0=Math.min(Math.max(0,value),this.$1_1.length-1);if($0!==this.$1_2){this.$1_2=$0;this.notifyPropertyChanged('CurrentPage');}return value;},get_isAtLastPage:function(){return this.get_currentPageIndex()===this.$1_1.length-1;},get_isAtFisrtPage:function(){return !this.get_currentPageIndex();},get_pages:function(){return this.$1_1;},get_currentPage:function(){return this.$1_1[this.$1_2];},get_paletteCollectionModel:function(){return tab.ApplicationModel.get_instance().get_colorPalettes();},$1_4:function(){this.$1_1=[];var $0=Math.ceil(this.$1_0.length/2);for(var $1=0;$1<$0;$1++){var $2=new tab.PalettePage();var $3=$1*2;for(var $4=$3;$4<$3+2;$4++){$2.addGroup(this.get_paletteCollectionModel().colorPaletteGroup(this.$1_0[$4]));}this.$1_1.add($2);}if(this.$1_5()){this.$1_1.add(new tab.PalettePage());}},$1_5:function(){return !this.get_automaticPaletteSelected()&&!_.any(this.$1_0,ss.Delegate.create(this,function($p1_0){
return _.any($p1_0.zt,ss.Delegate.create(this,function($p2_0){
var $2_0=this.get_paletteCollectionModel().get_colorPalettes()[$p2_0];return $2_0.ne===this.get_selectedPalette();}));}));}}
tab.ColorPaletteItem=function(presModel){this.paletteLabel=presModel.nf;this.paletteName=presModel.ne;this.type=presModel.alk;this.colors=presModel.agy;}
tab.ColorPaletteItem.prototype={paletteName:null,paletteLabel:null,type:null,colors:null}
tab.ColorPaletteGroup=function(palettePresModels){this.paletteItems=_.map(palettePresModels,function($p1_0){
return new tab.ColorPaletteItem($p1_0);});}
tab.ColorPaletteGroup.prototype={paletteItems:null}
tab.PalettePage=function(){this.$0=[];}
tab.PalettePage.prototype={$0:null,get_isCustomPalettePage:function(){return !this.$0.length;},get_paletteGroups:function(){return this.$0;},addGroup:function(group){this.$0.push(new tab.ColorPaletteGroup(group));}}
tab.TextEncodingOptionViewModel=function(model){tab.TextEncodingOptionViewModel.initializeBase(this);this.$1_0=model;this.$1_0.add_newLayerEncoding(ss.Delegate.create(this,this.update));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$1_0.remove_newLayerEncoding(ss.Delegate.create(this,this.update));})));this.$1_1=this.$1_0.get_textEncodingDropdown().c;}
tab.TextEncodingOptionViewModel.prototype={$1_0:null,$1_1:false,add_labelsOnChanged:function(value){this.$1_2=ss.Delegate.combine(this.$1_2,value);},remove_labelsOnChanged:function(value){this.$1_2=ss.Delegate.remove(this.$1_2,value);},$1_2:null,get_layerEncodingModel:function(){return this.$1_0;},get_labelsOn:function(){return this.$1_1;},set_labelsOn:function(value){if(this.$1_1!==value){this.$1_1=value;if(ss.isValue(this.$1_2)){this.$1_2(this.$1_1);}}return value;},get_controlLabel:function(){return this.$1_0.get_textEncodingDropdown().rw;},get_viewType:function(){return tab.TextEncodingOptionView;},get_viewModel:function(){return this;},disposeViewModel:function(){this.dispose();},updateUberPopupViewModel:function(vm){},toggleLabels:function(){tab.PaneClientCommands.toggleMarkLabels(this.get_layerEncodingModel());},update:function(){this.set_labelsOn(this.get_layerEncodingModel().get_textEncodingDropdown().c);}}
tab.CalculationDialogView=function(viewModel){tab.CalculationDialogView.initializeBase(this,[viewModel,new tab.CalculationDialogTemplate()]);this.calcViewModel.add_dirtyStateChanged(ss.Delegate.create(this,this.$2_1A));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.calcViewModel.remove_dirtyStateChanged(ss.Delegate.create(this,this.$2_1A));})));}
tab.CalculationDialogView.prototype={$2_10:null,$2_11:null,$2_12:null,$2_13:null,$2_14:null,$2_15:null,$2_16:null,$2_17:null,$2_18:null,get_editableCaption:function(){return this.$2_10;},get_dialog:function(){return this.$2_13;},get_$2_19:function(){return this.get_template();},initDom:function(){this.$2_16=spiff.StyledTextButton.createSecondaryButton(ss.Delegate.create(this,this.applyCalc),tab.Strings.CalcEditorApply,'tabCalcEditorApplyButton',spiff.ButtonSize.medium,1);this.get_$2_19().get_buttonArea().append(this.$2_16.get_element());this.disposables.add(this.$2_16);this.$2_27();this.$2_16.set_hoverTooltipText((tab.BrowserSupport.get_isMac())?tab.Strings.CalcEditorApplyTooltipMac:tab.Strings.CalcEditorApplyTooltip);this.$2_17=spiff.StyledTextButton.createPrimaryButton(ss.Delegate.create(this,this.applyCalcAndClose),tab.Strings.DialogButtonOK,'tabCalcEditorOkButton',spiff.ButtonSize.medium,2);this.get_$2_19().get_buttonArea().append(this.$2_17.get_element());this.disposables.add(this.$2_17);this.$2_17.set_hoverTooltipText(tab.Strings.CalcEditorOkButtonTooltip);this.get_$2_19().get_statusErrorText().text(tab.Strings.CalcEditorCalcError);this.get_$2_19().get_statusOkText().text(tab.Strings.CalcEditorCalcOk);this.$2_14=new spiff.Button(this.get_$2_19().get_statusErrorButton());this.$2_14.add_click(ss.Delegate.create(this,this.$2_22));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$2_14.remove_click(ss.Delegate.create(this,this.$2_22));this.$2_14.dispose();})));this.$2_15=new spiff.Button(this.get_$2_19().get_dependenciesButton());this.$2_15.add_click(ss.Delegate.create(this,this.$2_24));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$2_15.remove_click(ss.Delegate.create(this,this.$2_24));this.$2_15.dispose();})));this.calcViewModel.add_applyErrorMessageCompleted(ss.Delegate.create(this,this.$2_2B));this.calcViewModel.add_applyCalculationSuccess(ss.Delegate.create(this,this.$2_1B));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.calcViewModel.remove_applyErrorMessageCompleted(ss.Delegate.create(this,this.$2_2B));this.calcViewModel.remove_applyCalculationSuccess(ss.Delegate.create(this,this.$2_1B));})));this.$2_1D();tab.CalculationDialogView.callBaseMethod(this, 'initDom');},ensureDialogIsOnScreen:function(){if(ss.isNullOrUndefined(this.$2_13)){return;}this.$2_13.ensureOnScreen();},onCalculationCanceled:function(){tab.CalculationDialogView.callBaseMethod(this, 'onCalculationCanceled');this.$2_13.close();},$2_1A:function($p0){this.$2_27();},$2_1B:function($p0){if($p0){this.$2_13.close();}},applyCalc:function(){this.calcViewModel.applyCalculation(null,false);},applyCalcAndClose:function(){this.calcViewModel.applyCalculation(null,true);},updateDomFromModel:function(){this.$2_10.set_text(this.calcViewModel.get_caption());this.$2_20();this.$2_21();tab.CalculationDialogView.callBaseMethod(this, 'updateDomFromModel');},$2_1C:function($p0,$p1){if($p1.get_propertyName()===spiff.ToggleButton.selectedProperty){this.$2_18.get_element().toggleClass('shown',($p0).get_selected());}},$2_1D:function(){if(ss.isValue(this.$2_18)){return;}var $0=!!tab.FeatureParamsLookup.getBool(tab.FeatureParam.calcDialogFuncList);if(!$0){return;}this.$2_18=spiff.ObjectRegistry.newView(tab.CalculationFunctionListView,this.calcViewModel.get_functionListViewModel());this.$2_18.add_doubleClickedItem(ss.Delegate.create(this,this.$2_2C));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$2_18.remove_doubleClickedItem(ss.Delegate.create(this,this.$2_2C));this.$2_18.dispose();this.$2_18=null;})));},createDialog:function(){this.$2_13=new spiff.Dialog('',this.get_element());this.$2_13.disableTextSelection();this.$2_13.configMoveDragSource(function($p1_0){
return new tab.vqlauthoring$7($p1_0);});this.$2_13.get_dialogElement().addClass('tabCalcEditDialog');this.$2_13.get_dialogElement().addClass(tab.PaneTableView.suppressVizTooltipsAndOverlays);this.$2_13.set_resizeable(true);this.$2_13.add_closing(ss.Delegate.create(this,this.$2_28));this.$2_13.add_closed(ss.Delegate.create(this,this.$2_29));this.$2_13.add_resizeEnd(ss.Delegate.create(this,this.$2_2A));this.$2_10=spiff.EditableTextView.newEditableTextView(this.calcViewModel.get_caption(),'');this.$2_10.add_committed(ss.Delegate.create(this,this.$2_25));this.$2_10.add_propertyChanged(ss.Delegate.create(this,this.$2_26));this.$2_10.add_hoverStateChanged(ss.Delegate.create(this,this.$2_1E));var $0=ss.Delegate.create(this,function(){
this.$2_1E(this.$2_10.get_element().hasClass('hover'));});this.$2_10.add_editing($0);this.$2_10.add_committed($0);this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$2_13.remove_closing(ss.Delegate.create(this,this.$2_28));this.$2_13.remove_closed(ss.Delegate.create(this,this.$2_29));this.$2_13.remove_resizeEnd(ss.Delegate.create(this,this.$2_2A));this.$2_13.dispose();this.$2_10.remove_committed(ss.Delegate.create(this,this.$2_25));this.$2_10.remove_propertyChanged(ss.Delegate.create(this,this.$2_26));this.$2_10.remove_hoverStateChanged(ss.Delegate.create(this,this.$2_1E));this.$2_10.remove_editing($0);this.$2_10.remove_committed($0);this.$2_10.dispose();})));this.$2_11=new tab.CalculationTitleAreaTemplate();this.$2_13.get_titleBarElement().find('.tab-dialogTitle').append(this.$2_11.get_domRoot());this.disposables.add(this.$2_11);if(ss.isNullOrUndefined(this.$2_18)){return;}this.$2_13.get_element().prepend($("<div class='tabCalcEditorFunctionFlyoutCover'/>"));this.$2_13.get_element().prepend(this.$2_18.get_element());this.$2_18.onAddedToDom();var $1=new tab.FunctionFlyoutControlTemplate();this.$2_12=new spiff.ToggleButton($1.get_domRoot(),'flyoutShown');this.$2_12.add_propertyChanged(ss.Delegate.create(this,this.$2_1C));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$2_12.remove_propertyChanged(ss.Delegate.create(this,this.$2_1C));})));this.$2_12.addToDom(this.$2_13.get_element());this.disposables.add(this.$2_12);this.disposables.add($1);this.$2_12.set_selected(false);},$2_1E:function($p0){this.$2_11.get_dataSourceLabel().css('display',(this.$2_10.get_isEditing()||$p0)?'none':'inline-block');},$2_1F:function(){var $0=this.calcViewModel.get_shouldShowDataSourceCaption();this.$2_11.get_dataSourceIcon().toggle($0);if($0){this.$2_11.get_dataSourceLabelText().text(this.calcViewModel.get_dataSourceCaption());}this.$2_11.get_dataSourceLabel().css('left',this.$2_10.get_textDisplayWidth()+'px');},onCalculationEdited:function(){if(ss.isNullOrUndefined(this.$2_13)){this.createDialog();}var $0=!this.get_dialog().get_isShown();if($0){this.get_dialog().show();this.onAddedToDom();this.$2_10.addToDom(this.$2_11.get_captionContainer());}tab.CalculationDialogView.callBaseMethod(this, 'onCalculationEdited');this.$2_1F();this.$2_27();if($0){if(this.calcViewModel.get_isNewCalculation()){this.$2_10.edit();}else{this.focusEditor();}}else{if(this.$2_10.get_isEditing()){tab.DomUtil.selectAllInputText(this.$2_10.get_inputElement());}else{this.get_editor().execCommand('goDocEnd');}}},$2_20:function(){this.get_$2_19().get_statusOk().toggle(!this.calcViewModel.get_hasErrors());this.get_$2_19().get_statusError().toggle(this.calcViewModel.get_hasErrors());},$2_21:function(){this.get_$2_19().get_dependenciesButton().css('visibility',(this.calcViewModel.get_hasDependencies())?'visible':'hidden');},$2_22:function(){var $0=_.map(this.calcViewModel.get_errors(),function($p1_0){
return spiff.MenuItem.newItem($p1_0,$p1_0.oz);});spiff.MenuViewModel.createForMenu(new spiff.Menu($0),ss.Delegate.create(this,this.$2_23)).show(spiff.ShowMenuOptions.create(this.get_$2_19().get_statusErrorText()));},$2_23:function($p0){var $0=$p0.get_data();var $1=tab.CalculationEditorView.getNewLineOffset(this.calcViewModel.get_formula().substr(0,$0.yc));var $2=this.get_editor().posFromIndex($0.yc-$1);var $3=this.get_editor().posFromIndex($0.yc+$0.yd-$1);this.get_editor().setCursor($2);this.focusEditor();this.get_editor().setSelection($2,$3);},$2_24:function(){this.$2_15.get_element().addClass('tabOpen');var $0=spiff.UberPopupViewModel.createForContent(new tab.CalculationDependencyViewModel(this.calcViewModel.get_dependencies(),this.get_element().outerWidth()));var $1=new spiff.UberPopupShowOptions(this.get_$2_19().get_dependenciesButton(),spiff.UberPopupHorizontalAlign.left);$1.limitPopupHeight=true;$0.show($1);$0.add_hidden(ss.Delegate.create(this,function(){
this.$2_15.get_element().removeClass('tabOpen');}));},$2_25:function(){if(String.isNullOrEmpty(this.$2_10.get_text())){this.$2_10.set_text(this.calcViewModel.get_caption());}else{this.calcViewModel.set_caption(this.$2_10.get_text());}this.$2_1F();},$2_26:function($p0,$p1){if($p1.get_propertyName()===spiff.TextInputView.textPropertyName){if(ss.isNullOrUndefined(this.$2_16)||ss.isNullOrUndefined(this.$2_10)){return;}this.$2_16.set_disabled(!(this.calcViewModel.isCaptionStringDirty(this.$2_10.get_text())||this.calcViewModel.get_isFormulaDirty()));}},$2_27:function(){if(ss.isNullOrUndefined(this.$2_16)){return;}this.$2_16.set_disabled(!this.calcViewModel.get_isDirty());},$2_28:function($p0,$p1){document.activeElement.blur();},$2_29:function($p0,$p1){this.calcViewModel.cancelCalculation();},$2_2A:function(){this.get_editor().refresh();this.$2_18.handleResize();},$2_2B:function(){this.focusEditor();},$2_2C:function($p0){var $0=this.get_editor().indexFromPos(this.get_editor().getCursor());var $1=tab.CalculationEditorView.getSelection(this.get_editor());if(ss.isNullOrUndefined($1)){$1={};$1.yi=$0;$1.yj=$0;}this.calcViewModel.insertFunction($p0,$1);}}
tab.vqlauthoring$7=function(dialog){tab.vqlauthoring$7.initializeBase(this,[dialog.get_titleBarElement(),dialog.get_element()]);this.set_documentBodySize('useClientSize');}
tab.CalculationTitleAreaTemplate=function(){tab.CalculationTitleAreaTemplate.initializeBase(this,[$("\n<div class='tabCalcEditorTitleArea'>\n  <div class='tabCalcEditorCaptionContainer'/>\n  <div class='tabCalcEditorDataSourceLabel'><div class='tabCalcEditorDatasourceIcon'/><span/></div>\n</div>")]);this.$1_1=this.getElementBySelector('.tabCalcEditorCaptionContainer');this.$1_2=this.getElementBySelector('.tabCalcEditorDataSourceLabel');this.$1_3=this.getElementBySelector('.tabCalcEditorDatasourceIcon');}
tab.CalculationTitleAreaTemplate.prototype={$1_1:null,$1_2:null,$1_3:null,get_captionContainer:function(){return this.$1_1;},get_dataSourceLabel:function(){return this.$1_2;},get_dataSourceLabelText:function(){return this.$1_2.find('span');},get_dataSourceIcon:function(){return this.$1_3;}}
tab.FunctionFlyoutControlTemplate=function(){tab.FunctionFlyoutControlTemplate.initializeBase(this,[$("\n<div class='tabCalcEditorFuncFlyoutControl'>\n    <div class='tabCalcEditorFuncFlyoutExpander'/>\n    <div class='tabCalcEditorFuncFlyoutCollapser'/>\n    <div class='tabCalcEditorFuncFlyoutControlHit'/>\n</div>")]);}
tab.CalculationDialogTemplate=function(){tab.CalculationDialogTemplate.initializeBase(this,[$(tab.CalculationDialogTemplate.$1_0)]);this.$1_B=this.getElementBySelector('.tabCalcEditorBody');this.$1_1=this.getElementBySelector('.tabCalcEditorCmHolder');this.$1_2=this.getElementBySelector('.tabCalcEditorDropTarget');this.$1_3=this.getElementBySelector('.tabCalcEditorBtnArea');this.$1_4=this.getElementBySelector('.tabCalcEditorControlArea');this.$1_8=this.getElementBySelector('.tabCalcEditorStatusErrorText');this.$1_9=this.getElementBySelector('.tabCalcEditorStatusOkText');this.$1_5=this.getElementBySelector('.tabCalcEditorStatusError');this.$1_7=this.getElementBySelector('.tabCalcEditorStatusErrorBtn');this.$1_6=this.getElementBySelector('.tabCalcEditorStatusOk');this.$1_A=this.getElementBySelector('.tabCalcEditorDependsBtn');this.getElementBySelector('.tabCalcEditorAffectedSheets').text(tab.Strings.CalcEditorAffectedSheets);}
tab.CalculationDialogTemplate.prototype={$1_1:null,$1_2:null,$1_3:null,$1_4:null,$1_5:null,$1_6:null,$1_7:null,$1_8:null,$1_9:null,$1_A:null,$1_B:null,get_calcEditorBody:function(){return this.$1_B;},get_formulaEditorHolder:function(){return this.$1_1;},get_dragSource:function(){return this.$1_1;},get_dropTarget:function(){return this.$1_2;},get_dropInviteBorder:function(){return this.$1_1;},get_buttonArea:function(){return this.$1_3;},get_controlArea:function(){return this.$1_4;},get_statusError:function(){return this.$1_5;},get_statusErrorButton:function(){return this.$1_7;},get_statusOk:function(){return this.$1_6;},get_statusErrorText:function(){return this.$1_8;},get_statusOkText:function(){return this.$1_9;},get_dependenciesButton:function(){return this.$1_A;}}
tab.CalculationFunctionListView=function(viewModel){tab.CalculationFunctionListView.initializeBase(this,[viewModel,new tab.CalculationFunctionListTemplate()]);this.$2_0=viewModel;this.$2_1=this.get_template();}
tab.CalculationFunctionListView.prototype={$2_0:null,$2_1:null,$2_2:null,$2_3:null,$2_4:null,$2_5:null,$2_6:null,$2_7:null,add_doubleClickedItem:function(value){this.$2_8=ss.Delegate.combine(this.$2_8,value);},remove_doubleClickedItem:function(value){this.$2_8=ss.Delegate.remove(this.$2_8,value);},$2_8:null,get_dom:function(){return this.$2_1;},get_listView:function(){return this.$2_2;},get_funcInfo:function(){return this.$2_6;},get_funcTypeVm:function(){return this.$2_3;},get_searchTextInputView:function(){return this.$2_4;},onAddedToDom:function(){tab.CalculationFunctionListView.callBaseMethod(this, 'onAddedToDom');this.$2_2=spiff.ListView.createListView(this.$2_0.get_listViewModel(),false);this.$2_5=new spiff.ScrollableViewModel(false);this.$2_5.set_content(this.$2_2.get_element()[0]);this.$2_5.set_scrollY(true);this.disposables.add(this.$2_5);var $0=spiff.ScrollableView.createScrollableView(this.$2_5);$0.addToDom(this.$2_1.get_functionListArea());this.$2_2.useScrollableView($0);this.$2_6=new tab.CalculationFunctionInfoTemplate();this.$2_7=new spiff.ScrollableViewModel(false);this.$2_7.set_content(this.get_funcInfo().get_domRoot().get(0));this.$2_7.set_scrollY(true);this.disposables.add(this.$2_7);this.disposables.add(this.$2_6);var $1=spiff.ScrollableView.createScrollableView(this.$2_7);$1.addToDom(this.$2_1.get_functionInfoArea());this.$2_2.tabIndex(0);this.$2_2.add_selectionChanged(ss.Delegate.create(this,this.$2_E));this.$2_2.add_submitSelection(ss.Delegate.create(this,this.$2_F));this.$2_2.add_listItemsUpdated(ss.Delegate.create(this,this.$2_D));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$2_2.remove_selectionChanged(ss.Delegate.create(this,this.$2_E));this.$2_2.remove_submitSelection(ss.Delegate.create(this,this.$2_F));this.$2_2.remove_listItemsUpdated(ss.Delegate.create(this,this.$2_D));this.$2_2.dispose();})));this.$2_3=new tab.ComboBoxViewModel();this.$2_9(tab.Strings.FunctionTypeAll,'all');this.$2_9(tab.Strings.FunctionTypeNumber,'num');this.$2_9(tab.Strings.FunctionTypeString,'str');this.$2_9(tab.Strings.FunctionTypeDate,'date');this.$2_9(tab.Strings.FunctionTypeType,'cast');this.$2_9(tab.Strings.FunctionTypeLogical,'logic');this.$2_9(tab.Strings.FunctionTypeAggregate,'agg');this.$2_9(tab.Strings.FunctionTypeUser,'user');this.$2_9(tab.Strings.FunctionTypeTableCalculation,'table');this.$2_3.set_selectedItem(this.$2_3.get_items()[0]);this.$2_1.get_funcType().append(spiff.ObjectRegistry.newView(tab.ComboBoxView,this.$2_3).get_element());this.$2_3.add_selectedItemChanged(ss.Delegate.create(this,this.$2_B));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$2_3.remove_selectedItemChanged(ss.Delegate.create(this,this.$2_B));this.$2_3.dispose();})));this.$2_4=spiff.ClearableTextInputView.newClearableTextInputView('',tab.Strings.FunctionTypeSearchHint,tab.Strings.FunctionTypeClearTooltip);this.$2_4.addToDom(this.$2_1.get_searchBox());this.$2_4.add_propertyChanged(ss.Delegate.create(this,this.$2_C));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$2_4.remove_propertyChanged(ss.Delegate.create(this,this.$2_C));this.$2_4.dispose();})));this.$2_2.selectItemByIndex(0);this.$2_A();},$2_9:function($p0,$p1){var $0=new tab.ComboBoxItem(null,$p0,$p1,null);this.$2_3.addItem($0);},$2_A:function(){this.$2_0.get_listViewModel().set_filter(ss.Delegate.create(this,function($p1_0,$p1_1,$p1_2){
var $1_0=$p1_0.get_data();var $1_1=this.$2_3.get_selectedItem().get_data();if($1_1!=='all'&&!$1_0.ax7.contains($1_1)){return false;}var $1_2=this.$2_4.get_text();if($1_2!=null&&!String.isNullOrEmpty($1_2.trim())){return $1_0.mb.toString().toLowerCase().indexOf($1_2.toLowerCase())>=0;}return true;}));},$2_B:function($p0){if(!String.isNullOrEmpty(this.$2_4.get_text())){this.$2_4.set_text('');}else{this.$2_A();}},$2_C:function($p0,$p1){this.$2_A();},handleResize:function(){this.$2_5.triggerRefresh();this.$2_7.triggerRefresh();},$2_D:function(){this.$2_2.selectItemByIndex(0);this.$2_5.triggerRefresh();},$2_E:function(){var $0='';var $1='';var $2=this.$2_10();if(ss.isValue($2)){$0=$2.o7||'';$1=$2.o9||'';}this.get_funcInfo().get_functionName().text($0);this.get_funcInfo().get_functionDescription().text($1);this.$2_7.triggerRefresh();},$2_F:function(){if(ss.isValue(this.$2_8)){this.$2_8(this.$2_10());}},$2_10:function(){var $0=this.$2_2.get_firstSelectedItem();return (ss.isValue($0))?$0.get_data():null;}}
tab.CalculationFunctionListTemplate=function(){tab.CalculationFunctionListTemplate.initializeBase(this,[$(tab.CalculationFunctionListTemplate.$1_0)]);this.$1_1=this.getElementBySelector('.tabCalcEditorFuncListArea');this.$1_2=this.getElementBySelector('.tabCalcEditorFuncInfoArea');this.$1_3=this.getElementBySelector('.tabCalcEditorFuncSearchBox');this.$1_4=this.getElementBySelector('.tabCalcEditorFuncType');}
tab.CalculationFunctionListTemplate.prototype={$1_1:null,$1_2:null,$1_3:null,$1_4:null,get_functionListArea:function(){return this.$1_1;},get_functionInfoArea:function(){return this.$1_2;},get_searchBox:function(){return this.$1_3;},get_funcType:function(){return this.$1_4;}}
tab.CalculationFunctionInfoTemplate=function(){tab.CalculationFunctionInfoTemplate.initializeBase(this,[$("\n<div class='tabCalcEditorFunctionInfo'>\n  <div class='tabCalcEditorFunctionName'/>\n  <div class='tabCalcEditorFunctionDescription'/>\n</div>")]);this.$1_1=this.getElementBySelector('.tabCalcEditorFunctionName');this.$1_2=this.getElementBySelector('.tabCalcEditorFunctionDescription');}
tab.CalculationFunctionInfoTemplate.prototype={$1_1:null,$1_2:null,get_functionName:function(){return this.$1_1;},get_functionDescription:function(){return this.$1_2;}}
tab.CategoricalColorOptionView=function(viewModel){tab.CategoricalColorOptionView.initializeBase(this,[viewModel,new tab.CategoricalColorOptionTemplate()]);this.dom=this.get_template();this.categoricalColorOptionViewModel=viewModel;this.createColorControls();}
tab.CategoricalColorOptionView.prototype={categoricalColorOptionViewModel:null,dom:null,$2_0:null,get_colorTransparencyControlView:function(){return this.$2_0;},set_colorTransparencyControlView:function(value){this.$2_0=value;return value;},createColorControls:function(){var $0=spiff.ObjectRegistry.newView(tab.ColorPalettePickerView,this.categoricalColorOptionViewModel.get_palettePickerViewModel());$0.addToDom(this.dom.colorPaletteSelectionControlContainer);this.disposables.add($0);},onAddedToDom:function(){tab.CategoricalColorOptionView.callBaseMethod(this, 'onAddedToDom');this.get_colorTransparencyControlView().addToDom(this.dom.transparencyControlContainer);}}
tab.CategoricalColorOptionTemplate=function(){tab.CategoricalColorOptionTemplate.initializeBase(this,[$("<div class='tabAuthCategoricalColorOptionContent'>\n    <div class='tabColorPalettePickerContainer'/>\n    <div class='tabAuthDivider'/>\n    <div class='tabAuthTransparencyControlContainer'/>\n</div>")]);this.colorPaletteSelectionControlContainer=this.getElementBySelector('.tabColorPalettePickerContainer');this.transparencyControlContainer=this.getElementBySelector('.tabAuthTransparencyControlContainer');}
tab.CategoricalColorOptionTemplate.prototype={colorPaletteSelectionControlContainer:null,transparencyControlContainer:null}
tab.ColorTransparencyControlView=function(viewModel){tab.ColorTransparencyControlView.initializeBase(this,[viewModel,spiff.Template.fromHtml("<div class='tabAuthTransparencyControl'/>")]);}
tab.ColorTransparencyControlView.prototype={sliderViewModel:null,createTransparencyLabel:function(){this.get_element().append($('<div>').addClass('tabAuthTransparencyLabel').append($('<span>').text(tab.Strings.AuthColorTransparencyLabel)));},createSlider:function(rangeModel){this.sliderViewModel=new tab.ContinuousSliderViewModel(rangeModel);this.sliderViewModel.set_sliderClassName('tabAuthTransparencySlider');this.sliderViewModel.add_sliderValueChange(ss.Delegate.create(rangeModel,rangeModel.setCurrentFraction));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.sliderViewModel.remove_sliderValueChange(ss.Delegate.create(rangeModel,rangeModel.setCurrentFraction));})));this.disposables.add(this.sliderViewModel);},createTransparencySettings:function(rangeModel){this.createTransparencyLabel();this.createSlider(rangeModel);},commitTransparencyPercentageText:function(){}}
tab.LinePatternPickerView=function(viewModel){this.$2_2={};this.$2_3=['solid','dashed','dotted'];tab.LinePatternPickerView.initializeBase(this,[viewModel,spiff.Template.fromHtml("<div class='tabLinePatternPicker'/>")]);this.$2_2['none']='linepattern-none';this.$2_2['solid']='linepattern-solid';this.$2_2['dashed']='linepattern-dashed';this.$2_2['dotted']='linepattern-dotted';}
tab.LinePatternPickerView.prototype={get_$2_4:function(){return this.get_viewModel();},onAddedToDom:function(){tab.LinePatternPickerView.callBaseMethod(this, 'onAddedToDom');this.createPicker();},onViewModelPropertyChanged:function(sender,e){this.updateContent();},createPicker:function(){spiff.ClickHandler.targetAndClick($('<div/>').html(tab.Strings.LinePatternNone).addClass('tabLinePatternTextButton').addClass('tabStylePickerButton').toggleClass('tabStylePickerButtonSelected','none'===this.get_$2_4().get_selectedLinePattern()).appendTo(this.get_element()),this.$2_5('none'));var $enum1=ss.IEnumerator.getEnumerator(this.$2_3);while($enum1.moveNext()){var $0=$enum1.current;var $1=this.$2_2[$0];spiff.ClickHandler.targetAndClick($('<div/>').addClass($1).addClass('tabLinePattern').addClass('tabStylePickerButton').toggleClass('tabStylePickerButtonSelected',$0===this.get_$2_4().get_selectedLinePattern()).appendTo(this.get_element()),this.$2_5($0));}},$2_5:function($p0){return ss.Delegate.create(this,function(){
this.get_$2_4().set_selectedLinePattern($p0);});},updateContent:function(){this.removePicker();this.createPicker();},removePicker:function(){this.get_element().children().remove();}}
tab.StrokeWidthPickerView=function(viewModel){tab.StrokeWidthPickerView.initializeBase(this,[viewModel,spiff.Template.fromHtml("<div class='tabStrokeWidthPicker'/>")]);}
tab.StrokeWidthPickerView.prototype={get_$2_4:function(){return this.get_viewModel();},onAddedToDom:function(){tab.StrokeWidthPickerView.callBaseMethod(this, 'onAddedToDom');this.createPicker();},onViewModelPropertyChanged:function(sender,e){this.updateContent();},createPicker:function(){for(var $0=1;$0<=5;$0++){this.$2_5($0);}},$2_5:function($p0){var $0='strokewidth'+$p0;spiff.ClickHandler.targetAndClick($('<div/>').addClass($0).addClass('tabStrokeWidth').addClass('tabStylePickerButton').toggleClass('tabStylePickerButtonSelected',$p0===this.get_$2_4().get_selectedStrokeWidth()).appendTo(this.get_element()),this.$2_6($p0));},$2_6:function($p0){return ss.Delegate.create(this,function(){
this.get_$2_4().set_selectedStrokeWidth($p0);});},updateContent:function(){this.removePicker();this.createPicker();},removePicker:function(){this.get_element().children().remove();}}
tab.QuantitativeColorOptionView=function(viewModel,t){tab.QuantitativeColorOptionView.initializeBase(this,[viewModel,t]);this.dom=t;this.quantitativeColorOptionViewModel=viewModel;this.quantitativeColorOptionViewModel.add_isReversedChanged(ss.Delegate.create(this,this.handleIsReversedChanged));this.quantitativeColorOptionViewModel.add_isSteppedChanged(ss.Delegate.create(this,this.handleIsSteppedChanged));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.quantitativeColorOptionViewModel.remove_isReversedChanged(ss.Delegate.create(this,this.handleIsReversedChanged));this.quantitativeColorOptionViewModel.remove_isSteppedChanged(ss.Delegate.create(this,this.handleIsSteppedChanged));})));}
tab.QuantitativeColorOptionView.prototype={quantitativeColorOptionViewModel:null,dom:null,$2_0:null,$2_1:null,get_stepperControlView:function(){return this.$2_0;},get_colorTransparencyControlView:function(){return this.$2_1;},set_colorTransparencyControlView:function(value){this.$2_1=value;return value;},createColorControls:function(){this.createColorPaletteSelectionControl();this.createColorReversalControl();this.addSteppedColorSettings();},createColorPaletteSelectionControl:function(){var $0=spiff.ObjectRegistry.newView(tab.ColorPalettePickerView,this.quantitativeColorOptionViewModel.get_palettePickerViewModel());$0.addToDom(this.dom.colorPaletteSelectionControlContainer);this.disposables.add($0);},createColorReversalControl:function(){var $0=tableau.util.createCheckBox(ss.Delegate.create(this,function(){
this.quantitativeColorOptionViewModel.toggleColorReversal();}),tab.Strings.AuthReverseColorLabel,'tabAuthColorReverseCheck',3,this.quantitativeColorOptionViewModel.get_isReversed(),this.disposables);this.dom.colorReversalControl.append($0);},createStepperControl:function(attachTo){this.$2_0=spiff.ObjectRegistry.newView(tab.StepperControlView,this.quantitativeColorOptionViewModel.get_stepperControlViewModel());attachTo.append(this.get_stepperControlView().get_element());this.disposables.add(this.get_stepperControlView());},createSteppedCheckbox:function(){return tableau.util.createCheckBox(ss.Delegate.create(this,function(){
this.quantitativeColorOptionViewModel.toggleIsStepped();}),tab.Strings.AuthSteppedColorLabel,'tabAuthSteppedCheck',3,this.quantitativeColorOptionViewModel.get_isStepped(),this.disposables);},addSteppedColorSettings:function(){this.dom.steppedColorControl.append(this.createSteppedCheckbox());this.createStepperControl(this.dom.steppedColorControl);},handleIsSteppedChanged:function(isStepped){this.dom.getElementBySelector('.'+'tabAuthSteppedCheck'+' input').prop('checked',isStepped);},handleIsReversedChanged:function(isReversed){this.dom.getElementBySelector('.'+'tabAuthColorReverseCheck'+' input').prop('checked',isReversed);},onAddedToDom:function(){tab.QuantitativeColorOptionView.callBaseMethod(this, 'onAddedToDom');this.get_colorTransparencyControlView().addToDom(this.dom.transparencyControlContainer);}}
tab.QuantitativeColorOptionTemplate=function(root){tab.QuantitativeColorOptionTemplate.initializeBase(this,[root]);this.colorPaletteSelectionControlContainer=this.getElementBySelector('.tabColorPalettePickerContainer');this.colorReversalControl=this.getElementBySelector('.tabAuthColorReverseControl');this.steppedColorControl=this.getElementBySelector('.tabColorSteps');this.transparencyControlContainer=this.getElementBySelector('.tabAuthTransparencyControlContainer');}
tab.QuantitativeColorOptionTemplate.prototype={colorPaletteSelectionControlContainer:null,colorReversalControl:null,steppedColorControl:null,transparencyControlContainer:null}
tab.ColorPalettePickerView=function(viewModel){tab.ColorPalettePickerView.initializeBase(this,[viewModel,new tab.ColorPalettePickerTemplate()]);this.colorPalettePickerViewModel=viewModel;this.dom=this.get_template();this.$2_0();this.setupNavigationControl();this.setupPageControls();}
tab.ColorPalettePickerView.prototype={dom:null,colorPalettePickerViewModel:null,setupPageControls:function(){for(var $0=0;$0<this.colorPalettePickerViewModel.get_pages().length;$0++){var $1=$('<a>').data('pageNo',$0);this.disposables.add(spiff.TableauClickHandler.targetAndClick($1.get(0),ss.Delegate.create(this,function($p1_0){
var $1_0=$($p1_0.target);this.colorPalettePickerViewModel.set_currentPageIndex($1_0.data()['pageNo']);this.dom.pageControls.children('a.tabPageHighlight').removeClass('tabPageHighlight');$1_0.addClass('tabPageHighlight');})));if($0===this.colorPalettePickerViewModel.get_currentPageIndex()){$1.addClass('tabPageHighlight');}this.dom.pageControls.append($1);}},onViewModelPropertyChanged:function(sender,e){tab.ColorPalettePickerView.callBaseMethod(this, 'onViewModelPropertyChanged',[sender,e]);if(e.get_propertyName()==='CurrentPage'){this.handleCurrentPageChange();}else if(e.get_propertyName()==='SelectedPalette'){this.dom.clearSelection();this.dom.get_domRoot().find('.tabColorPalette').each(ss.Delegate.create(this,function($p1_0,$p1_1){
var $1_0=$($p1_1);var $1_1=$1_0.data('paletteName');if(ss.isValue($1_1)&&$1_1===this.colorPalettePickerViewModel.get_selectedPalette()){$1_0.addClass('tabPaletteSelected');}}));}},updateNavigationButtons:function(){this.dom.leftButton.toggleClass('disabled',this.colorPalettePickerViewModel.get_isAtFisrtPage());this.dom.rightButton.toggleClass('disabled',this.colorPalettePickerViewModel.get_isAtLastPage());},handleCurrentPageChange:function(){var $0=this.colorPalettePickerViewModel.get_currentPageIndex();this.dom.pageControls.find('a').each(ss.Delegate.create(this,function($p1_0,$p1_1){
var $1_0=$($p1_1);var $1_1=$1_0.data();if(ss.isNullOrUndefined($1_1)){return;}var $1_2=parseInt($1_1['pageNo']);var $1_3=(isFinite($1_2)&&$1_2===this.colorPalettePickerViewModel.get_currentPageIndex());$1_0.toggleClass('tabPageHighlight',$1_3);}));this.scrollToPageNo($0);this.updateNavigationButtons();},$2_0:function(){this.dom.clear();var $0=0;var $enum1=ss.IEnumerator.getEnumerator(this.colorPalettePickerViewModel.get_pages());while($enum1.moveNext()){var $1=$enum1.current;var $2=new tab.ColorPalettePageTemplate();if($1.get_isCustomPalettePage()){$2.get_domRoot().empty();var $3=$('<div>').addClass('tabColorSpecialPalette').addClass('tabColorCustomPalette').addClass('tabPaletteSelected');$3.append($('<div>').addClass('tabPaletteBorder'));$3.append($('<span>').text(this.colorPalettePickerViewModel.get_selectedPalette()));$2.get_domRoot().append($3);}else{var $4=this.$2_1($2);if(!!$0){$4.hide();}for(var $5=0;$5<$2.paletteColumnList.length;++$5){this.$2_2($1.get_paletteGroups()[$5].paletteItems,$2.paletteColumnList[$5],$1.get_paletteGroups()[$5].paletteItems.length);}}this.dom.palettePickerPageContainer.append($2.get_domRoot());$0++;}this.initPaletteEventHandlers();this.updateNavigationButtons();},$2_1:function($p0){var $0=$p0.automaticPalette;$0.data('paletteName','');$0.toggleClass('tabPaletteSelected',this.colorPalettePickerViewModel.get_automaticPaletteSelected());$0.append($('<span/>').text(tab.Strings.AuthColorPaletteAutomatic));this.disposables.add(spiff.TableauClickHandler.targetAndClick($0.get(0),ss.Delegate.create(this,function($p1_0){
this.selectPaletteElement($0);this.dom.clearSelection();$0.addClass('tabPaletteSelected');this.colorPalettePickerViewModel.set_automaticPaletteSelected(true);})));return $0;},$2_2:function($p0,$p1,$p2){var $0=null;for(var $1=0;$1<$p0.length;$1++){if(!($1%$p2)){$0=$('<span/>').addClass('tabColorPaletteGroup').appendTo($p1);}this.$2_3($p0[$1],$0);}},$2_3:function($p0,$p1){var $0=$('<div/>').addClass('tabColorPalette').toggleClass('tabPaletteSelected',$p0.paletteName===this.colorPalettePickerViewModel.get_selectedPalette()).addClass('tabAuthPalette-'+$p0.paletteName).attr('title',$p0.paletteLabel).data('paletteName',$p0.paletteName);$0.append($('<div/>').addClass('tabPaletteBorder')).appendTo($p1);},initPaletteEventHandlers:function(){var $0=ss.Delegate.create(this,function($p1_0,$p1_1){
var $1_0=$($p1_1);this.disposables.add(spiff.TableauClickHandler.targetAndClick($1_0.get(0),ss.Delegate.create(this,function($p2_0){
this.selectPaletteElement($1_0);})));});var $1=this.dom.get_palettes();$1.each($0);var $2=this.dom.get_customPalettes();$2.each($0);},selectPaletteElement:function(paletteDiv){this.dom.clearSelection();paletteDiv.addClass('tabPaletteSelected');this.colorPalettePickerViewModel.set_selectedPalette(paletteDiv.data('paletteName'));},scrollToOffset:function(offset,transition){tab.DomUtil.setElementPosition(this.dom.palettePickerPageContainer,offset,0,(transition)?'400ms':'0');},scrollOffsetForPageNo:function(pageNo){return -pageNo*this.dom.get_pages().first().width();},scrollToPageNo:function(pageNo){this.scrollToOffset(this.scrollOffsetForPageNo(pageNo),true);},setupNavigationControl:function(){this.disposables.add(spiff.TableauClickHandler.targetAndClick(this.dom.leftButtonArea.get(0),ss.Delegate.create(this,function($p1_0){
this.colorPalettePickerViewModel.set_currentPageIndex(this.colorPalettePickerViewModel.get_currentPageIndex()-1);})));this.disposables.add(spiff.TableauClickHandler.targetAndClick(this.dom.rightButtonArea.get(0),ss.Delegate.create(this,function($p1_0){
this.colorPalettePickerViewModel.set_currentPageIndex(this.colorPalettePickerViewModel.get_currentPageIndex()+1);})));}}
tab.ColorPalettePickerTemplate=function(){tab.ColorPalettePickerTemplate.initializeBase(this,[$("<div class='tabColorPalettePicker'>\n        <div class='tabAuthLeftButtonArea'>\n            <div class='tabAuthPalettePickerLeftButton'/>\n        </div>\n        <div class='tabColorPalettePickerWindow'>\n            <div class='tabColorPalettePickerPageContainer'/>\n        </div>\n        <div class='tabAuthRightButtonArea'>\n            <div class='tabAuthPalettePickerRightButton'/>\n        </div>\n        <div class='tabPalettePageControlsArea'>\n            <div class='tabPalettePageControls'/>\n        </div>\n    </div>")]);this.palettePickerWindow=this.getElementBySelector('.tabColorPalettePickerWindow');this.palettePickerPageContainer=this.getElementBySelector('.tabColorPalettePickerPageContainer');this.leftButtonArea=this.getElementBySelector('.tabAuthLeftButtonArea');this.rightButtonArea=this.getElementBySelector('.tabAuthRightButtonArea');this.leftButton=this.getElementBySelector('.tabAuthPalettePickerLeftButton');this.rightButton=this.getElementBySelector('.tabAuthPalettePickerRightButton');this.pageControls=this.getElementBySelector('.tabPalettePageControls');}
tab.ColorPalettePickerTemplate.prototype={palettePickerWindow:null,palettePickerPageContainer:null,leftButtonArea:null,rightButtonArea:null,leftButton:null,rightButton:null,pageControls:null,get_pages:function(){return this.getElementsBySelector('.tabColorPalettePage');},get_palettes:function(){return this.getElementsBySelector('.tabColorPalette');},get_automaticPalette:function(){return this.getElementsBySelector('.tabColorAutomaticPalette');},get_customPalettes:function(){return this.getElementsBySelector('.tabColorCustomPalette');},clear:function(){this.get_pages().remove();},clearSelection:function(){this.get_automaticPalette().removeClass('tabPaletteSelected');this.get_palettes().removeClass('tabPaletteSelected');this.get_customPalettes().removeClass('tabPaletteSelected');}}
tab.ColorPalettePageTemplate=function(){tab.ColorPalettePageTemplate.initializeBase(this,[$("<span class='tabColorPalettePage'>\n    <div class='tabColorSpecialPalette tabColorAutomaticPalette tabColorPalette'>\n        <div class='tabPaletteBorder'/>\n    </div>\n    <div class='tabColorPalettePageColumns'>\n        <span class='tabColorPalettePageColumn0'/>\n        <span class='tabColorPalettePageColumn1'/>\n    </div>\n</span>")]);this.automaticPalette=this.getElementBySelector('.tabColorAutomaticPalette');this.paletteColumns=this.getElementBySelector('.tabColorPalettePageColumns');this.paletteColumnList=new Array(2);for(var $0=0;$0<this.paletteColumnList.length;++$0){this.paletteColumnList[$0]=this.getElementBySelector('.tabColorPalettePageColumn'+$0.toString());}}
tab.ColorPalettePageTemplate.prototype={automaticPalette:null,paletteColumns:null,paletteColumnList:null}
tab.StylePickerView=function(viewModel,template){tab.StylePickerView.initializeBase(this,[viewModel,template]);}
tab.TextEncodingOptionView=function(vm){tab.TextEncodingOptionView.initializeBase(this,[vm,new tab.TextEncodingOptionTemplate()]);this.dom=this.get_template();this.textOptionViewModel=vm;this.textOptionViewModel.add_labelsOnChanged(ss.Delegate.create(this,this.handleLabelsOnChanged));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.textOptionViewModel.remove_labelsOnChanged(ss.Delegate.create(this,this.handleLabelsOnChanged));})));}
tab.TextEncodingOptionView.prototype={textOptionViewModel:null,dom:null,handleLabelsOnChanged:function(labelsOn){}}
tab.TextEncodingOptionTemplate=function(){tab.TextEncodingOptionTemplate.initializeBase(this,[$("<div class='tabAuthTextOptionContent'></div>")]);}
tab.TypeInPillView=function(viewModel){tab.TypeInPillView.initializeBase(this,[viewModel,new tab.TypeInPillTemplate()]);this.initDom();}
tab.TypeInPillView.prototype={$2_13:null,$2_14:false,$2_15:false,$2_16:false,$2_17:false,get_pillViewModel:function(){return this.$2_13;},set_pillViewModel:function(value){if(this.$2_13===value){return;}this.$2_13=value;return value;},dispose:function(){this.$2_1A();tab.TypeInPillView.callBaseMethod(this, 'dispose');},addToDom:function(parent){parent.append(this.get_element());},onAddedToDom:function(){if(!tsConfig.is_mobile){this.get_autoCompleteHelper().set_validFormulaTooltip((tab.BrowserSupport.get_isMac())?tab.Strings.CalcEditorApplyTooltipMac:tab.Strings.CalcEditorApplyTooltip);}tab.TypeInPillView.callBaseMethod(this, 'onAddedToDom');this.focusEditor();},initDom:function(){tab.TypeInPillView.callBaseMethod(this, 'initDom');this.$2_19();},onOpenCompleted:function(){if(!this.get_hasEditor()){return;}this.get_editor().execCommand('goDocEnd');},createCodeMirrorOptions:function(){var $0=tab.TypeInPillView.callBaseMethod(this, 'createCodeMirrorOptions');$0.extraKeys['Esc']=ss.Delegate.create(this,this.$2_18);return $0;},$2_18:function(){this.calcViewModel.cancelCalculation();},$2_19:function(){this.$2_1B();this.$2_1A();spiff.GlobalTouchWatcher.add_firstTouch(ss.Delegate.create(this,this.$2_1D));spiff.GlobalTouchWatcher.add_press(ss.Delegate.create(this,this.$2_1D));spiff.GlobalTouchWatcher.add_potentialTap(ss.Delegate.create(this,this.$2_1F));spiff.GlobalTouchWatcher.add_rightClick(ss.Delegate.create(this,this.$2_1E));spiff.GlobalTouchWatcher.add_dragEnd(ss.Delegate.create(this,this.$2_1C));},$2_1A:function(){spiff.GlobalTouchWatcher.remove_firstTouch(ss.Delegate.create(this,this.$2_1D));spiff.GlobalTouchWatcher.remove_press(ss.Delegate.create(this,this.$2_1D));spiff.GlobalTouchWatcher.remove_potentialTap(ss.Delegate.create(this,this.$2_1F));spiff.GlobalTouchWatcher.remove_rightClick(ss.Delegate.create(this,this.$2_1E));spiff.GlobalTouchWatcher.remove_dragEnd(ss.Delegate.create(this,this.$2_1C));},$2_1B:function(){this.$2_15=false;this.$2_16=false;this.$2_17=false;this.$2_14=false;},$2_1C:function($p0,$p1){if(this.$2_17){return;}var $0=spiff.DragDropManager.findDropTarget($p0);this.$2_16=($0===this);this.$2_1F(null,$p1);},$2_1D:function($p0,$p1){this.$2_1B();this.$2_14=true;this.$2_15=this.isEqualOrAncestorOf($p0.target);},$2_1E:function($p0,$p1){this.$2_14=true;this.$2_1F($p0,$p1);},$2_1F:function($p0,$p1){if(!this.$2_14||this.$2_15||this.$2_16){return;}if(ss.isNullOrUndefined($p0)||!this.isEqualOrAncestorOf($p0.target)){if(ss.isValue($p1)){$p1(true);}if(!this.$2_17){this.$2_17=true;this.calcViewModel.applyCalculation(this.get_pillViewModel(),true);}}},addExtraKeys:function(extraKeys){extraKeys['Enter']=ss.Delegate.create(this,function(){
this.$2_17=true;this.calcViewModel.applyCalculation(this.get_pillViewModel(),true);});},animateOpen:function(startWidth,endWidth,maxWidth){this.get_element().css({'max-width':startWidth+'px','min-width':startWidth+'px'});window.setTimeout(ss.Delegate.create(this,function(){
var $1_0=$(this.get_editor().getWrapperElement()).find('.CodeMirror-lines');var $1_1=(ss.isValue($1_0))?$1_0.outerWidth()+30:0;var $1_2=Math.max(endWidth,Math.min(maxWidth,$1_1));this.get_element().addClass('tabAnimationTransition');this.get_element().css({'max-width':$1_2+'px','min-width':$1_2+'px'});window.setTimeout(ss.Delegate.create(this,function(){
this.get_element().removeClass('tabAnimationTransition');this.get_element().css({'max-width':maxWidth+'px','min-width':$1_2+'px'});this.onOpenCompleted();}),300);}),1);}}
tab.TypeInPillTemplate=function(){tab.TypeInPillTemplate.initializeBase(this,[$(tab.TypeInPillTemplate.$1_0)]);}
tab.TypeInPillTemplate.prototype={get_dragSource:function(){return this.getElementBySelector('.tabTypeInPillCmHolder');},get_dropTarget:function(){return this.getElementBySelector('.tabTypeInPillCmHolder');},get_formulaEditorHolder:function(){return this.getElementBySelector('.tabTypeInPillCmHolder');},get_dropInviteBorder:function(){return this.get_domRoot();}}
tab.SaveController.registerClass('tab.SaveController');tab.AnalyticsDropTargetViewModel.registerClass('tab.AnalyticsDropTargetViewModel',spiff.BaseViewModel);tab.AnalyticsPaneViewModel.registerClass('tab.AnalyticsPaneViewModel',spiff.BaseViewModel);tab.AnalyticsListItemViewModel.registerClass('tab.AnalyticsListItemViewModel',spiff.BaseViewModel,spiff.IDragSource);tab.AuthoringTabViewModel.registerClass('tab.AuthoringTabViewModel',spiff.BaseViewModel);tab.AuthoringToolbarDropdownButtonViewModel.registerClass('tab.AuthoringToolbarDropdownButtonViewModel',tab.ToolbarButtonViewModel);tab.AuthoringToolbarToggleButtonViewModel.registerClass('tab.AuthoringToolbarToggleButtonViewModel',tab.ToolbarButtonViewModel);tab.AuthoringToolbarUberPopupButtonViewModel.registerClass('tab.AuthoringToolbarUberPopupButtonViewModel',tab.ToolbarButtonViewModel);tab.AuthoringToolbarViewModel.registerClass('tab.AuthoringToolbarViewModel',spiff.BaseViewModel);tab.AuthoringViewModel.registerClass('tab.AuthoringViewModel',spiff.BaseViewModel);tab.BaseFieldDragInstance.registerClass('tab.BaseFieldDragInstance',spiff.DragInstance);tab.CalculationFunctionListViewModel.registerClass('tab.CalculationFunctionListViewModel',spiff.BaseViewModel);tab.CalculationEditorViewModel.registerClass('tab.CalculationEditorViewModel',spiff.BaseViewModel,spiff.IDragResponder);tab.vqlauthoring$4.registerClass('tab.vqlauthoring$4');tab.CardViewModel.registerClass('tab.CardViewModel',spiff.BaseViewModel);tab.ColorOptionViewModel.registerClass('tab.ColorOptionViewModel',spiff.BaseViewModel,spiff.IUberPopupContent);tab.ColorPickerViewModel.registerClass('tab.ColorPickerViewModel',tab.ColorOptionViewModel);tab.IconUtils.registerClass('tab.IconUtils');tab.LayerEncodingViewModel.registerClass('tab.LayerEncodingViewModel',spiff.BaseViewModel,spiff.IDragResponder);tab.vqlauthoring$0.registerClass('tab.vqlauthoring$0',null,spiff.IDropTarget);tab.MarksContentViewModel.registerClass('tab.MarksContentViewModel',spiff.BaseViewModel,tab.ICardContent);tab.AuthoringTabNavViewModel.registerClass('tab.AuthoringTabNavViewModel',spiff.BaseViewModel);tab.AuthoringMastheadViewModel.registerClass('tab.AuthoringMastheadViewModel',spiff.BaseViewModel);tab.MarkSizePickerViewModel.registerClass('tab.MarkSizePickerViewModel',spiff.BaseViewModel,spiff.IUberPopupContent);tab.PillDragInstance.registerClass('tab.PillDragInstance',tab.BaseFieldDragInstance);tab.PillViewModel.registerClass('tab.PillViewModel',spiff.BaseViewModel,spiff.IDragSource,spiff.IDropTarget);tab.SaveViewModel.registerClass('tab.SaveViewModel',spiff.BaseViewModel);tab.DataSchemaViewModel.registerClass('tab.DataSchemaViewModel',spiff.BaseViewModel);tab.DropTargetWithDropState.registerClass('tab.DropTargetWithDropState',null,spiff.IDropTarget,ss.IDisposable);tab.SchemaViewFieldDropTarget.registerClass('tab.SchemaViewFieldDropTarget',tab.DropTargetWithDropState);tab.DimensionFieldDropTarget.registerClass('tab.DimensionFieldDropTarget',tab.SchemaViewFieldDropTarget);tab.MeasureFieldDropTarget.registerClass('tab.MeasureFieldDropTarget',tab.SchemaViewFieldDropTarget);tab.ConvertUnnamedFieldsDropTarget.registerClass('tab.ConvertUnnamedFieldsDropTarget',tab.DropTargetWithDropState);tab.FieldDragSource.registerClass('tab.FieldDragSource',null,spiff.IDragSource);tab.SchemaNode.registerClass('tab.SchemaNode');tab.ShapePickerViewModel.registerClass('tab.ShapePickerViewModel',spiff.BaseViewModel,spiff.IUberPopupContent);tab.ShelfViewModel.registerClass('tab.ShelfViewModel',spiff.BaseViewModel,tab.ICardContent,spiff.IDropTarget,spiff.IDragResponder);tab.vqlauthoring$1.registerClass('tab.vqlauthoring$1',null,spiff.IDropTarget);tab.CalculationDependencyViewModel.registerClass('tab.CalculationDependencyViewModel',spiff.BaseViewModel,spiff.IUberPopupContent);tab.ShowMeViewModel.registerClass('tab.ShowMeViewModel',spiff.BaseViewModel,spiff.IUberPopupContent);tab.CalcTextDragInstance.registerClass('tab.CalcTextDragInstance',tab.BaseFieldDragInstance);tab.TooltipContentViewModel.registerClass('tab.TooltipContentViewModel',spiff.BaseViewModel,spiff.IUberPopupContent);tab.VizSummaryViewModel.registerClass('tab.VizSummaryViewModel',spiff.BaseViewModel);tab.AnalyticsDropTargetView.registerClass('tab.AnalyticsDropTargetView',spiff.BaseView);tab.GlassDropTarget.registerClass('tab.GlassDropTarget',spiff.Glass,spiff.IDropTarget);tab.AnalyticsDropSpot.registerClass('tab.AnalyticsDropSpot',null,spiff.IDropTarget);tab.AnalyticsScrollSpot.registerClass('tab.AnalyticsScrollSpot',null,spiff.IDropTarget);tab.AnalyticsDropTargetTemplate.registerClass('tab.AnalyticsDropTargetTemplate',spiff.Template);tab.AnalyticsDropTargetAxisRowTemplate.registerClass('tab.AnalyticsDropTargetAxisRowTemplate',spiff.Template);tab.AnalyticsPaneView.registerClass('tab.AnalyticsPaneView',spiff.BaseView);tab.AnalyticsListItemView.registerClass('tab.AnalyticsListItemView',spiff.BaseView);tab.AnalyticsDragAvatar.registerClass('tab.AnalyticsDragAvatar',spiff.BaseView);tab.AnalyticsDragAvatarTemplate.registerClass('tab.AnalyticsDragAvatarTemplate',spiff.Template);tab.AnalyticsPaneTemplate.registerClass('tab.AnalyticsPaneTemplate',spiff.Template);tab.AnalyticsListItemTemplate.registerClass('tab.AnalyticsListItemTemplate',spiff.Template);tab.AnalyticsListHeaderTemplate.registerClass('tab.AnalyticsListHeaderTemplate',spiff.Template);tab.AuthoringTabView.registerClass('tab.AuthoringTabView',spiff.BaseView);tab.AuthoringTabViewTemplate.registerClass('tab.AuthoringTabViewTemplate',spiff.Template);tab.AuthoringToolbarButtonView.registerClass('tab.AuthoringToolbarButtonView');tab.AuthoringToolbarToggleButtonTemplate.registerClass('tab.AuthoringToolbarToggleButtonTemplate',tab.ToolbarButtonTemplate);tab.AuthoringToolbarToggleButtonView.registerClass('tab.AuthoringToolbarToggleButtonView',tab.ToolbarButtonView);tab.AuthoringToolbarDropdownButtonView.registerClass('tab.AuthoringToolbarDropdownButtonView',tab.ToolbarButtonView);tab.AuthoringToolbarUberPopupButtonView.registerClass('tab.AuthoringToolbarUberPopupButtonView',tab.ToolbarButtonView);tab.AuthoringToolbarView.registerClass('tab.AuthoringToolbarView',spiff.BaseView);tab.vqlauthoring$5.registerClass('tab.vqlauthoring$5',spiff.Template);tab.AuthoringView.registerClass('tab.AuthoringView',null,spiff.IView,spiff.IDragSource);tab.CalculationEditorDragFeedback.registerClass('tab.CalculationEditorDragFeedback');tab.CalcTextDragAvatar.registerClass('tab.CalcTextDragAvatar',spiff.Widget,spiff.IView);tab.CalculationAutoCompleteHelper.registerClass('tab.CalculationAutoCompleteHelper',null,ss.IDisposable);tab.vqlauthoring$2.registerClass('tab.vqlauthoring$2');tab.vqlauthoring$6.registerClass('tab.vqlauthoring$6',spiff.Template);tab.vqlauthoring$8.registerClass('tab.vqlauthoring$8',tab.vqlauthoring$6);tab.vqlauthoring$9.registerClass('tab.vqlauthoring$9',tab.vqlauthoring$6);tab.vqlauthoring$A.registerClass('tab.vqlauthoring$A',tab.TooltipTemplate);tab.CalculationEditorView.registerClass('tab.CalculationEditorView',spiff.BaseView,spiff.IDropTarget,spiff.IDragSource);tab.CalculationEditorTemplate.registerClass('tab.CalculationEditorTemplate',spiff.Template);tab.CardContentView.registerClass('tab.CardContentView',spiff.BaseView);tab.CardView.registerClass('tab.CardView',spiff.BaseView);tab.CardViewTemplate.registerClass('tab.CardViewTemplate',spiff.Template);tab.CalculationDependencyView.registerClass('tab.CalculationDependencyView',spiff.BaseView);tab.LeftPanelView.registerClass('tab.LeftPanelView',spiff.BaseView);tab.LeftPanelTemplate.registerClass('tab.LeftPanelTemplate',spiff.Template);tab.ColorOptionView.registerClass('tab.ColorOptionView',spiff.BaseView);tab.ColorPickerView.registerClass('tab.ColorPickerView',tab.ColorOptionView);tab.ColorPickerTemplate.registerClass('tab.ColorPickerTemplate',spiff.Template);tab.MarkSizePickerView.registerClass('tab.MarkSizePickerView',spiff.BaseView);tab.LayerEncodingView.registerClass('tab.LayerEncodingView',spiff.BaseView);tab.LayerEncodingTemplate.registerClass('tab.LayerEncodingTemplate',spiff.Template);tab.EncodingTypeButtonTemplate.registerClass('tab.EncodingTypeButtonTemplate',spiff.Template);tab.MarksContentView.registerClass('tab.MarksContentView',tab.CardContentView);tab.MarksContentTemplate.registerClass('tab.MarksContentTemplate',spiff.Template);tab.vqlauthoring$3.registerClass('tab.vqlauthoring$3',null,tab.IAccordionContent);tab.AuthoringTabNavView.registerClass('tab.AuthoringTabNavView',spiff.BaseView);tab.AuthoringTabNavViewTemplate.registerClass('tab.AuthoringTabNavViewTemplate',spiff.Template);tab.AuthoringMastheadView.registerClass('tab.AuthoringMastheadView',spiff.BaseView);tab.PillDragAvatar.registerClass('tab.PillDragAvatar',spiff.Widget,spiff.IView);tab.PillView.registerClass('tab.PillView',spiff.BaseView);tab.PillViewTemplate.registerClass('tab.PillViewTemplate',spiff.Template);tab.RenameSheetDialog.registerClass('tab.RenameSheetDialog',spiff.ModalDialog);tab.SaveView.registerClass('tab.SaveView',spiff.BaseView);tab.DataSchemaView.registerClass('tab.DataSchemaView',spiff.BaseView);tab.DataSourceTemplate.registerClass('tab.DataSourceTemplate',spiff.Template);tab.FieldTemplate.registerClass('tab.FieldTemplate',spiff.Template);tab.SchemaViewerTemplate.registerClass('tab.SchemaViewerTemplate',spiff.Template);tab.ShapePickerView.registerClass('tab.ShapePickerView',spiff.BaseView);tab.ShapePickerTemplate.registerClass('tab.ShapePickerTemplate',spiff.Template);tab.ShelfView.registerClass('tab.ShelfView',tab.CardContentView);tab.ShelfCardTemplate.registerClass('tab.ShelfCardTemplate',spiff.Template);tab.ShowMeView.registerClass('tab.ShowMeView',spiff.BaseView);tab.SidebarCollapsedWidget.registerClass('tab.SidebarCollapsedWidget',spiff.Widget);tab.TooltipContentView.registerClass('tab.TooltipContentView',spiff.BaseView);tab.VizSummaryView.registerClass('tab.VizSummaryView',spiff.BaseView);tab.VizSummaryTemplate.registerClass('tab.VizSummaryTemplate',spiff.Template);tab.VizSummaryBadgeTemplate.registerClass('tab.VizSummaryBadgeTemplate',spiff.Template);tab.AuthoringCommandsViewModel.registerClass('tab.AuthoringCommandsViewModel');tab.CategoricalColorOptionViewModel.registerClass('tab.CategoricalColorOptionViewModel',tab.ColorOptionViewModel);tab.ColorTransparencyControlViewModel.registerClass('tab.ColorTransparencyControlViewModel',spiff.BaseViewModel,tab.IContinuousRangeModel);tab.LinePatternPickerViewModel.registerClass('tab.LinePatternPickerViewModel',spiff.BaseViewModel);tab.StrokeWidthPickerViewModel.registerClass('tab.StrokeWidthPickerViewModel',spiff.BaseViewModel);tab.QuantitativeColorOptionViewModel.registerClass('tab.QuantitativeColorOptionViewModel',tab.ColorOptionViewModel);tab.ColorPalettePickerViewModel.registerClass('tab.ColorPalettePickerViewModel',spiff.BaseViewModel);tab.ColorPaletteItem.registerClass('tab.ColorPaletteItem');tab.ColorPaletteGroup.registerClass('tab.ColorPaletteGroup');tab.PalettePage.registerClass('tab.PalettePage');tab.TextEncodingOptionViewModel.registerClass('tab.TextEncodingOptionViewModel',spiff.BaseViewModel,spiff.IUberPopupContent);tab.CalculationDialogView.registerClass('tab.CalculationDialogView',tab.CalculationEditorView);tab.vqlauthoring$7.registerClass('tab.vqlauthoring$7',spiff.MoveDragSource);tab.CalculationTitleAreaTemplate.registerClass('tab.CalculationTitleAreaTemplate',spiff.Template);tab.FunctionFlyoutControlTemplate.registerClass('tab.FunctionFlyoutControlTemplate',spiff.Template);tab.CalculationDialogTemplate.registerClass('tab.CalculationDialogTemplate',tab.CalculationEditorTemplate);tab.CalculationFunctionListView.registerClass('tab.CalculationFunctionListView',spiff.BaseView);tab.CalculationFunctionListTemplate.registerClass('tab.CalculationFunctionListTemplate',spiff.Template);tab.CalculationFunctionInfoTemplate.registerClass('tab.CalculationFunctionInfoTemplate',spiff.Template);tab.CategoricalColorOptionView.registerClass('tab.CategoricalColorOptionView',tab.ColorOptionView);tab.CategoricalColorOptionTemplate.registerClass('tab.CategoricalColorOptionTemplate',spiff.Template);tab.ColorTransparencyControlView.registerClass('tab.ColorTransparencyControlView',spiff.BaseView);tab.StylePickerView.registerClass('tab.StylePickerView',spiff.BaseView);tab.LinePatternPickerView.registerClass('tab.LinePatternPickerView',tab.StylePickerView);tab.StrokeWidthPickerView.registerClass('tab.StrokeWidthPickerView',tab.StylePickerView);tab.QuantitativeColorOptionView.registerClass('tab.QuantitativeColorOptionView',tab.ColorOptionView);tab.QuantitativeColorOptionTemplate.registerClass('tab.QuantitativeColorOptionTemplate',spiff.Template);tab.ColorPalettePickerView.registerClass('tab.ColorPalettePickerView',spiff.BaseView);tab.ColorPalettePickerTemplate.registerClass('tab.ColorPalettePickerTemplate',spiff.Template);tab.ColorPalettePageTemplate.registerClass('tab.ColorPalettePageTemplate',spiff.Template);tab.TextEncodingOptionView.registerClass('tab.TextEncodingOptionView',spiff.BaseView);tab.TextEncodingOptionTemplate.registerClass('tab.TextEncodingOptionTemplate',spiff.Template);tab.TypeInPillView.registerClass('tab.TypeInPillView',tab.CalculationEditorView);tab.TypeInPillTemplate.registerClass('tab.TypeInPillTemplate',tab.CalculationEditorTemplate);tab.SaveController.$0=null;tab.AnalyticsDropTargetViewModel.hoverTargetChanged='HoverTarget';tab.AuthoringViewModel.cardLayout={};(function(){tab.StartupUtils.callAfterBootstrap(function(){
var $1_0=tab.WindowHelper.getLocation(window.self);var $1_1=tab.MiscUtil.getUriQueryParameters($1_0.search);if(Object.keyExists($1_1,':showSaveAs')){tab.SaveController.get_instance().saveWorkbookAs();}var $1_2=tabBootstrap.Utility.getValueFromUrlHash('guest')==='n';if($1_2){tabBootstrap.Utility.removeEntryFromUrlHash('guest');if(tsConfig.is_authoring&&tsConfig.is_guest){var $1_3=tab.WindowHelper.getPathAndSearch(window.self);var $1_4='/signin'+'?externalRedirect='+encodeURIComponent($1_3)+'&site='+encodeURIComponent(tsConfig.site_url_name);tab.WindowHelper.setLocationHref(window.self,$1_4);}}});tab.AuthoringViewModel.cardLayout['top']=[['columns'],['rows']];tab.AuthoringViewModel.cardLayout['left']=[['pages','filters','marks','measureValues']];tab.AuthoringViewModel.cardLayout['right']=[];tab.AuthoringViewModel.cardLayout['bottom']=[];})();
tab.CalculationEditorViewModel.validationDelay=250;tab.ColorPickerViewModel.$1_3=['#000000','#FFFFFF'];tab.ColorPickerViewModel.$1_4=['#1B1B1B','#353535','#555555','#686868','#898989'];tab.ColorPickerViewModel.$1_5=['#F7F7F7','#F0F0F0','#D7D7D7','#C0C0C0','#ACACAC'];tab.ColorPickerViewModel.$1_6=['#735C3A','#9C835F','#C1A681','#820000','#B40F1E','#D8504C','#9E4C00','#CC721E','#F1923E','#906800','#B68900','#DAA800','#567332','#7C9B57','#99B872','#26794A','#4D9F6D','#67B986'];tab.ColorPickerViewModel.$1_7=['#437564','#679A88','#87BBA8','#3F6A6E','#628E92','#87B4B8','#4F6E8D','#6F95BF','#8DB5E0','#297A98','#439AB9','#62B6D5','#404B73','#7780A2','#A4ACCC','#605D7C','#928DAF','#ADA8CB'];tab.IconUtils.tableCalcIconClass='tabAuthPillIconTableCalc';tab.MarksContentViewModel.propertyCurrentLayer='CurrentLayer';tab.AuthoringTabNavViewModel.currentTabProperty='CurrentTab';tab.MarkSizePickerViewModel.markSizeProperty='CurrentFraction';tab.DataSchemaViewModel.selectedFieldProperty='SelectedField';tab.DataSchemaViewModel.sectionsInOrder=['dimensions','measure','groups','parameters'];tab.ShowMeViewModel.showMeCommandsProperty='ShowMeCommands';tab.AnalyticsDropTargetView.dropTargetIdPrefix='tabAoDropTarget-';tab.AnalyticsDropTargetView.dropSpotDirectHoverClass='tabDirectHover';tab.AnalyticsDropTargetView.dropSpotIndirectHoverClass='tabIndirectHover';tab.AnalyticsScrollSpot.scrollDelay=100;tab.AnalyticsDropTargetTemplate.$1_0="<span class='tabAdAreaDropSpot tabAdDropCell'>"+"<div class='tabAdAreaDropImage'></div>"+"<div class='tabAdAreaDropLabel'></div>"+'</span>';tab.AnalyticsDropTargetTemplate.$1_1="<div class='tabAdDropTarget'>"+"<div class='tabAdHeaderRow'>"+"<span class='tabAdDropTitle tabAdAxisCell'>"+"<div class='tabAdDropInstructionTextPre'></div>"+"<div class='tabAdDropLabel'></div>"+"<div class='tabAdDropInstructionTextPost'></div>"+'</span>'+'</div>'+"<div class='tabAdHorizontalDivider'></div>"+"<div class='tabAdAxisHolder'>"+"<div class='tabAdAxisListScroller'>"+"<div class='tabAdAxisList'></div>"+"<div class='tabAdScrollHoverTop'></div>"+"<div class='tabAdScrollHoverBottom'></div>"+'</div>'+'</div>'+'</div>';tab.AnalyticsDropTargetAxisRowTemplate.$1_0="<span class='tabAdAxisDropSpotHolder'>"+"<span class='tabAdAxisDropSpot'></span>"+'</span>';tab.AnalyticsDropTargetAxisRowTemplate.$1_1="<div class='tabAdAxisRow'>"+"<span class='tabAdAxisName tabAdAxisCell'></span>"+'</div>';(function(){spiff.ObjectRegistry.registerType(tab.AnalyticsPaneView,tab.AnalyticsPaneView);})();
tab.AnalyticsListItemTemplate.$1_0="<div class='tabAnalyticsListItem'>"+"<span class='tabAnalyticsListItemIcon' />"+"<span class='tabAnalyticsListItemName' />"+'</div>';tab.AnalyticsListHeaderTemplate.$1_0="<div class='tabAnalyticsListHeader'>"+"<span class='tabAnalyticsListHeaderName' />"+'</div>';(function(){spiff.ObjectRegistry.registerType(tab.AuthoringTabView,tab.AuthoringTabView);})();
tab.AuthoringTabViewTemplate.selectedTabClass='tabAuthTabChecked';tab.AuthoringTabViewTemplate.template="<span class='tabAuthTab'>\n    <div class='tabAuthTabLabel'></div>\n</span>";tab.AuthoringView.authoringView=null;(function(){var $0=function(){
var $1_0=new tab.AuthoringViewModel();tab.AuthoringView.authoringView=spiff.ObjectRegistry.newView(tab.AuthoringView,$1_0);};tab.StartupUtils.callAfterBootstrap($0);})();
tab.CalculationEditorDragFeedback.replaceableMarkerClassname='tabTok_replace';tab.CalculationEditorDragFeedback.nonReplaceableMarkerClassname='tabTok_noreplace';tab.CalculationAutoCompleteHelper.autoCompleteDebounceTimeout=100;tab.vqlauthoring$6.$1_4='<div>'+"<div  class='autocomplete_item'>"+"<span class='field-icon-area'><div class='schema-field-icon'></div></span>"+'</div>'+'</div>';tab.CalculationEditorView.dropInvitedClassName='tabDropInvited';tab.CalculationEditorView.$2_1='tabTok_'+'error';tab.CalculationEditorView.$2_2='tabTok_'+'empty';tab.CardViewTemplate.template="\n<div class='tabAuthCard'>\n    <div class='tabAuthCardShadow'></div>\n    <div class='tabAuthCardLabelArea'>\n        <div class='tabAuthCardExpando'></div>\n        <div class='tabAuthCardIcon'></div>\n        <div class='tabAuthCardLabel'></div>\n        <div class='tabAuthCardExpandoTarget'></div>\n        <div class='tabAuthCardContent'></div>\n    </div>\n</div>";(function(){spiff.ObjectRegistry.registerType(tab.CalculationDependencyView,tab.CalculationDependencyView);})();
tab.LeftPanelTemplate.htmlTemplate="\n            <div class='tabAuthLeftPanel'>\n            </div>";(function(){spiff.ObjectRegistry.registerType(tab.MarkSizePickerView,tab.MarkSizePickerView);})();
tab.LayerEncodingView.$2_1=null;(function(){tab.LayerEncodingView.$2_1={};tab.LayerEncodingView.$2_1['color-encoding']=1;tab.LayerEncodingView.$2_1['size-encoding']=2;tab.LayerEncodingView.$2_1['text-encoding']=3;tab.LayerEncodingView.$2_1['level-of-detail-encoding']=4;tab.LayerEncodingView.$2_1['tooltip-encoding']=5;})();
tab.LayerEncodingTemplate.htmlTemplate="<div class='tabAuthLayerEncoding'>\n    <div class='tabAuthLayerEncodingPrimitives'/>\n    <div class='tabAuthLayerEncodingButtonRow' />\n<div class='tabAuthLayerEncodingButtonRow' />\n<div class='tabAuthLayerEncodingShelf' />\n</div>";tab.AuthoringTabNavViewTemplate.template="\n<div class='tabAuthTabNav'>\n    <div class='tabAuthTabNavControls'>\n        <div class='tabAuthTabNavButton tabAuthTabNavLeftButton'><div class='tabIcon'><div class='tabAuthHitTarget'/></div></div>\n        <div class='tabAuthTabNavButton tabAuthTabNavRightButton'><div class='tabIcon'><div class='tabAuthHitTarget'/></div></div>\n        <div class='tabAuthTabNavButton tabAuthTabNavMenuButton'><div class='tnMenuButton'><div class='tabAuthHitTarget'/></div></div>\n    </div>\n    <div class='tabAuthTabNavTabs'></div>\n</div>";tab.PillViewTemplate.htmlTemplate="\n<span class='tabAuthShelfPill tabAuthPillDragSource'>\n    <span class='tabAuthPillExternalIcon' />\n    <span class='tabAuthPillEncodingType' />\n    <span class='tabAuthPillContent'>\n        <div class='tabAuthPillDrillIcon'><div class='tabAuthHitTarget'/></div>\n        <div class='tabAuthPillLabel'>{0}</div>\n        <div class='tabAuthPillMenuBtn'><div class='tabAuthHitTarget'/></div>\n        <div class='tabAuthPillIcons'></div>\n    </span>\n</span>";tab.RenameSheetDialog.maxSheetNameLength=254;tab.RenameSheetDialog.renameTemplate="\n<div class='tabAuthRenameSheet'>\n    <div>\n        <input name='newSheetName' class='newSheetName' type='text' tabindex='1' maxlength='"+254+"'></input>\n    </div>\n    <div class='tab-dialog-status-msg'></div>\n    <div class='tab-dialog-actions tab-dialog-actions-top-spacing'></div>\n</div>";(function(){spiff.ObjectRegistry.registerType(tab.SaveView,tab.SaveView);})();
tab.DataSourceTemplate.htmlTemplate="<div class='tab-dataSource'><div class='tab-schema-dataSourceIcon'/><div class='tab-schema-dataSourceName'/></div>";tab.DataSourceTemplate.dataSourceIconClassName='tab-schema-dataSourceIcon';tab.DataSourceTemplate.selectedDataSourceClassName='tab-schema-dataSourceSelected';tab.FieldTemplate.fieldDomSelector='.tab-schema-field';tab.FieldTemplate.selectedFieldDomSelector='.selected';tab.FieldTemplate.fieldAreaDomSelector='.tab-schema-field-label-area';tab.FieldTemplate.template="<div class='tab-schema-field'>"+"<span class='tab-schema-field-expando'><div class='tab-schema-field-expando-icon'><div class='tabAuthHitTarget' /></div></span>"+"<span class='tab-schema-field-label-area'>"+"<span class='tab-schema-field-icon-area'><div class='tab-schema-field-icon' /></span>"+"<div class='tab-schema-field-pill'>"+"<span class='tab-schema-field-content'>"+"<div class='tab-schema-field-label' />"+"<div class='tab-schema-field-pill-menu-btn'>"+"<div class='tab-schema-field-pill-menu-icon' />"+'</div>'+'</span>'+'</div>'+'</span>'+"<div class='tab-schema-field-children' />"+'</div>';tab.SchemaViewerTemplate.template="\n<div class='tab-schemaViewer'>\n  <div class='tab-schemaViewerScroll'>\n      <div class='tab-schemaViewerContentArea'>\n        <div class='tab-schemaHeader tab-schemaDataSourcesHeader'>Data</div>\n        <div class='tab-dataSources'>\n            <div class='tab-dataSourceTitles'/>\n            <div class='tab-dataRefreshButtonArea'/>\n        </div>\n        <div class='tab-schemaHeader tab-schemaDimensionsHeader'>Dimensions</div>\n        <div class='tab-schemaDimensions'><div class='tab-schemaViewerContent'></div></div>\n        <div class='tab-schemaHeader tab-schemaMeasuresHeader'>Measures</div>\n        <div class='tab-schemaMeasures'><div class='tab-schemaViewerContent'></div></div>\n        <div class='tab-schemaHeader tab-schemaSetsHeader'>Sets</div>\n        <div class='tab-schemaSets'><div class='tab-schemaViewerContent'></div></div>\n        <div class='tab-schemaHeader tab-schemaParametersHeader'>Parameters</div>\n        <div class='tab-schemaParameters'><div class='tab-schemaViewerContent'></div></div>\n      </div>\n  </div>\n  <div class='tab-schemaDropInviteTop'></div>\n  <div class='tab-schemaDropInviteLeft'></div>\n  <div class='tab-schemaDropInviteBottom'></div>\n  <div class='tab-schemaDropInviteRight'></div>\n</div>";tab.ShelfCardTemplate.template="<div class='tabAuthShelf'><div class='tabAuthShelfPills'><div class='tabAuthShelfPillsContent tabAuthShelfDropTarget'/></div></div>";tab.ShelfCardTemplate.templatePillDivider="<span class='tabAuthShelfPillDivider'><div class='tabAuthShelfPillDividerTarget'/><div class='tabAuthShelfPillDividerPlaceholder'/></span>";tab.ShelfCardTemplate.templateClickSpacer="<span class='tabAuthShelfClickArea'/>";(function(){spiff.ObjectRegistry.registerType(tab.ShowMeView,tab.ShowMeView);})();
(function(){spiff.ObjectRegistry.registerType(tab.TooltipContentView,tab.TooltipContentView);})();
tab.LinePatternPickerViewModel.selectedLinePatternProperty='SelectedLinePattern';tab.StrokeWidthPickerViewModel.selectedStrokeWidthProperty='SelectedStrokeWidth';tab.QuantitativeColorOptionViewModel.colorStepTextClassName='tabAuthColorStepText';tab.ColorPalettePickerViewModel.groupsPerPage=2;tab.ColorPalettePickerViewModel.currentPageProperty='CurrentPage';tab.ColorPalettePickerViewModel.selectedPaletteProperty='SelectedPalette';(function(){spiff.ObjectRegistry.registerType(tab.CalculationDialogView,tab.CalculationDialogView);})();
tab.CalculationDialogTemplate.$1_0="<div class='tabCalcEditor'>"+"<div class='tabCalcEditorBody'>"+"<div class='tabCalcEditorCmHolder tabCalcEditorDropTarget'></div>"+'</div>'+"<div class='tabCalcEditorControlArea'>"+"<div class='tabCalcEditorStatusHolder'>"+"<div class='tabCalcEditorStatusOk'><span class='tabCalcEditorStatusOkText'/></div>"+"<div class='tabCalcEditorStatusError'>"+"<div class='tabCalcEditorStatusErrorBtn'><span class='tabCalcEditorStatusErrorText'/><span class='tabCalcEditorDropdownBtnIcon'/></div>"+'</div>'+"<div class='tabCalcEditorDependency'>"+"<div class='tabCalcEditorDependsBtn'><span class='tabCalcEditorAffectedSheets'/><span class='tabCalcEditorDropdownBtnIcon'/></div>"+'</div>'+'</div>'+"<div class='tabCalcEditorBtnArea' />"+'</div>'+'</div>';(function(){spiff.ObjectRegistry.registerType(tab.CalculationFunctionListView,tab.CalculationFunctionListView);})();
tab.CalculationFunctionListTemplate.$1_0="<div class='tabCalcEditorFunctionArea'>"+"<div class='tabCalcEditorSearchableFuncList'>"+"<div class='tabCalcEditorFuncType'/>"+"<div class='tabCalcEditorFuncSearchBox'/>"+"<div class='tabCalcEditorFuncListSeparator'/>"+"<div class='tabCalcEditorFuncListArea'/>"+'</div>'+"<div class='tabCalcEditorFuncInfoArea'/>"+'</div>';(function(){spiff.ObjectRegistry.registerType(tab.CategoricalColorOptionView,tab.CategoricalColorOptionView);})();
tab.CategoricalColorOptionTemplate.htmlTemplate="<div class='tabAuthCategoricalColorOptionContent'>\n    <div class='tabColorPalettePickerContainer'/>\n    <div class='tabAuthDivider'/>\n    <div class='tabAuthTransparencyControlContainer'/>\n</div>";tab.QuantitativeColorOptionView.colorReverseCheckClassName='tabAuthColorReverseCheck';tab.QuantitativeColorOptionView.steppedCheckClassName='tabAuthSteppedCheck';(function(){spiff.ObjectRegistry.registerType(tab.QuantitativeColorOptionView,tab.QuantitativeColorOptionView);})();
(function(){spiff.ObjectRegistry.registerType(tab.ColorPalettePickerView,tab.ColorPalettePickerView);})();
tab.ColorPalettePickerTemplate.selectedClass='tabPaletteSelected';tab.ColorPalettePickerTemplate.highlightClass='tabPageHighlight';tab.ColorPalettePageTemplate.specialPaletteClass='tabColorSpecialPalette';tab.ColorPalettePageTemplate.colorPaletteClass='tabColorPalette';tab.StylePickerView.stylePickerButtonClassName='tabStylePickerButton';tab.StylePickerView.stylePickerSelectedButtonClassName='tabStylePickerButtonSelected';tab.TextEncodingOptionView.marksLabelCheckClass='tabAuthMarksLabelCheck';(function(){spiff.ObjectRegistry.registerType(tab.TextEncodingOptionView,tab.TextEncodingOptionView);})();
tab.TextEncodingOptionTemplate.htmlTemplate="<div class='tabAuthTextOptionContent'></div>";(function(){spiff.ObjectRegistry.registerType(tab.TypeInPillView,tab.TypeInPillView);})();
tab.TypeInPillTemplate.$1_0="<span class='tabTypeInPill' title=''>"+"<div class='tabTypeInPillCmHolder'></div>"+'</span>';});// This script was generated using Script# v0.7.4.0
// vqlauthoringmobile.js
dojo.addOnLoad(function(){
Type.registerNamespace('tab');tab.ColorPalettePickerViewMobile=function(viewModel){tab.ColorPalettePickerViewMobile.initializeBase(this,[viewModel]);}
tab.ColorPalettePickerViewMobile.prototype={$3_2:null,$3_3:0,$3_4:0,setupNavigationControl:function(){this.dom.leftButtonArea.hide();this.dom.rightButtonArea.hide();},initPaletteEventHandlers:function(){var $0=spiff.$create_EventHandleSpec();$0.dragStart=ss.Delegate.create(this,this.$3_6);$0.dragMove=ss.Delegate.create(this,this.$3_7);$0.dragEnd=ss.Delegate.create(this,this.$3_8);$0.tap=ss.Delegate.create(this,this.$3_5);this.$3_2=new spiff.TableauEventHandler(this.dom.palettePickerWindow[0],$0);},dispose:function(){tab.ColorPalettePickerViewMobile.callBaseMethod(this, 'dispose');if(ss.isValue(this.$3_2)){this.$3_2.dispose();this.$3_2=null;}},$3_5:function($p0){var $0=$($p0.target);var $1=$0.parent('.tabColorPalette');if($1.length>0){this.selectPaletteElement($1.first());}},$3_6:function($p0){this.$3_3=$p0.pageX;},$3_7:function($p0){$p0.preventDefault();this.$3_4=$p0.pageX-this.$3_3;this.scrollToOffset(this.$3_4+this.scrollOffsetForPageNo(this.colorPalettePickerViewModel.get_currentPageIndex()),false);},$3_8:function($p0){var $0=this.$3_4/310;var $1=this.colorPalettePickerViewModel.get_currentPageIndex();var $2=0;if($0>0.3&&$1>0){$2=Math.round($0+1-0.3);}else if($0<-0.3&&$1<this.colorPalettePickerViewModel.get_pages().length-1){$2=Math.round($0-(1-0.3));}if(!!$2){this.colorPalettePickerViewModel.set_currentPageIndex($1-$2);}else{this.scrollToPageNo($1);}}}
tab.MobileAppHelper=function(){}
tab.MobileAppHelper.isSaveVisible=function(){return tsConfig.allow_save||tsConfig.is_guest;}
tab.MobileAppHelper.isAllowSaveAs=function(){return tsConfig.allow_save_as;}
tab.MobileAppHelper.invokeSave=function(onSuccess,onCancel){tab.SaveController.get_instance().saveWorkbook(onSuccess,onCancel);}
tab.MobileAppHelper.invokeSaveAs=function(onSuccess,onCancel){tab.SaveController.get_instance().saveWorkbookAs(onSuccess,onCancel);}
tab.MobileAppHelper.invokeRevert=function(){tab.WorksheetServerCommands.revert();}
tab.AuthoringMastheadViewMobile=function(vm){tab.AuthoringMastheadViewMobile.initializeBase(this,[vm]);}
tab.AuthoringMastheadViewMobile.prototype={layout:function(){var $0=new tab.WindowHelper(window.self);var $1=$0.get_innerWidth()-this.logoDom.outerWidth()-this.userLinksAreaDom.outerWidth()-this.workbookNameDom.parent().offset().left-this.workbookLinksAreaDom.outerWidth();this.workbookNameDom.css('max-width',$1+'px');}}
tab.AuthoringTabNavViewMobile=function(viewModel){tab.AuthoringTabNavViewMobile.initializeBase(this,[viewModel]);this.updateContent();this.$3_3(this.dom.tabContainer);}
tab.AuthoringTabNavViewMobile.prototype={$3_0:null,dispose:function(){this.$3_0.dispose();tab.AuthoringTabNavViewMobile.callBaseMethod(this, 'dispose');},onAddedToDom:function(){tab.AuthoringTabNavViewMobile.callBaseMethod(this, 'onAddedToDom');this.$3_1();this.$3_2();},onViewModelPropertyChanged:function(sender,e){tab.AuthoringTabNavViewMobile.callBaseMethod(this, 'onViewModelPropertyChanged',[sender,e]);if(e.get_propertyName()===tab.AuthoringTabNavViewModel.currentTabProperty){this.$3_2();}},updateContent:function(){tab.AuthoringTabNavViewMobile.callBaseMethod(this, 'updateContent');this.$3_1();this.$3_2();},$3_1:function(){if(ss.isValue(this.$3_0)){this.$3_0.resetPosition();this.$3_0.refresh();}},$3_2:function(){if(!this.get_addedToDom()){return;}var $enum1=ss.IEnumerator.getEnumerator(spiff.Widget.getWidgets(this.dom.tabContainer.children(),tab.AuthoringTabView));while($enum1.moveNext()){var $0=$enum1.current;if($0.get_viewModel()===this.authoringTabNavViewModel.get_currentTab()&&ss.isValue(this.$3_0)){var $1=$0.get_element().position();var $2=this.$3_0.get_scrollPos();if($1.left<$2.x||$1.left>$2.x+this.$3_0.get_visibleArea().w){this.$3_0.scrollTo(-$1.left,this.$3_0.get_scrollPos().y);}}}},$3_3:function($p0){var $0=new spiff.TableauEventHandler($p0[0],spiff.$create_EventHandleSpec());var $1=spiff.$create_MobileScrollerOptions();this.$3_0=new spiff.MobileScroller($p0[0],$0,$1);}}
tab.AuthoringViewMobile=function(authoringViewModel){this.$1_4=new tab.DisposableHolder();this.$1_9='expanded';tab.AuthoringViewMobile.initializeBase(this,[authoringViewModel]);this.$1_5=spiff.ObjectRegistry.newView(tab.VizSummaryView,this.authoringViewModel.get_vizSummaryViewModel());this.$1_6=$("<div class='tabAuthTopShelves'></div>");this.$1_7=$("<div class='tabAuthLeftShelves'></div>");this.$1_4.add(spiff.ClickHandler.targetAndClick(this.$1_5.get_element(),ss.Delegate.create(this,function(){
var $1_0=this.get_shelfPosition();switch($1_0){case 'expanded':$1_0='collapsed';break;case 'collapsed':$1_0='expanded';break;}this.set_shelfPosition($1_0);})));this.buildDom();this.set_shelfPosition(this.$1_9);var $0=$(window.self);this.$1_4.add(spiff.EventUtil.bindWithDispose($0,'resize',ss.Delegate.create(this,this.$1_E)));this.$1_4.add(spiff.EventUtil.bindWithDispose($0,'focusout',ss.Delegate.create(this,this.$1_E)));spiff.OrientationHandler.add_orientationChanged(ss.Delegate.create(this,this.$1_F));this.$1_4.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
spiff.OrientationHandler.remove_orientationChanged(ss.Delegate.create(this,this.$1_F));})));}
tab.AuthoringViewMobile.prototype={$1_5:null,$1_6:null,$1_7:null,$1_8:null,get_shelfPosition:function(){return this.$1_9;},set_shelfPosition:function($p0){window.scrollTo(0,0);var $0='300ms ease-out';var $1=tab.BrowserSupport.get_cssTransformName();var $2=tab.BrowserSupport.get_cssTransitionName();var $3={};$3[$2]=$0;var $4={};$4[$2]=$0;var $5={};$5[$2]=$0;var $6={};$6[$2]=$0;switch($p0){case 'expanded':$6[$1]='';$5[$1]='';$4[$1]='';var $7=this.authoringViewModel.get_client().get_domNode().width();var $8=225+225-50;var $9=$7-$8;var $A=Math.max(0,Math.min(1,$9/$7));var $B=(1-$A)/2*100;$3[$1]=String.format('translate({0}px, {1}px) translate(-{2}%, -{2}%) scale({3}, {3})',$8,78,$B,$A);break;case 'collapsed':$6[$1]=String.format('translate({0}px, 0px)',-(225+225));$5[$1]=String.format('translate({0}px, 0px)',-(225+225));$4[$1]=String.format('translate(0px, {0}px)',-78);$3[$1]='';break;default:return;}this.$1_9=$p0;this.$1_5.get_element().toggle($p0!=='expanded');if($p0==='expanded'){tab.VizEvent.notifyMobileVizReduceTransform();this.$1_B();}else{tab.VizEvent.notifyMobileVizExpandTransform();this.$1_A();}this.authoringViewModel.get_vizSummaryViewModel().set_showShelves($p0==='collapsed');this.authoringViewModel.get_vizSummaryViewModel().set_showLayers($p0==='collapsed');this.leftPanelView.get_dataSchemaView().get_element().css($6);this.$1_7.css($5);this.$1_6.css($4);this.authoringViewModel.get_client().get_domNode().css($3);return $p0;},dispose:function(){this.$1_5.dispose();this.$1_6.remove();this.$1_7.remove();this.$1_4.dispose();this.$1_D();tab.AuthoringViewMobile.callBaseMethod(this, 'dispose');},$1_A:function(){if(ss.isValue(this.$1_8)){this.$1_8.remove_click(ss.Delegate.create(this,this.$1_C));this.$1_8.dispose();this.$1_8=null;}},$1_B:function(){if(ss.isNullOrUndefined(this.$1_8)){this.$1_8=new spiff.Glass();this.$1_8.add_click(ss.Delegate.create(this,this.$1_C));this.$1_8.get_element().addClass('tabShelfGlass').addClass((tsConfig.is_mobile_app)?'tab-mobileApp':'tab-mobileWeb');this.$1_8.show();}},$1_C:function(){this.set_shelfPosition('collapsed');},$1_D:function(){$('.tabAuthTopShelves').remove();$('.tabAuthLeftShelves').remove();$('.tabAuthVizSummary').remove();this.$1_A();},addContentToAreas:function(){var $0=(tsConfig.is_mobile_app)?'tab-mobileApp':'tab-mobileWeb';if(ss.isValue(this.authoringMastheadView)){this.mastheadArea.append(this.authoringMastheadView.get_element());}this.toolbarArea.append(this.toolbar.get_element());this.tabArea.append(this.tabNav.get_element());var $enum1=ss.IEnumerator.getEnumerator(this.cards['top']);while($enum1.moveNext()){var $2=$enum1.current;this.$1_6.append($2.get_element());}var $1=$('<div>').appendTo(this.$1_7);var $enum2=ss.IEnumerator.getEnumerator(this.cards['left']);while($enum2.moveNext()){var $3=$enum2.current;$1.append($3.get_element());}this.$1_7.append("<div class='tabAuthBorderRight'/>");this.$1_6.append("<div class='tabAuthBorderBottom'/>");this.leftViewArea.append(this.leftPanelView.get_element());$('body').append(this.$1_5.get_element()).append(this.$1_7).append(this.$1_6);this.$1_5.get_element().addClass($0);this.$1_7.addClass($0);this.$1_6.addClass($0);this.leftPanelView.get_dataSchemaView().get_element().addClass($0);this.mastheadArea.addClass($0);this.toolbarArea.addClass($0);},leftAreaWidth:function(){return 0;},notifyContentAddedToDom:function(){tab.AuthoringViewMobile.callBaseMethod(this, 'notifyContentAddedToDom');this.$1_5.onAddedToDom();},handleClientChanged:function(){tab.AuthoringViewMobile.callBaseMethod(this, 'handleClientChanged');this.set_shelfPosition(this.$1_9);},calculateDropTargetOffset:function(){var $0=this.toolbarArea.offset().top+this.toolbarArea.height();var $1=0;return tab.$create_Point($1,$0);},$1_E:function($p0){this.set_shelfPosition(this.$1_9);},$1_F:function(){this.$1_E(null);}}
tab.CardViewMobile=function(vm){tab.CardViewMobile.initializeBase(this,[vm,new tab.CardViewTemplate()]);}
tab.LeftPanelViewMobile=function(dataSchemaViewModel,analyticsPaneViewModel){this.$3_0=new tab.DisposableHolder();tab.LeftPanelViewMobile.initializeBase(this,[dataSchemaViewModel,analyticsPaneViewModel]);this.dom.get_domRoot().append(this.get_dataSchemaView().get_element());}
tab.ColorPickerViewMobile=function(viewModel){tab.ColorPickerViewMobile.initializeBase(this,[viewModel,new tab.ColorPickerTemplate()]);this.updateContent();this.createTransparencyControl();}
tab.ColorPickerViewMobile.prototype={createTransparencyControl:function(){this.set_colorTransparencyControlView(spiff.ObjectRegistry.newView(tab.ColorTransparencyControlView,this.colorOptionViewModel.get_colorTransparencyControlViewModel()));this.get_colorTransparencyControlView().createTransparencySettings(this.colorOptionViewModel.get_colorTransparencyControlViewModel());},$4_0:function(){this.set_linePatternPickerView(spiff.ObjectRegistry.newView(tab.LinePatternPickerView,this.colorOptionViewModel.get_linePatternPickerViewModel()));},$4_1:function(){this.set_strokeWidthPickerView(spiff.ObjectRegistry.newView(tab.StrokeWidthPickerView,this.colorOptionViewModel.get_strokeWidthPickerViewModel()));},commitChangesInView:function(){}}
tab.LayerEncodingViewMobile=function(viewModel){tab.LayerEncodingViewMobile.initializeBase(this,[viewModel,new tab.LayerEncodingTemplate()]);this.update();}
tab.LayerEncodingViewMobile.prototype={attachEventHandlers:function(button,et){},removeEncodingButtonEvents:function(){}}
tab.MarksContentViewMobile=function(viewModel){tab.MarksContentViewMobile.initializeBase(this,[viewModel,new tab.MarksContentTemplate()]);spiff.OrientationHandler.add_orientationChanged(ss.Delegate.create(this,this.$4_0));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
spiff.OrientationHandler.remove_orientationChanged(ss.Delegate.create(this,this.$4_0));})));this.handleLayersChanged();}
tab.MarksContentViewMobile.prototype={get_chooseLayersThreshold:function(){if(spiff.OrientationHandler.get_isLandscape()){return 3;}return tab.MarksContentViewMobile.callBaseMethod(this, 'get_chooseLayersThreshold');},$4_0:function(){this.handleLayersChanged();}}
tab.PillViewMobile=function(viewModel){tab.PillViewMobile.initializeBase(this,[viewModel,new tab.PillViewMobileTemplate()]);}
tab.PillViewMobileTemplate=function(){tab.PillViewMobileTemplate.initializeBase(this,[tab.PillViewTemplate.htmlTemplate]);}
tab.DataSchemaViewMobile=function(viewModel){tab.DataSchemaViewMobile.initializeBase(this,[viewModel]);if(tsConfig.features['AnalyticsPane']&&!!tab.FeatureParamsLookup.getBool(tab.FeatureParam.aoPaneUI)){this.dom.sourcesHeader.css('display','block');this.dom.sourcesHeader.text(tab.Strings.AuthSchemaViewerHeaderData);}this.$3_0=new tab.DragDropAndScrollHandler(this.dom.contentArea);this.$3_0.add_draggingStarted(ss.Delegate.create(this,this.$3_3));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
this.$3_0.remove_draggingStarted(ss.Delegate.create(this,this.$3_3));})));if(ss.isValue(this.get_dataSchemaViewModel().get_selectedDataSource())){this.initFromModel();}}
tab.DataSchemaViewMobile.prototype={$3_0:null,$3_1:null,get_scrollTop:function(){return this.$3_0.get_scroller().get_scrollPos().y;},set_scrollTop:function(value){if(value===this.get_scrollTop()||value<0||value>this.dom.contentArea.height()){return;}this.$3_0.get_scroller().scrollY(this.get_scrollTop()-value);return value;},dispose:function(){tab.DataSchemaViewMobile.callBaseMethod(this, 'dispose');if(ss.isValue(this.$3_0)){this.$3_0.dispose();this.$3_0=null;}},onAddedToDom:function(){tab.DataSchemaViewMobile.callBaseMethod(this, 'onAddedToDom');this.$3_2();},initFromModel:function(){tab.DataSchemaViewMobile.callBaseMethod(this, 'initFromModel');this.dom.get_domRoot().find('.tab-schemaViewerContent .tab-schema-field:not(:last)').addClass('tabListItemNotLast');this.$3_2();},fieldExpanded:function(field,expanded){tab.DataSchemaViewMobile.callBaseMethod(this, 'fieldExpanded',[field,expanded]);this.$3_2();},$3_2:function(){if(ss.isValue(this.$3_0)){this.$3_0.updateScrollableContentSize();}},attachSelectionEventHandler:function(ft){var $0=tab.FeatureFlags.isEnabled('NonModalCalculationDialog')&&ft.get_node().hasContextMenu;ft.getLabelClickHandler(this.perInitDisposables).onPress(ss.Delegate.create(this,function($p1_0){
this.$3_1=ft.get_node();})).onClick(ss.Delegate.create(this,function($p1_0){
if($0&&this.get_dataSchemaViewModel().isSelected(ft.get_node())){this.get_dataSchemaViewModel().showFieldContextMenu(ft.get_node(),ft.pill);}else{this.get_dataSchemaViewModel().clearAllAndSelect(ft.get_node());}}));},$3_3:function(){this.get_dataSchemaViewModel().clearAllAndSelect(this.$3_1);}}
tab.ShapePickerViewMobile=function(viewModel){tab.ShapePickerViewMobile.initializeBase(this,[viewModel,new tab.ShapePickerTemplate()]);this.updateContent();}
tab.ShelfViewMobile=function(viewModel){tab.ShelfViewMobile.initializeBase(this,[viewModel,new tab.ShelfCardTemplate()]);this.$4_0=new tab.DragDropAndScrollHandler(this.dom.pillContent);this.disposables.add(this.$4_0);this.initFromModel(viewModel);this.add_scrollContentChanged(ss.Delegate.create(this,this.$4_1));}
tab.ShelfViewMobile.prototype={$4_0:null,get_scrollContainerSize:function(){var $0=this.$4_0.get_scroller().get_visibleArea();return (this.shelfViewModel.get_orientation()===tab.CardOrientation.vertical)?$0.h:$0.w;},get_scroll:function(){return (this.shelfViewModel.get_orientation()===tab.CardOrientation.vertical)?this.$4_0.get_scroller().get_scrollPos().y:this.$4_0.get_scroller().get_scrollPos().x;},set_scroll:function(value){if(this.shelfViewModel.get_orientation()===tab.CardOrientation.vertical){this.$4_0.get_scroller().scrollY(-value);}else{this.$4_0.get_scroller().scrollX(-value);}return value;},setScrollableContentActualHeight:function(height){tab.ShelfViewMobile.callBaseMethod(this, 'setScrollableContentActualHeight',[height]);this.$4_1();},initFromModel:function(vm){tab.ShelfViewMobile.callBaseMethod(this, 'initFromModel',[vm]);this.$4_1();},$4_1:function(){this.$4_0.set_orientation((this.shelfViewModel.get_orientation()===tab.CardOrientation.vertical)?1:2);this.$4_0.updateScrollableContentSize();}}
tab.ShowMeViewMobile=function(viewModel){tab.ShowMeViewMobile.initializeBase(this,[viewModel]);this.$3_0=$('<div/>').addClass('tabAuthShowMeChoose').append($('<div/>').addClass('tabAuthShowMeChooseText'));var $0=spiff.$create_EventHandleSpec();$0.tap=ss.Delegate.create(this,function(){
this.$3_6();});this.$3_3=new spiff.TableauEventHandler(this.$3_0[0],$0);this.$3_1=$('<div/>').addClass('tabAuthShowMeClose').text('X');this.disposables.add(spiff.TableauClickHandler.targetAndClick(this.$3_1[0],ss.Delegate.create(this,this.$3_7)));this.get_element().addClass('tabAuthShowMeButtonMode');this.initContent();}
tab.ShowMeViewMobile.prototype={$3_0:null,$3_1:null,$3_2:null,$3_3:null,dispose:function(){this.$3_3.dispose();tab.ShowMeViewMobile.callBaseMethod(this, 'dispose');},attachEventHandlers:function(c,showMeDom){this.perUpdateDisposables.add(spiff.TableauClickHandler.targetAndClick(showMeDom[0],ss.Delegate.create(this,function(){
this.$3_8(c,showMeDom);})));},updateCommands:function(){if(ss.isValue(this.$3_2)){this.$3_2=this.$3_5(this.$3_2,this.smViewModel.get_showMeCommands());this.$3_4();}else{tab.ShowMeViewMobile.callBaseMethod(this, 'updateCommands');}},$3_4:function(){this.setCommandIcon(this.$3_2,this.get_element().find('.tabAuthShowMeChooseIcon'));var $0=this.smViewModel.isCommandEnabled(this.$3_2);this.$3_0.find('.tabAuthShowMeChooseText').text(($0)?tab.Strings.AuthShowMeApply:tab.Strings.AuthShowMeCantApply);this.$3_0.toggleClass('enabled',$0);},$3_5:function($p0,$p1){var $0=tab.CommandItemWrapper.create($p0);var $1=tab.CommandsPresModelWrapper.create($p1);var $enum1=ss.IEnumerator.getEnumerator($1.get_commandItems());while($enum1.moveNext()){var $2=$enum1.current;var $3=tab.CommandItemWrapper.create($2);if($3.get_commandsType()!=='subcommands'){continue;}var $4=tab.CommandsPresModelWrapper.create($3.get_commands());var $enum2=ss.IEnumerator.getEnumerator($4.get_commandItems());while($enum2.moveNext()){var $5=$enum2.current;var $6=tab.CommandItemWrapper.create($5);if($6.get_name()===$0.get_name()){return $5;}}}return null;},$3_6:function(){if(!this.smViewModel.isCommandEnabled(this.$3_2)){return;}var $0=this.$3_2;this.$3_7();this.smViewModel.applyShowMeCommand($0);},$3_7:function(){this.$3_2=null;this.smViewModel.close();},$3_8:function($p0,$p1){this.updateDescription($p0);if(this.smViewModel.isCommandEnabled($p0)){this.setActiveItem($p0,$p1);this.smViewModel.applyShowMeCommand($p0);}else{this.smViewModel.set_closeOnInteraction(false);this.$3_2=$p0;this.$3_0.find('.tabAuthShowMeChooseIcon').remove();$('<div/>').addClass('tabAuthShowMeChooseIcon').insertBefore(this.$3_0.find('.tabAuthShowMeChooseText'));this.$3_4();this.summaryDom.before(this.$3_0);this.get_element().append(this.$3_1);var $0=this.$3_0.outerHeight(true)+this.summaryDom.outerHeight(true);var $1=Math.max(this.$3_0.outerWidth(true),this.summaryDom.outerWidth(true));this.get_element().css({height:$0+'px',width:$1+'px'});this.get_element().toggleClass('tabAuthShowMeChooseMode');this.get_element().toggleClass('tabAuthShowMeButtonMode');}}}
tab.VizSummaryViewMobile=function(viewModel){tab.VizSummaryViewMobile.initializeBase(this,[viewModel,new tab.VizSummaryTemplate()]);this.update();}
tab.CalculationDialogViewMobile=function(viewModel){tab.CalculationDialogViewMobile.initializeBase(this,[viewModel]);this.initDom();this.get_pillDragFeedback().set_pillDragCursorPadding(this.get_editor().defaultTextHeight());spiff.OrientationHandler.add_orientationChanged(ss.Delegate.create(this,this.ensureDialogIsOnScreen));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
spiff.OrientationHandler.remove_orientationChanged(ss.Delegate.create(this,this.ensureDialogIsOnScreen));})));}
tab.CalculationDialogViewMobile.prototype={$4_0:false,initDom:function(){tab.CalculationDialogViewMobile.callBaseMethod(this, 'initDom');spiff.DragDropManager.add_dragStarted(ss.Delegate.create(this,this.$4_1));spiff.DragDropManager.add_dragEnded(ss.Delegate.create(this,this.$4_2));this.disposables.add(new tab.CallOnDispose(ss.Delegate.create(this,function(){
spiff.DragDropManager.remove_dragStarted(ss.Delegate.create(this,this.$4_1));spiff.DragDropManager.remove_dragEnded(ss.Delegate.create(this,this.$4_2));})));},createDialog:function(){tab.CalculationDialogViewMobile.callBaseMethod(this, 'createDialog');this.get_dialog().set_vertOffset(200);this.get_dialog().set_setFocusOnShow(false);},applyCalc:function(){this.get_editableCaption().commit();tab.CalculationDialogViewMobile.callBaseMethod(this, 'applyCalc');},applyCalcAndClose:function(){this.get_editableCaption().commit();tab.CalculationDialogViewMobile.callBaseMethod(this, 'applyCalcAndClose');},$4_1:function($p0){var $0=spiff.DragDropManager.get_lastDragEvent();var $1=$((ss.isValue($0))?$0.target:null);this.$4_0=false;if($1.parents('.tabCalcEditDialog').length>0){if(this.get_editableCaption().get_isEditing()){this.get_editableCaption().commit();this.$4_0=true;document.activeElement.blur();}else if(this.get_editor().hasFocus()){this.$4_0=true;document.activeElement.blur();}}},$4_2:function($p0){if(this.$4_0){this.$4_0=false;this.get_editor().focus();}}}
tab.CategoricalColorOptionViewMobile=function(viewModel){tab.CategoricalColorOptionViewMobile.initializeBase(this,[viewModel]);this.createTransparencyControl();}
tab.CategoricalColorOptionViewMobile.prototype={createTransparencyControl:function(){this.set_colorTransparencyControlView(spiff.ObjectRegistry.newView(tab.ColorTransparencyControlView,this.colorOptionViewModel.get_colorTransparencyControlViewModel()));this.get_colorTransparencyControlView().createTransparencySettings(this.colorOptionViewModel.get_colorTransparencyControlViewModel());},commitChangesInView:function(){}}
tab.ColorTransparencyControlViewMobile=function(viewModel){tab.ColorTransparencyControlViewMobile.initializeBase(this,[viewModel]);}
tab.ColorTransparencyControlViewMobile.prototype={onAddedToDom:function(){tab.ColorTransparencyControlViewMobile.callBaseMethod(this, 'onAddedToDom');var $0=spiff.ObjectRegistry.newView(tab.ContinuousSlider,this.sliderViewModel);this.get_element().append($0.get_element());$0.onAddedToDom();},createSlider:function(rangeModel){tab.ColorTransparencyControlViewMobile.callBaseMethod(this, 'createSlider',[rangeModel]);this.sliderViewModel.set_pixelWidth(127);}}
tab.LinePatternPickerViewMobile=function(viewModel){tab.LinePatternPickerViewMobile.initializeBase(this,[viewModel]);}
tab.StrokeWidthPickerViewMobile=function(viewModel){tab.StrokeWidthPickerViewMobile.initializeBase(this,[viewModel]);}
tab.QuantitativeColorOptionViewMobile=function(viewModel){tab.QuantitativeColorOptionViewMobile.initializeBase(this,[viewModel,new tab.QuantitativeColorOptionTemplateMobile()]);this.createColorControls();this.createTransparencyControl();}
tab.QuantitativeColorOptionViewMobile.prototype={createColorReversalControl:function(){var $0=tableau.util.createMobileCheckBox(ss.Delegate.create(this,function(){
this.quantitativeColorOptionViewModel.toggleColorReversal();}),tab.Strings.AuthReverseColorLabel,tab.QuantitativeColorOptionView.colorReverseCheckClassName,4,this.quantitativeColorOptionViewModel.get_isReversed(),this.disposables);this.dom.colorReversalControl.addClass('tabAuthReverseArea').append($0);},createSteppedCheckbox:function(){return tableau.util.createMobileCheckBox(ss.Delegate.create(this,function(){
this.quantitativeColorOptionViewModel.toggleIsStepped();}),tab.Strings.AuthSteppedColorLabel,tab.QuantitativeColorOptionView.steppedCheckClassName,5,this.quantitativeColorOptionViewModel.get_isStepped(),this.disposables);},handleIsSteppedChanged:function(isStepped){this.dom.getElementBySelector('.'+tab.QuantitativeColorOptionView.steppedCheckClassName+' .'+'tabAuthCheckbox').toggleClass('checked',isStepped);this.quantitativeColorOptionViewModel.get_stepperControlViewModel().set_isEnabled(isStepped);},handleIsReversedChanged:function(isReversed){this.dom.getElementBySelector('.'+tab.QuantitativeColorOptionView.colorReverseCheckClassName+' .'+'tabAuthCheckbox').toggleClass('checked',isReversed);},createTransparencyControl:function(){this.set_colorTransparencyControlView(spiff.ObjectRegistry.newView(tab.ColorTransparencyControlView,this.colorOptionViewModel.get_colorTransparencyControlViewModel()));this.get_colorTransparencyControlView().createTransparencySettings(this.colorOptionViewModel.get_colorTransparencyControlViewModel());},commitChangesInView:function(){this.get_stepperControlView().commitStepValueText();}}
tab.QuantitativeColorOptionTemplateMobile=function(){tab.QuantitativeColorOptionTemplateMobile.initializeBase(this,[$("<div class='tabAuthQuantitativeColorOptionContent'>\n    <div class='tabColorPalettePickerContainer'/>\n    <div class='tabAuthColorReverseControl'/>\n    <div class='tabColorSteps'/>\n    <div class='tabAuthDivider'/>\n    <div class='tabAuthTransparencyControlContainer'/>\n</div>")]);}
tab.MarkSizePickerViewMobile=function(viewModel){tab.MarkSizePickerViewMobile.initializeBase(this,[viewModel]);this.sliderViewModel.set_pixelWidth(280);}
tab.MarkSizePickerViewMobile.prototype={onAddedToDom:function(){tab.MarkSizePickerViewMobile.callBaseMethod(this, 'onAddedToDom');var $0=spiff.ObjectRegistry.newView(tab.ContinuousSlider,this.sliderViewModel);this.get_element().append($0.get_element());$0.onAddedToDom();}}
tab.TextEncodingOptionViewMobile=function(vm){tab.TextEncodingOptionViewMobile.initializeBase(this,[vm]);var $0=tableau.util.createMobileCheckBox(ss.Delegate.create(this,this.$3_0),this.textOptionViewModel.get_controlLabel(),tab.TextEncodingOptionView.marksLabelCheckClass,1,this.textOptionViewModel.get_labelsOn(),this.disposables);this.dom.get_domRoot().append($0);}
tab.TextEncodingOptionViewMobile.prototype={$3_0:function($p0){this.textOptionViewModel.toggleLabels();},handleLabelsOnChanged:function(labelsOn){this.dom.getElementBySelector('.tabAuthCheckbox').toggleClass('checked',labelsOn);}}
tab.ColorPalettePickerViewMobile.registerClass('tab.ColorPalettePickerViewMobile',tab.ColorPalettePickerView);tab.MobileAppHelper.registerClass('tab.MobileAppHelper');tab.AuthoringMastheadViewMobile.registerClass('tab.AuthoringMastheadViewMobile',tab.AuthoringMastheadView);tab.AuthoringTabNavViewMobile.registerClass('tab.AuthoringTabNavViewMobile',tab.AuthoringTabNavView);tab.AuthoringViewMobile.registerClass('tab.AuthoringViewMobile',tab.AuthoringView);tab.CardViewMobile.registerClass('tab.CardViewMobile',tab.CardView);tab.LeftPanelViewMobile.registerClass('tab.LeftPanelViewMobile',tab.LeftPanelView);tab.ColorPickerViewMobile.registerClass('tab.ColorPickerViewMobile',tab.ColorPickerView);tab.LayerEncodingViewMobile.registerClass('tab.LayerEncodingViewMobile',tab.LayerEncodingView);tab.MarksContentViewMobile.registerClass('tab.MarksContentViewMobile',tab.MarksContentView);tab.PillViewMobile.registerClass('tab.PillViewMobile',tab.PillView);tab.PillViewMobileTemplate.registerClass('tab.PillViewMobileTemplate',tab.PillViewTemplate);tab.DataSchemaViewMobile.registerClass('tab.DataSchemaViewMobile',tab.DataSchemaView);tab.ShapePickerViewMobile.registerClass('tab.ShapePickerViewMobile',tab.ShapePickerView);tab.ShelfViewMobile.registerClass('tab.ShelfViewMobile',tab.ShelfView);tab.ShowMeViewMobile.registerClass('tab.ShowMeViewMobile',tab.ShowMeView);tab.VizSummaryViewMobile.registerClass('tab.VizSummaryViewMobile',tab.VizSummaryView);tab.CalculationDialogViewMobile.registerClass('tab.CalculationDialogViewMobile',tab.CalculationDialogView);tab.CategoricalColorOptionViewMobile.registerClass('tab.CategoricalColorOptionViewMobile',tab.CategoricalColorOptionView);tab.ColorTransparencyControlViewMobile.registerClass('tab.ColorTransparencyControlViewMobile',tab.ColorTransparencyControlView);tab.LinePatternPickerViewMobile.registerClass('tab.LinePatternPickerViewMobile',tab.LinePatternPickerView);tab.StrokeWidthPickerViewMobile.registerClass('tab.StrokeWidthPickerViewMobile',tab.StrokeWidthPickerView);tab.QuantitativeColorOptionViewMobile.registerClass('tab.QuantitativeColorOptionViewMobile',tab.QuantitativeColorOptionView);tab.QuantitativeColorOptionTemplateMobile.registerClass('tab.QuantitativeColorOptionTemplateMobile',tab.QuantitativeColorOptionTemplate);tab.MarkSizePickerViewMobile.registerClass('tab.MarkSizePickerViewMobile',tab.MarkSizePickerView);tab.TextEncodingOptionViewMobile.registerClass('tab.TextEncodingOptionViewMobile',tab.TextEncodingOptionView);(function(){spiff.ObjectRegistry.registerType(tab.ColorPalettePickerView,tab.ColorPalettePickerViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.AuthoringMastheadView,tab.AuthoringMastheadViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.AuthoringTabNavView,tab.AuthoringTabNavViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.AuthoringView,tab.AuthoringViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.CardView,tab.CardViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.LeftPanelView,tab.LeftPanelViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.ColorPickerView,tab.ColorPickerViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.LayerEncodingView,tab.LayerEncodingViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.MarksContentView,tab.MarksContentViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.PillView,tab.PillViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.DataSchemaView,tab.DataSchemaViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.ShapePickerView,tab.ShapePickerViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.ShelfView,tab.ShelfViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.ShowMeView,tab.ShowMeViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.VizSummaryView,tab.VizSummaryViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.CalculationDialogView,tab.CalculationDialogViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.CategoricalColorOptionView,tab.CategoricalColorOptionViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.ColorTransparencyControlView,tab.ColorTransparencyControlViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.LinePatternPickerView,tab.LinePatternPickerViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.StrokeWidthPickerView,tab.StrokeWidthPickerViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.QuantitativeColorOptionView,tab.QuantitativeColorOptionViewMobile);})();
tab.QuantitativeColorOptionTemplateMobile.htmlTemplate="<div class='tabAuthQuantitativeColorOptionContent'>\n    <div class='tabColorPalettePickerContainer'/>\n    <div class='tabAuthColorReverseControl'/>\n    <div class='tabColorSteps'/>\n    <div class='tabAuthDivider'/>\n    <div class='tabAuthTransparencyControlContainer'/>\n</div>";(function(){spiff.ObjectRegistry.registerType(tab.MarkSizePickerView,tab.MarkSizePickerViewMobile);})();
(function(){spiff.ObjectRegistry.registerType(tab.TextEncodingOptionView,tab.TextEncodingOptionViewMobile);})();
});// This script was generated using Script# v0.7.4.0
