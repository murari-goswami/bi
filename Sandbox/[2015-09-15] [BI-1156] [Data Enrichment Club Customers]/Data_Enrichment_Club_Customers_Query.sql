select * from (
select customer_id, date_created, 
	   rank() over (partition by customer_id order by date_created desc) as date_rank,
shipping_street||' '||shipping_street_number||' '||shipping_city||' '||shipping_country||' '||shipping_zip as "Street No City Country and Zip"
from "bi.customer_order" 
where customer_id in (1350155,2032554,2698620,5487584,6115705,6441277,6786124,6788450,7542914,10120508,21581970,34216013,45404043,58121159,60242318,66643213,69264508,69935205,72748276,82027463,86059566,86151998,97202565,97313504,104761075,107131214,109828762,122339407,123488507,124366717,124418938,125847710,134438634,139245927,142480602,144454751,151317884,153848129,167120504,167395908,167470083,196456729,206384088,211098410,211154283,214952553,217102430,220881113,223578309,225601460,227913125,231666157,235625427,235955415,236948421,243373949,247447051,257536240)
and order_state = 'Completed') as t
where t.date_rank = 1
order by customer_id asc;
union
select customer_id, count(*) as "Total_Order", sum(billing_total) as "Total Billing Amount",
	   sum(billing_received) as "Total Amount Paid"												
from "bi.customer_order" 
where customer_id in (1350155,2032554,2698620,5487584,6115705,6441277,6786124,6788450,7542914,10120508,21581970,34216013,45404043,58121159,60242318,66643213,69264508,69935205,72748276,82027463,86059566,86151998,97202565,97313504,104761075,107131214,109828762,122339407,123488507,124366717,124418938,125847710,134438634,139245927,142480602,144454751,151317884,153848129,167120504,167395908,167470083,196456729,206384088,211098410,211154283,214952553,217102430,220881113,223578309,225601460,227913125,231666157,235625427,235955415,236948421,243373949,247447051,257536240)
and order_state = 'Completed'
group by customer_id
order by customer_id asc;
